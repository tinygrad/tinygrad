import functools
from extra.assembly.amd.autogen.cdna import *
from extra.assembly.amd.asm import asm
from extra.assembly.amd.dsl import Inst, RawImm
from extra.assembly.amd.test.test_roundtrip import compile_asm

compile_asm = functools.partial(compile_asm, mcpu='gfx950', mattr='+wavefrontsize64')

gemm = [
  s_load_dwordx2(sdata=s[28:29], sbase=s[0:1], offset=0x0, imm=1, soffset=RawImm(0)),
  s_load_dwordx4(sdata=s[32:35], sbase=s[0:1], offset=0x8, imm=1, soffset=RawImm(0)),
  s_load_dword(sdata=s[24], sbase=s[0:1], offset=0x18, imm=1, soffset=RawImm(0)),
  s_load_dword(sdata=s[54], sbase=s[0:1], offset=0x1C, imm=1, soffset=RawImm(0)),
  s_waitcnt(simm16=64519),
  s_mov_b32(s[51], 1),
  s_mov_b32(s[53], 1),
  s_mov_b32(s[11], 0x40010020),
  s_mov_b32(s[25], s[24]),
  s_mov_b32(s[26], 1),
  s_mov_b32(s[27], s[24]),
  s_mov_b32(s[36], s[24]),
  s_mov_b32(s[37], 0),
  s_mov_b32(s[38], s[24]),
  s_mov_b32(s[39], 0),
  s_mov_b32(s[40], s[24]),
  s_mov_b32(s[41], 0),
  s_mov_b32(s[42], s[24]),
  s_mov_b32(s[43], 0),
  s_lshr_b32(s[52], s[51], 30),
  s_and_b32(s[51], 0x3fffffff, s[51]),
  s_cmp_eq_u32(s[52], 0),
  s_and_b32(s[10], s[53], 0xffff0000),
  s_lshr_b32(s[10], s[10], 16),
  s_and_b32(s[50], s[53], 0xffff),
  s_mov_b32(s[5], s[52]),
  s_mov_b32(M0, 0x20800),
  v_mov_b32_e32(v[134], v[0]),
  s_lshr_b32(s[60], s[11], 16),
  s_ff1_i32_b32(s[60], s[60]),
  s_lshr_b32(s[61], s[11], 22),
  v_and_b32_e32(v[5], 63, v[134]),
  v_and_b32_e32(v[4], 15, v[5]),
  v_lshlrev_b32_e32(v[4], 6, v[4]),
  v_lshlrev_b32_e32(v[4], 3, v[4]),
  v_lshrrev_b32_e32(v[5], 4, v[5]),
  v_lshl_add_u32(v[4], v[5], 3, v[4]),
  v_lshrrev_b32_e32(v[8], 6, v[134]),
  v_and_b32_e32(v[8], 1, v[8]),
  v_lshl_add_u32(v[4], v[8], 13, v[4]),
  v_and_b32_e32(v[6], 63, v[134]),
  v_and_b32_e32(v[5], 15, v[6]),
  v_lshlrev_b32_e32(v[5], 6, v[5]),
  v_lshlrev_b32_e32(v[5], 3, v[5]),
  v_lshrrev_b32_e32(v[6], 4, v[6]),
  v_lshl_add_u32(v[5], v[6], 3, v[5]),
  v_lshrrev_b32_e32(v[7], 7, v[134]),
  v_and_b32_e32(v[7], 1, v[7]),
  v_lshl_add_u32(v[5], v[7], 13, v[5]),
  v_lshrrev_b32_e32(v[6], 6, v[134]),
  v_lshrrev_b32_e32(v[6], 2, v[6]),
  s_mov_b32(s[53], 64),
  v_mul_lo_u32(v[6], s[53], v[6]),
  v_add_lshl_u32(v[2], v[6], v[4], 1),
  v_lshrrev_b32_e32(v[7], 10, v[2]),
  v_lshl_add_u32(v[2], v[7], 4, v[2]),
  v_lshrrev_b32_e32(v[4], 6, v[134]),
  v_lshrrev_b32_e32(v[4], 2, v[4]),
  v_mul_lo_u32(v[4], s[53], v[4]),
  v_add_lshl_u32(v[3], v[4], v[5], 1),
  v_lshrrev_b32_e32(v[6], 10, v[3]),
  v_lshl_add_u32(v[3], v[6], 4, v[3]),
  v_add_co_u32_e32(v[3], VCC_LO, 0x8200, v[3]),
  v_add_u32_e32(v[132], 0x10400, v[2]),
  v_xor_b32_e32(v[132], v[132], v[2]),
  v_add_u32_e32(v[133], 0x10400, v[3]),
  v_xor_b32_e32(v[133], v[133], v[3]),
  v_lshrrev_b32_e32(v[4], 3, v[134]),
  v_and_b32_e32(v[5], 7, v[134]),
  v_lshlrev_b32_e32(v[5], 3, v[5]),
  v_mov_b32_e32(v[8], v[5]),
  v_lshrrev_b32_e32(v[6], 3, v[134]),
  v_and_b32_e32(v[7], 7, v[134]),
  v_lshlrev_b32_e32(v[7], 3, v[7]),
  v_mov_b32_e32(v[9], v[7]),
  v_mul_u32_u24_e32(v[10], 64, v[4]),
  v_add_lshl_u32(v[10], v[8], v[10], 1),
  v_lshrrev_b32_e32(v[12], 10, v[10]),
  v_lshl_add_u32(v[10], v[12], 4, v[10]),
  s_nop(0),
  v_readfirstlane_b32(s[46], v[10]),
  s_nop(0),
  s_add_u32(s[48], s[46], 0x10400),
  s_xor_b32(s[48], s[48], s[46]),
  v_mul_u32_u24_e32(v[10], 64, v[6]),
  v_add_lshl_u32(v[10], v[9], v[10], 1),
  v_lshrrev_b32_e32(v[12], 10, v[10]),
  v_lshl_add_u32(v[10], v[12], 4, v[10]),
  v_add_co_u32_e32(v[10], VCC_LO, 0x8200, v[10]),
  s_nop(0),
  v_readfirstlane_b32(s[47], v[10]),
  s_nop(0),
  s_add_u32(s[49], s[47], 0x10400),
  s_xor_b32(s[49], s[49], s[47]),
  v_mov_b32_e32(v[12], 0x100),
  v_mov_b32_e32(v[11], s[24]),
  v_cvt_f32_u32_e32(v[10], v[12]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[13], v[11]),
  v_mul_f32_e32(v[10], v[10], v[13]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e32(v[13], v[10], v[12]),
  v_sub_u32_e32(v[13], v[11], v[13]),
  v_cmp_ne_u32_e64(VCC_LO, v[13], 0),
  v_addc_co_u32_e64(v[10], VCC_LO, v[10], 0, VCC_LO),
  v_mov_b32_e32(v[12], 0x100),
  v_mov_b32_e32(v[11], s[25]),
  v_readfirstlane_b32(s[14], v[10]),
  v_cvt_f32_u32_e32(v[10], v[12]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[13], v[11]),
  v_mul_f32_e32(v[10], v[10], v[13]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e32(v[13], v[10], v[12]),
  v_sub_u32_e32(v[13], v[11], v[13]),
  v_cmp_ne_u32_e64(VCC_LO, v[13], 0),
  v_addc_co_u32_e64(v[10], VCC_LO, v[10], 0, VCC_LO),
  s_nop(0),
  v_readfirstlane_b32(s[15], v[10]),
  s_waitcnt(simm16=64519),
  s_mul_i32(s[52], s[14], s[15]),
  s_and_b32(s[53], s[50], 0x3fff),
  s_mul_i32(s[52], s[52], s[53]),
  v_cvt_f32_u32_e32(v[10], s[52]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[11], s[2]),
  v_mul_f32_e32(v[10], v[10], v[11]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e64(v[11], v[10], s[52]),
  v_sub_u32_e32(v[11], s[2], v[11]),
  v_cmpx_eq_u32_e64(EXEC_LO, v[11], s[52]),
  v_add_u32_e32(v[10], 1, v[10]),
  s_mov_b64(EXEC_LO, -1),
  v_cmpx_gt_u32_e64(EXEC_LO, v[11], s[52]),
  v_sub_u32_e64(v[10], v[10], 1),
  s_mov_b64(EXEC_LO, -1),
  v_readfirstlane_b32(s[52], v[10]),
  s_mov_b32(s[4], s[52]),
  s_mul_i32(s[52], s[15], s[14]),
  s_mul_i32(s[52], s[52], s[4]),
  s_mul_i32(s[52], s[52], s[53]),
  s_sub_u32(s[2], s[2], s[52]),
  v_cvt_f32_u32_e32(v[10], s[14]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[11], s[2]),
  v_mul_f32_e32(v[10], v[10], v[11]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e64(v[11], v[10], s[14]),
  v_sub_u32_e32(v[11], s[2], v[11]),
  v_cmpx_eq_u32_e64(EXEC_LO, v[11], s[14]),
  v_add_u32_e32(v[10], 1, v[10]),
  s_mov_b64(EXEC_LO, -1),
  v_cmpx_gt_u32_e64(EXEC_LO, v[11], s[14]),
  v_sub_u32_e64(v[10], v[10], 1),
  s_mov_b64(EXEC_LO, -1),
  v_readfirstlane_b32(s[52], v[10]),
  s_mov_b32(s[3], s[52]),
  s_mul_i32(s[52], s[3], s[14]),
  s_sub_u32(s[2], s[2], s[52]),
  s_sub_u32(s[32], s[32], 16),
  s_subb_u32(s[33], s[33], 0),
  s_sub_u32(s[34], s[34], 16),
  s_subb_u32(s[35], s[35], 0),
  s_and_b32(s[84], s[50], 0x3fff),
  s_mov_b64(s[6:7], 0),
  s_mov_b32(s[8], 1),
  s_mov_b32(s[9], 1),
  s_sext_i32_i16(s[11], s[11]),
  v_mul_lo_u32(v[10], s[40], v[4]),
  v_add_co_u32_e32(v[0], VCC_LO, v[5], v[10]),
  v_add_u32_e32(v[0], 8, v[0]),
  v_lshlrev_b32_e32(v[0], 1, v[0]),
  s_mul_i32(s[70], s[40], 32),
  s_lshl_b32(s[70], s[70], 1),
  s_mul_i32(s[71], s[40], 64),
  s_lshl_b32(s[71], s[71], 1),
  s_mul_i32(s[72], s[40], 0x60),
  s_lshl_b32(s[72], s[72], 1),
  s_mul_i32(s[73], s[40], 0x80),
  s_lshl_b32(s[73], s[73], 1),
  s_mul_i32(s[74], s[40], 0xa0),
  s_lshl_b32(s[74], s[74], 1),
  s_mul_i32(s[75], s[40], 0xc0),
  s_lshl_b32(s[75], s[75], 1),
  s_mul_i32(s[76], s[40], 0xe0),
  s_lshl_b32(s[76], s[76], 1),
  v_mul_lo_u32(v[10], s[42], v[6]),
  v_add_co_u32_e32(v[1], VCC_LO, v[7], v[10]),
  v_add_u32_e32(v[1], 8, v[1]),
  v_lshlrev_b32_e32(v[1], 1, v[1]),
  s_mul_i32(s[77], s[42], 32),
  s_lshl_b32(s[77], s[77], 1),
  s_mul_i32(s[78], s[42], 64),
  s_lshl_b32(s[78], s[78], 1),
  s_mul_i32(s[79], s[42], 0x60),
  s_lshl_b32(s[79], s[79], 1),
  s_mul_i32(s[80], s[42], 0x80),
  s_lshl_b32(s[80], s[80], 1),
  s_mul_i32(s[81], s[42], 0xa0),
  s_lshl_b32(s[81], s[81], 1),
  s_mul_i32(s[82], s[42], 0xc0),
  s_lshl_b32(s[82], s[82], 1),
  s_mul_i32(s[83], s[42], 0xe0),
  s_lshl_b32(s[83], s[83], 1),
  s_mul_hi_u32(s[87], s[2], 0x100),
  s_mul_i32(s[86], s[2], 0x100),
  s_mul_hi_u32(s[87], s[86], s[40]),
  s_mul_i32(s[86], s[86], s[40]),
  s_and_b32(s[84], s[50], 0x8000),
  s_cbranch_scc1(skip_offset_A),
  s_mul_hi_u32(s[85], 64, s[6]),
  s_mul_i32(s[84], 64, s[6]),
  "skip_offset_A:",
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_mov_b64(s[60:61], 1),
  s_sub_u32(s[84], s[27], 1),
  s_mul_hi_u32(s[85], 1, s[84]),
  s_mul_i32(s[84], 1, s[84]),
  s_add_u32(s[60], s[60], s[84]),
  s_addc_u32(s[61], s[61], s[85]),
  s_sub_u32(s[84], s[24], 1),
  s_mul_hi_u32(s[85], s[40], s[84]),
  s_mul_i32(s[84], s[40], s[84]),
  s_add_u32(s[60], s[60], s[84]),
  s_addc_u32(s[61], s[61], s[85]),
  s_sub_u32(s[60], s[60], s[86]),
  s_subb_u32(s[61], s[61], s[87]),
  s_lshl_b64(s[60:61], s[60:61], 1),
  s_add_u32(s[60], s[60], 16),
  s_addc_u32(s[61], s[61], 0),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_mul_hi_u32(s[85], s[41], s[4]),
  s_mul_i32(s[84], s[41], s[4]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_lshl_b64(s[86:87], s[86:87], 1),
  s_add_u32(s[52], s[32], s[86]),
  s_addc_u32(s[53], s[33], s[87]),
  s_mov_b32(s[55], 0x20000),
  s_mul_hi_u32(s[87], s[3], 0x100),
  s_mul_i32(s[86], s[3], 0x100),
  s_mul_hi_u32(s[87], s[86], s[42]),
  s_mul_i32(s[86], s[86], s[42]),
  s_and_b32(s[84], s[50], 0x8000),
  s_cbranch_scc1(skip_offset_B),
  s_mul_hi_u32(s[85], 64, s[6]),
  s_mul_i32(s[84], 64, s[6]),
  "skip_offset_B:",
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_mov_b64(s[62:63], 1),
  s_sub_u32(s[84], s[27], 1),
  s_mul_hi_u32(s[85], 1, s[84]),
  s_mul_i32(s[84], 1, s[84]),
  s_add_u32(s[62], s[62], s[84]),
  s_addc_u32(s[63], s[63], s[85]),
  s_sub_u32(s[84], s[25], 1),
  s_mul_hi_u32(s[85], s[42], s[84]),
  s_mul_i32(s[84], s[42], s[84]),
  s_add_u32(s[62], s[62], s[84]),
  s_addc_u32(s[63], s[63], s[85]),
  s_sub_u32(s[62], s[62], s[86]),
  s_subb_u32(s[63], s[63], s[87]),
  s_lshl_b64(s[62:63], s[62:63], 1),
  s_add_u32(s[62], s[62], 16),
  s_addc_u32(s[63], s[63], 0),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  s_mul_hi_u32(s[85], s[43], s[4]),
  s_mul_i32(s[84], s[43], s[4]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_lshl_b64(s[86:87], s[86:87], 1),
  s_add_u32(s[56], s[34], s[86]),
  s_addc_u32(s[57], s[35], s[87]),
  s_mov_b32(s[59], 0x20000),
  s_and_b32(s[85], s[50], 0x3fff),
  s_mul_i32(s[85], s[85], 0x80),
  s_and_b32(s[84], s[50], 0x8000),
  s_cselect_b32(s[68], 0x80, s[85]),
  s_and_b32(s[85], s[50], 0x3fff),
  s_mul_i32(s[85], s[85], 0x80),
  s_and_b32(s[84], s[50], 0x8000),
  s_cselect_b32(s[69], 0x80, s[85]),
  s_lshr_b32(s[12], s[27], 6),
  s_and_b32(s[84], s[50], 0x3fff),
  s_mov_b32(s[13], s[12]),
  s_and_b32(s[86], s[10], 0x1f00),
  s_lshr_b32(s[86], s[86], 8),
  s_and_b32(s[87], s[10], 0xe000),
  s_and_b32(s[10], s[10], 0xff),
  s_mov_b32(s[84], s[10]),
  s_lshl_b32(s[85], s[84], s[86]),
  s_cmp_ge_u32(s[13], s[85]),
  s_sub_u32(s[85], s[84], 1),
  s_cmp_ge_u32(s[84], 1),
  s_cselect_b32(s[51], s[85], 0),
  s_cmp_eq_u32(s[87], 0x2000),
  s_and_b32(s[51], s[51], s[84]),
  s_lshl_b32(s[51], s[51], s[86]),
  s_mul_hi_i32(s[85], s[51], s[68]),
  s_mul_i32(s[84], s[51], s[68]),
  s_mul_hi_i32(s[65], s[12], s[68]),
  s_mul_i32(s[64], s[12], s[68]),
  s_sub_u32(s[64], s[68], s[64]),
  s_subb_u32(s[65], 0, s[65]),
  s_add_u32(s[52], s[52], s[84]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_mul_hi_i32(s[85], s[51], s[69]),
  s_mul_i32(s[84], s[51], s[69]),
  s_mul_hi_i32(s[67], s[12], s[69]),
  s_mul_i32(s[66], s[12], s[69]),
  s_sub_u32(s[66], s[69], s[66]),
  s_subb_u32(s[67], 0, s[67]),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  s_sub_u32(s[62], s[62], s[84]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  s_add_u32(s[51], s[51], 2),
  s_cmp_eq_u32(s[12], 0),
  s_cbranch_scc1(init_output_buffers),
  s_mov_b32(M0, s[46]),
  buffer_load_dwordx4(v[0], s[52:55], 0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[70], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[71], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[72], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[73], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[74], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[75], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[76], offen=1, lds=1),
  s_mov_b32(M0, s[47]),
  buffer_load_dwordx4(v[1], s[56:59], 0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[77], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[78], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  v_accvgpr_write_b32(a0, 0),
  v_accvgpr_write_b32(a1, 0),
  v_accvgpr_write_b32(a2, 0),
  v_accvgpr_write_b32(a3, 0),
  v_accvgpr_write_b32(a4, 0),
  v_accvgpr_write_b32(a5, 0),
  v_accvgpr_write_b32(a6, 0),
  v_accvgpr_write_b32(a7, 0),
  v_accvgpr_write_b32(a8, 0),
  v_accvgpr_write_b32(a9, 0),
  v_accvgpr_write_b32(a10, 0),
  v_accvgpr_write_b32(a11, 0),
  v_accvgpr_write_b32(a12, 0),
  v_accvgpr_write_b32(a13, 0),
  v_accvgpr_write_b32(a14, 0),
  v_accvgpr_write_b32(a15, 0),
  v_mov_b64_e32(v[6:7], 0),
  v_mov_b64_e32(v[8:9], 0),
  v_mfma_f32_32x32x16_bf16(a[16:31], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[32:47], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[48:63], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[64:79], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[80:95], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[96:111], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[112:127], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[128:143], v[6:9], v[6:9], a[0:15]),
  buffer_load_dwordx4(v[1], s[56:59], s[79], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_32x32x16_bf16(a[144:159], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[160:175], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[176:191], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[192:207], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[208:223], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[224:239], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[240:255], v[6:9], v[6:9], a[0:15]),
  buffer_load_dwordx4(v[1], s[56:59], s[80], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[81], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[82], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[83], offen=1, lds=1),
  s_add_u32(s[86], s[12], 1),
  s_cmp_eq_u32(s[51], s[86]),
  s_cselect_b32(s[84], s[64], s[68]),
  s_cselect_b32(s[85], s[65], 0),
  s_add_u32(s[52], s[52], s[84]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_add_u32(s[86], s[12], 1),
  s_cmp_eq_u32(s[51], s[86]),
  s_cselect_b32(s[84], s[66], s[69]),
  s_cselect_b32(s[85], s[67], 0),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  s_sub_u32(s[62], s[62], s[84]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  "init_output_buffers:",
  s_mov_b64(s[16:17], s[28:29]),
  s_mov_b32(s[18], 0x80000000),
  s_mov_b32(s[19], 0x20000),
  s_mov_b64(s[20:21], s[30:31]),
  s_mov_b32(s[22], 0x80000000),
  s_mov_b32(s[23], 0x20000),
  s_mul_i32(s[86], 0x100, s[3]),
  s_mul_hi_u32(s[85], s[86], s[38]),
  s_mul_i32(s[84], s[86], s[38]),
  s_lshl_b64(s[84:85], s[84:85], s[8]),
  s_add_u32(s[20], s[30], s[84]),
  s_addc_u32(s[21], s[31], s[85]),
  s_mul_hi_u32(s[85], s[86], s[36]),
  s_mul_i32(s[84], s[86], s[36]),
  s_lshl_b64(s[84:85], s[84:85], s[9]),
  s_add_u32(s[16], s[28], s[84]),
  s_addc_u32(s[17], s[29], s[85]),
  s_mul_hi_u32(s[85], s[4], s[39]),
  s_mul_i32(s[84], s[4], s[39]),
  s_lshl_b64(s[84:85], s[84:85], s[8]),
  s_add_u32(s[20], s[20], s[84]),
  s_addc_u32(s[21], s[21], s[85]),
  s_mul_hi_u32(s[85], s[4], s[37]),
  s_mul_i32(s[84], s[4], s[37]),
  s_lshl_b64(s[84:85], s[84:85], s[9]),
  s_add_u32(s[16], s[16], s[84]),
  s_addc_u32(s[17], s[17], s[85]),
  s_mul_hi_u32(s[85], s[24], s[6]),
  s_mul_i32(s[84], s[24], s[6]),
  s_sub_u32(s[86], s[25], 1),
  s_mul_i32(s[86], s[86], s[6]),
  s_mul_hi_u32(s[87], s[86], s[38]),
  s_mul_i32(s[86], s[86], s[38]),
  s_add_u32(s[84], s[84], s[86]),
  s_addc_u32(s[85], s[85], s[87]),
  s_sub_u32(s[86], s[26], 1),
  s_mul_i32(s[86], s[86], s[6]),
  s_mul_hi_u32(s[87], s[86], s[39]),
  s_mul_i32(s[86], s[86], s[39]),
  s_add_u32(s[84], s[84], s[86]),
  s_addc_u32(s[85], s[85], s[87]),
  s_lshl_b64(s[84:85], s[84:85], 2),
  s_add_u32(s[16], s[16], s[84]),
  s_addc_u32(s[17], s[17], s[85]),
  s_xor_b32(s[46], s[48], s[46]),
  s_xor_b32(s[47], s[49], s[47]),
  s_cmp_eq_u32(s[12], 1),
  s_cbranch_scc1(after_prefetch),
  s_mov_b32(M0, s[46]),
  buffer_load_dwordx4(v[0], s[52:55], 0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[70], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[71], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[72], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[73], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[74], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[75], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[0], s[52:55], s[76], offen=1, lds=1),
  s_mov_b32(M0, s[47]),
  buffer_load_dwordx4(v[1], s[56:59], 0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[77], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[78], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[79], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[80], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[81], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[82], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(v[1], s[56:59], s[83], offen=1, lds=1),
  s_xor_b32(s[46], s[48], s[46]),
  s_xor_b32(s[47], s[49], s[47]),
  "after_prefetch:",
  s_waitcnt(simm16=25591),
  s_barrier(),
  ds_read_b128(addr=v[4:7], data0=v[2], offset0=0, offset1=0),
  ds_read_b128(addr=v[8:11], data0=v[2], offset0=128, offset1=0),
  ds_read_b128(addr=v[12:15], data0=v[2], offset0=0, offset1=1),
  ds_read_b128(addr=v[16:19], data0=v[2], offset0=128, offset1=1),
  ds_read_b128(addr=v[20:23], data0=v[2], offset0=0, offset1=2),
  ds_read_b128(addr=v[24:27], data0=v[2], offset0=128, offset1=2),
  ds_read_b128(addr=v[28:31], data0=v[2], offset0=0, offset1=3),
  ds_read_b128(addr=v[32:35], data0=v[2], offset0=128, offset1=3),
  s_waitcnt(simm16=17399),
  s_barrier(),
  ds_read_b128(addr=v[68:71], data0=v[3], offset0=0, offset1=0),
  ds_read_b128(addr=v[72:75], data0=v[3], offset0=128, offset1=0),
  ds_read_b128(addr=v[76:79], data0=v[3], offset0=0, offset1=1),
  ds_read_b128(addr=v[80:83], data0=v[3], offset0=128, offset1=1),
  ds_read_b128(addr=v[84:87], data0=v[3], offset0=0, offset1=2),
  ds_read_b128(addr=v[88:91], data0=v[3], offset0=128, offset1=2),
  ds_read_b128(addr=v[92:95], data0=v[3], offset0=0, offset1=3),
  ds_read_b128(addr=v[96:99], data0=v[3], offset0=128, offset1=3),
  s_waitcnt(simm16=64519),
  s_cmp_eq_u32(s[12], 1),
  s_cbranch_scc1(final_compute),
  s_cmp_le_u32(s[12], 2),
  s_cbranch_scc1(loop_epilogue),
  "main_loop:",
  v_mfma_f32_16x16x32_bf16(a[0:3], v[68:71], v[4:7], a[0:3]),
  ds_read_b128(addr=v[36:39], data0=v[2], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[68:71], v[8:11], a[4:7]),
  s_cmp_eq_u32(s[12], s[51]),
  s_cselect_b32(s[84], s[64], s[68]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[68:71], v[12:15], a[8:11]),
  ds_read_b128(addr=v[40:43], data0=v[2], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[68:71], v[16:19], a[12:15]),
  s_cselect_b32(s[85], s[65], 0),
  s_add_u32(s[52], s[52], s[84]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[68:71], v[20:23], a[16:19]),
  ds_read_b128(addr=v[44:47], data0=v[2], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[68:71], v[24:27], a[20:23]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[68:71], v[28:31], a[24:27]),
  ds_read_b128(addr=v[48:51], data0=v[2], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[68:71], v[32:35], a[28:31]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[72:75], v[4:7], a[32:35]),
  ds_read_b128(addr=v[52:55], data0=v[2], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[72:75], v[8:11], a[36:39]),
  s_cselect_b32(s[54], s[60], -1),
  s_cmp_eq_u32(s[12], s[51]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[72:75], v[12:15], a[40:43]),
  ds_read_b128(addr=v[56:59], data0=v[2], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[72:75], v[16:19], a[44:47]),
  s_cselect_b32(s[84], s[66], s[69]),
  s_cselect_b32(s[85], s[67], 0),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[72:75], v[20:23], a[48:51]),
  ds_read_b128(addr=v[60:63], data0=v[2], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[72:75], v[24:27], a[52:55]),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[72:75], v[28:31], a[56:59]),
  ds_read_b128(addr=v[64:67], data0=v[2], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[72:75], v[32:35], a[60:63]),
  s_mov_b32(M0, s[46]),
  s_sub_u32(s[62], s[62], s[84]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[76:79], v[4:7], a[64:67]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[76:79], v[8:11], a[68:71]),
  s_cselect_b32(s[58], s[62], -1),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[76:79], v[12:15], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[76:79], v[16:19], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[76:79], v[20:23], a[80:83]),
  s_waitcnt(simm16=64519),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[76:79], v[24:27], a[84:87]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[76:79], v[28:31], a[88:91]),
  buffer_load_dwordx4(v[0], s[52:55], 0, offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[76:79], v[32:35], a[92:95]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[80:83], v[4:7], a[96:99]),
  ds_read_b128(addr=v[100:103], data0=v[3], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[80:83], v[8:11], a[100:103]),
  buffer_load_dwordx4(v[0], s[52:55], s[70], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[80:83], v[12:15], a[104:107]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[80:83], v[16:19], a[108:111]),
  ds_read_b128(addr=v[104:107], data0=v[3], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[80:83], v[20:23], a[112:115]),
  buffer_load_dwordx4(v[0], s[52:55], s[71], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[80:83], v[24:27], a[116:119]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[80:83], v[28:31], a[120:123]),
  ds_read_b128(addr=v[108:111], data0=v[3], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[80:83], v[32:35], a[124:127]),
  buffer_load_dwordx4(v[0], s[52:55], s[72], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[84:87], v[4:7], a[128:131]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[84:87], v[8:11], a[132:135]),
  ds_read_b128(addr=v[112:115], data0=v[3], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[84:87], v[12:15], a[136:139]),
  buffer_load_dwordx4(v[0], s[52:55], s[73], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[84:87], v[16:19], a[140:143]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[84:87], v[20:23], a[144:147]),
  ds_read_b128(addr=v[116:119], data0=v[3], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[84:87], v[24:27], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[84:87], v[28:31], a[152:155]),
  ds_read_b128(addr=v[120:123], data0=v[3], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[84:87], v[32:35], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[88:91], v[4:7], a[160:163]),
  ds_read_b128(addr=v[124:127], data0=v[3], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[88:91], v[8:11], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[88:91], v[12:15], a[168:171]),
  ds_read_b128(addr=v[128:131], data0=v[3], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[88:91], v[16:19], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[88:91], v[20:23], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[88:91], v[24:27], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[88:91], v[28:31], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[88:91], v[32:35], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[92:95], v[4:7], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[92:95], v[8:11], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[92:95], v[12:15], a[200:203]),
  s_waitcnt(simm16=64519),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[92:95], v[16:19], a[204:207]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[92:95], v[20:23], a[208:211]),
  buffer_load_dwordx4(v[0], s[52:55], s[74], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[92:95], v[24:27], a[212:215]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[92:95], v[28:31], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[92:95], v[32:35], a[220:223]),
  buffer_load_dwordx4(v[0], s[52:55], s[75], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[96:99], v[4:7], a[224:227]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[96:99], v[8:11], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[96:99], v[12:15], a[232:235]),
  buffer_load_dwordx4(v[0], s[52:55], s[76], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[96:99], v[16:19], a[236:239]),
  s_mov_b32(M0, s[47]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[96:99], v[20:23], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[96:99], v[24:27], a[244:247]),
  buffer_load_dwordx4(v[1], s[56:59], 0, offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[96:99], v[28:31], a[248:251]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[96:99], v[32:35], a[252:255]),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[100:103], v[36:39], a[0:3]),
  buffer_load_dwordx4(v[1], s[56:59], s[77], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[100:103], v[40:43], a[4:7]),
  s_add_u32(M0, M0, 0x1040),
  s_xor_b32(s[46], s[48], s[46]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[100:103], v[44:47], a[8:11]),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[100:103], v[48:51], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[100:103], v[52:55], a[16:19]),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[100:103], v[56:59], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[100:103], v[60:63], a[24:27]),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[100:103], v[64:67], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[104:107], v[36:39], a[32:35]),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[104:107], v[40:43], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[104:107], v[44:47], a[40:43]),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[104:107], v[48:51], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[104:107], v[52:55], a[48:51]),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[104:107], v[56:59], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[104:107], v[60:63], a[56:59]),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[104:107], v[64:67], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[108:111], v[36:39], a[64:67]),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[108:111], v[40:43], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[108:111], v[44:47], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[108:111], v[48:51], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[108:111], v[52:55], a[80:83]),
  v_xor_b32_e32(v[2], v[132], v[2]),
  v_xor_b32_e32(v[3], v[133], v[3]),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[108:111], v[56:59], a[84:87]),
  buffer_load_dwordx4(v[1], s[56:59], s[78], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[108:111], v[60:63], a[88:91]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[108:111], v[64:67], a[92:95]),
  buffer_load_dwordx4(v[1], s[56:59], s[79], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[112:115], v[36:39], a[96:99]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[112:115], v[40:43], a[100:103]),
  buffer_load_dwordx4(v[1], s[56:59], s[80], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[112:115], v[44:47], a[104:107]),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[112:115], v[48:51], a[108:111]),
  s_waitcnt(simm16=14327),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[112:115], v[52:55], a[112:115]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[112:115], v[56:59], a[116:119]),
  ds_read_b128(addr=v[4:7], data0=v[2], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[112:115], v[60:63], a[120:123]),
  ds_read_b128(addr=v[8:11], data0=v[2], offset0=128, offset1=0),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[112:115], v[64:67], a[124:127]),
  ds_read_b128(addr=v[12:15], data0=v[2], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[116:119], v[36:39], a[128:131]),
  buffer_load_dwordx4(v[1], s[56:59], s[81], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[116:119], v[40:43], a[132:135]),
  ds_read_b128(addr=v[16:19], data0=v[2], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[116:119], v[44:47], a[136:139]),
  ds_read_b128(addr=v[20:23], data0=v[2], offset0=0, offset1=2),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[116:119], v[48:51], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[116:119], v[52:55], a[144:147]),
  buffer_load_dwordx4(v[1], s[56:59], s[82], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[116:119], v[56:59], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[116:119], v[60:63], a[152:155]),
  ds_read_b128(addr=v[24:27], data0=v[2], offset0=128, offset1=2),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[116:119], v[64:67], a[156:159]),
  ds_read_b128(addr=v[28:31], data0=v[2], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[120:123], v[36:39], a[160:163]),
  ds_read_b128(addr=v[32:35], data0=v[2], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[120:123], v[40:43], a[164:167]),
  ds_read_b128(addr=v[68:71], data0=v[3], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[120:123], v[44:47], a[168:171]),
  ds_read_b128(addr=v[72:75], data0=v[3], offset0=128, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[120:123], v[48:51], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[120:123], v[52:55], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[120:123], v[56:59], a[180:183]),
  ds_read_b128(addr=v[76:79], data0=v[3], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[120:123], v[60:63], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[120:123], v[64:67], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[124:127], v[36:39], a[192:195]),
  ds_read_b128(addr=v[80:83], data0=v[3], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[124:127], v[40:43], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[124:127], v[44:47], a[200:203]),
  ds_read_b128(addr=v[84:87], data0=v[3], offset0=0, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[124:127], v[48:51], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[124:127], v[52:55], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[124:127], v[56:59], a[212:215]),
  ds_read_b128(addr=v[88:91], data0=v[3], offset0=128, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[124:127], v[60:63], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[124:127], v[64:67], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[128:131], v[36:39], a[224:227]),
  ds_read_b128(addr=v[92:95], data0=v[3], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[128:131], v[40:43], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[128:131], v[44:47], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[128:131], v[48:51], a[236:239]),
  ds_read_b128(addr=v[96:99], data0=v[3], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[128:131], v[52:55], a[240:243]),
  buffer_load_dwordx4(v[1], s[56:59], s[83], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[128:131], v[56:59], a[244:247]),
  s_xor_b32(s[47], s[49], s[47]),
  s_sub_u32(s[12], s[12], 1),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[128:131], v[60:63], a[248:251]),
  s_cmp_eq_i32(s[12], 2),
  s_waitcnt(simm16=64519),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[128:131], v[64:67], a[252:255]),
  s_cbranch_scc0(main_loop),
  "loop_epilogue:",
  v_mfma_f32_16x16x32_bf16(a[0:3], v[68:71], v[4:7], a[0:3]),
  ds_read_b128(addr=v[36:39], data0=v[2], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[68:71], v[8:11], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[68:71], v[12:15], a[8:11]),
  ds_read_b128(addr=v[100:103], data0=v[3], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[68:71], v[16:19], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[68:71], v[20:23], a[16:19]),
  ds_read_b128(addr=v[40:43], data0=v[2], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[68:71], v[24:27], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[68:71], v[28:31], a[24:27]),
  ds_read_b128(addr=v[44:47], data0=v[2], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[68:71], v[32:35], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[72:75], v[4:7], a[32:35]),
  ds_read_b128(addr=v[48:51], data0=v[2], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[72:75], v[8:11], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[72:75], v[12:15], a[40:43]),
  ds_read_b128(addr=v[52:55], data0=v[2], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[72:75], v[16:19], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[72:75], v[20:23], a[48:51]),
  ds_read_b128(addr=v[56:59], data0=v[2], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[72:75], v[24:27], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[72:75], v[28:31], a[56:59]),
  ds_read_b128(addr=v[60:63], data0=v[2], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[72:75], v[32:35], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[76:79], v[4:7], a[64:67]),
  ds_read_b128(addr=v[64:67], data0=v[2], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[76:79], v[8:11], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[76:79], v[12:15], a[72:75]),
  ds_read_b128(addr=v[104:107], data0=v[3], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[76:79], v[16:19], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[76:79], v[20:23], a[80:83]),
  ds_read_b128(addr=v[108:111], data0=v[3], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[76:79], v[24:27], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[76:79], v[28:31], a[88:91]),
  ds_read_b128(addr=v[112:115], data0=v[3], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[76:79], v[32:35], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[80:83], v[4:7], a[96:99]),
  ds_read_b128(addr=v[116:119], data0=v[3], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[80:83], v[8:11], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[80:83], v[12:15], a[104:107]),
  ds_read_b128(addr=v[120:123], data0=v[3], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[80:83], v[16:19], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[80:83], v[20:23], a[112:115]),
  ds_read_b128(addr=v[124:127], data0=v[3], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[80:83], v[24:27], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[80:83], v[28:31], a[120:123]),
  ds_read_b128(addr=v[128:131], data0=v[3], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[80:83], v[32:35], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[84:87], v[4:7], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[84:87], v[8:11], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[84:87], v[12:15], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[84:87], v[16:19], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[84:87], v[20:23], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[84:87], v[24:27], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[84:87], v[28:31], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[84:87], v[32:35], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[88:91], v[4:7], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[88:91], v[8:11], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[88:91], v[12:15], a[168:171]),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[88:91], v[16:19], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[88:91], v[20:23], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[88:91], v[24:27], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[88:91], v[28:31], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[88:91], v[32:35], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[92:95], v[4:7], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[92:95], v[8:11], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[92:95], v[12:15], a[200:203]),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[92:95], v[16:19], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[92:95], v[20:23], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[92:95], v[24:27], a[212:215]),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[92:95], v[28:31], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[92:95], v[32:35], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[96:99], v[4:7], a[224:227]),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[96:99], v[8:11], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[96:99], v[12:15], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[96:99], v[16:19], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[96:99], v[20:23], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[96:99], v[24:27], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[96:99], v[28:31], a[248:251]),
  v_xor_b32_e32(v[2], v[132], v[2]),
  v_xor_b32_e32(v[3], v[133], v[3]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[96:99], v[32:35], a[252:255]),
  s_waitcnt(simm16=64519),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[100:103], v[36:39], a[0:3]),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[100:103], v[40:43], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[100:103], v[44:47], a[8:11]),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[100:103], v[48:51], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[100:103], v[52:55], a[16:19]),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[100:103], v[56:59], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[100:103], v[60:63], a[24:27]),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[100:103], v[64:67], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[104:107], v[36:39], a[32:35]),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[104:107], v[40:43], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[104:107], v[44:47], a[40:43]),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[104:107], v[48:51], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[104:107], v[52:55], a[48:51]),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[104:107], v[56:59], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[104:107], v[60:63], a[56:59]),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[104:107], v[64:67], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[108:111], v[36:39], a[64:67]),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[108:111], v[40:43], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[108:111], v[44:47], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[108:111], v[48:51], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[108:111], v[52:55], a[80:83]),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[108:111], v[56:59], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[108:111], v[60:63], a[88:91]),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[108:111], v[64:67], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[112:115], v[36:39], a[96:99]),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[112:115], v[40:43], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[112:115], v[44:47], a[104:107]),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[112:115], v[48:51], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[112:115], v[52:55], a[112:115]),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[112:115], v[56:59], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[112:115], v[60:63], a[120:123]),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[112:115], v[64:67], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[116:119], v[36:39], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[116:119], v[40:43], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[116:119], v[44:47], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[116:119], v[48:51], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[116:119], v[52:55], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[116:119], v[56:59], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[116:119], v[60:63], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[116:119], v[64:67], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[120:123], v[36:39], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[120:123], v[40:43], a[164:167]),
  s_waitcnt(simm16=1015),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[120:123], v[44:47], a[168:171]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[120:123], v[48:51], a[172:175]),
  ds_read_b128(addr=v[4:7], data0=v[2], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[120:123], v[52:55], a[176:179]),
  ds_read_b128(addr=v[68:71], data0=v[3], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[120:123], v[56:59], a[180:183]),
  ds_read_b128(addr=v[8:11], data0=v[2], offset0=128, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[120:123], v[60:63], a[184:187]),
  ds_read_b128(addr=v[12:15], data0=v[2], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[120:123], v[64:67], a[188:191]),
  ds_read_b128(addr=v[16:19], data0=v[2], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[124:127], v[36:39], a[192:195]),
  ds_read_b128(addr=v[20:23], data0=v[2], offset0=0, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[124:127], v[40:43], a[196:199]),
  ds_read_b128(addr=v[24:27], data0=v[2], offset0=128, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[124:127], v[44:47], a[200:203]),
  ds_read_b128(addr=v[28:31], data0=v[2], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[124:127], v[48:51], a[204:207]),
  ds_read_b128(addr=v[32:35], data0=v[2], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[124:127], v[52:55], a[208:211]),
  ds_read_b128(addr=v[72:75], data0=v[3], offset0=128, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[124:127], v[56:59], a[212:215]),
  ds_read_b128(addr=v[76:79], data0=v[3], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[124:127], v[60:63], a[216:219]),
  ds_read_b128(addr=v[80:83], data0=v[3], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[124:127], v[64:67], a[220:223]),
  ds_read_b128(addr=v[84:87], data0=v[3], offset0=0, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[128:131], v[36:39], a[224:227]),
  ds_read_b128(addr=v[88:91], data0=v[3], offset0=128, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[128:131], v[40:43], a[228:231]),
  ds_read_b128(addr=v[92:95], data0=v[3], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[128:131], v[44:47], a[232:235]),
  ds_read_b128(addr=v[96:99], data0=v[3], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[128:131], v[48:51], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[128:131], v[52:55], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[128:131], v[56:59], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[128:131], v[60:63], a[248:251]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[128:131], v[64:67], a[252:255]),
  "final_compute:",
  s_and_b32(s[8], s[50], 0x3fff),
  s_and_b32(s[84], 0xff, s[24]),
  s_add_u32(s[85], -1, s[14]),
  s_cmp_ge_u32(s[2], s[85]),
  s_cselect_b32(s[84], s[84], 0),
  s_and_b32(s[84], 0xff, s[25]),
  s_add_u32(s[85], -1, s[15]),
  s_cmp_ge_u32(s[3], s[85]),
  s_cselect_b32(s[84], s[84], 0),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[68:71], v[4:7], a[0:3]),
  ds_read_b128(addr=v[36:39], data0=v[2], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[68:71], v[8:11], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[68:71], v[12:15], a[8:11]),
  ds_read_b128(addr=v[100:103], data0=v[3], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[68:71], v[16:19], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[68:71], v[20:23], a[16:19]),
  ds_read_b128(addr=v[40:43], data0=v[2], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[68:71], v[24:27], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[68:71], v[28:31], a[24:27]),
  ds_read_b128(addr=v[44:47], data0=v[2], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[68:71], v[32:35], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[72:75], v[4:7], a[32:35]),
  ds_read_b128(addr=v[48:51], data0=v[2], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[72:75], v[8:11], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[72:75], v[12:15], a[40:43]),
  ds_read_b128(addr=v[52:55], data0=v[2], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[72:75], v[16:19], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[72:75], v[20:23], a[48:51]),
  ds_read_b128(addr=v[56:59], data0=v[2], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[72:75], v[24:27], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[72:75], v[28:31], a[56:59]),
  ds_read_b128(addr=v[60:63], data0=v[2], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[72:75], v[32:35], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[76:79], v[4:7], a[64:67]),
  ds_read_b128(addr=v[64:67], data0=v[2], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[76:79], v[8:11], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[76:79], v[12:15], a[72:75]),
  ds_read_b128(addr=v[104:107], data0=v[3], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[76:79], v[16:19], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[76:79], v[20:23], a[80:83]),
  ds_read_b128(addr=v[108:111], data0=v[3], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[76:79], v[24:27], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[76:79], v[28:31], a[88:91]),
  ds_read_b128(addr=v[112:115], data0=v[3], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[76:79], v[32:35], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[80:83], v[4:7], a[96:99]),
  ds_read_b128(addr=v[116:119], data0=v[3], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[80:83], v[8:11], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[80:83], v[12:15], a[104:107]),
  ds_read_b128(addr=v[120:123], data0=v[3], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[80:83], v[16:19], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[80:83], v[20:23], a[112:115]),
  ds_read_b128(addr=v[124:127], data0=v[3], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[80:83], v[24:27], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[80:83], v[28:31], a[120:123]),
  ds_read_b128(addr=v[128:131], data0=v[3], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[80:83], v[32:35], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[84:87], v[4:7], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[84:87], v[8:11], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[84:87], v[12:15], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[84:87], v[16:19], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[84:87], v[20:23], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[84:87], v[24:27], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[84:87], v[28:31], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[84:87], v[32:35], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[88:91], v[4:7], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[88:91], v[8:11], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[88:91], v[12:15], a[168:171]),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[88:91], v[16:19], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[88:91], v[20:23], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[88:91], v[24:27], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[88:91], v[28:31], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[88:91], v[32:35], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[92:95], v[4:7], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[92:95], v[8:11], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[92:95], v[12:15], a[200:203]),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[92:95], v[16:19], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[92:95], v[20:23], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[92:95], v[24:27], a[212:215]),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[92:95], v[28:31], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[92:95], v[32:35], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[96:99], v[4:7], a[224:227]),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[96:99], v[8:11], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[96:99], v[12:15], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[96:99], v[16:19], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[96:99], v[20:23], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[96:99], v[24:27], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[96:99], v[28:31], a[248:251]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[96:99], v[32:35], a[252:255]),
  s_waitcnt(simm16=64519),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[100:103], v[36:39], a[0:3]),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[100:103], v[40:43], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[100:103], v[44:47], a[8:11]),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[100:103], v[48:51], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[100:103], v[52:55], a[16:19]),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[100:103], v[56:59], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[100:103], v[60:63], a[24:27]),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[100:103], v[64:67], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[104:107], v[36:39], a[32:35]),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[104:107], v[40:43], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[104:107], v[44:47], a[40:43]),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[104:107], v[48:51], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[104:107], v[52:55], a[48:51]),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[104:107], v[56:59], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[104:107], v[60:63], a[56:59]),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[104:107], v[64:67], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[108:111], v[36:39], a[64:67]),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[108:111], v[40:43], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[108:111], v[44:47], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[108:111], v[48:51], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[108:111], v[52:55], a[80:83]),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[108:111], v[56:59], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[108:111], v[60:63], a[88:91]),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[108:111], v[64:67], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[112:115], v[36:39], a[96:99]),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[112:115], v[40:43], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[112:115], v[44:47], a[104:107]),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[112:115], v[48:51], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[112:115], v[52:55], a[112:115]),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[112:115], v[56:59], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[112:115], v[60:63], a[120:123]),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[112:115], v[64:67], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[116:119], v[36:39], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[116:119], v[40:43], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[116:119], v[44:47], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[116:119], v[48:51], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[116:119], v[52:55], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[116:119], v[56:59], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[116:119], v[60:63], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[116:119], v[64:67], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[120:123], v[36:39], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[120:123], v[40:43], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[120:123], v[44:47], a[168:171]),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[120:123], v[48:51], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[120:123], v[52:55], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[120:123], v[56:59], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[120:123], v[60:63], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[120:123], v[64:67], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[124:127], v[36:39], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[124:127], v[40:43], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[124:127], v[44:47], a[200:203]),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[124:127], v[48:51], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[124:127], v[52:55], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[124:127], v[56:59], a[212:215]),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[124:127], v[60:63], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[124:127], v[64:67], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[128:131], v[36:39], a[224:227]),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[128:131], v[40:43], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[128:131], v[44:47], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[128:131], v[48:51], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[128:131], v[52:55], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[128:131], v[56:59], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[128:131], v[60:63], a[248:251]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[128:131], v[64:67], a[252:255]),
  v_lshrrev_b32_e32(v[4], 6, v[134]),
  v_lshrrev_b32_e32(v[5], 1, v[4]),
  v_mul_lo_u32(v[5], 16, v[5]),
  v_and_b32_e32(v[1], 63, v[134]),
  v_lshrrev_b32_e32(v[1], 4, v[1]),
  v_lshlrev_b32_e32(v[1], 2, v[1]),
  v_add_lshl_u32(v[1], v[5], v[1], 3),
  v_mul_lo_u32(v[2], v[1], s[38]),
  v_mul_lo_u32(v[3], v[1], s[36]),
  v_and_b32_e32(v[0], 1, v[4]),
  v_mul_lo_u32(v[0], 16, v[0]),
  v_and_b32_e32(v[5], 15, v[134]),
  v_add_lshl_u32(v[0], v[5], v[0], 3),
  s_mul_i32(s[8], 0x100, s[2]),
  v_add_u32_e32(v[0], s[8], v[0]),
  s_mul_i32(s[8], 0x100, s[3]),
  v_add_u32_e32(v[1], s[8], v[1]),
  v_add_lshl_u32(v[11], v[3], v[0], 1),
  # TODO: should be AGPR
  v_accvgpr_read_b32(v[16], a0),
  v_accvgpr_read_b32(v[17], a4),
  v_accvgpr_read_b32(v[18], a8),
  v_accvgpr_read_b32(v[19], a12),
  v_accvgpr_read_b32(v[20], a16),
  v_accvgpr_read_b32(v[21], a20),
  v_accvgpr_read_b32(v[22], a24),
  v_accvgpr_read_b32(v[23], a28),
  v_accvgpr_read_b32(v[24], a32),
  v_accvgpr_read_b32(v[25], a36),
  v_accvgpr_read_b32(v[26], a40),
  v_accvgpr_read_b32(v[27], a44),
  v_accvgpr_read_b32(v[28], a48),
  v_accvgpr_read_b32(v[29], a52),
  v_accvgpr_read_b32(v[30], a56),
  v_accvgpr_read_b32(v[31], a60),
  v_accvgpr_read_b32(v[32], a64),
  v_accvgpr_read_b32(v[33], a68),
  v_accvgpr_read_b32(v[34], a72),
  v_accvgpr_read_b32(v[35], a76),
  v_accvgpr_read_b32(v[36], a80),
  v_accvgpr_read_b32(v[37], a84),
  v_accvgpr_read_b32(v[38], a88),
  v_accvgpr_read_b32(v[39], a92),
  v_accvgpr_read_b32(v[40], a96),
  v_accvgpr_read_b32(v[41], a100),
  v_accvgpr_read_b32(v[42], a104),
  v_accvgpr_read_b32(v[43], a108),
  v_accvgpr_read_b32(v[44], a112),
  v_accvgpr_read_b32(v[45], a116),
  v_accvgpr_read_b32(v[46], a120),
  v_accvgpr_read_b32(v[47], a124),
  v_accvgpr_read_b32(v[48], a128),
  v_accvgpr_read_b32(v[49], a132),
  v_accvgpr_read_b32(v[50], a136),
  v_accvgpr_read_b32(v[51], a140),
  v_accvgpr_read_b32(v[52], a144),
  v_accvgpr_read_b32(v[53], a148),
  v_accvgpr_read_b32(v[54], a152),
  v_accvgpr_read_b32(v[55], a156),
  v_accvgpr_read_b32(v[56], a160),
  v_accvgpr_read_b32(v[57], a164),
  v_accvgpr_read_b32(v[58], a168),
  v_accvgpr_read_b32(v[59], a172),
  v_accvgpr_read_b32(v[60], a176),
  v_accvgpr_read_b32(v[61], a180),
  v_accvgpr_read_b32(v[62], a184),
  v_accvgpr_read_b32(v[63], a188),
  v_accvgpr_read_b32(v[64], a192),
  v_accvgpr_read_b32(v[65], a196),
  v_accvgpr_read_b32(v[66], a200),
  v_accvgpr_read_b32(v[67], a204),
  v_accvgpr_read_b32(v[68], a208),
  v_accvgpr_read_b32(v[69], a212),
  v_accvgpr_read_b32(v[70], a216),
  v_accvgpr_read_b32(v[71], a220),
  v_accvgpr_read_b32(v[72], a224),
  v_accvgpr_read_b32(v[73], a228),
  v_accvgpr_read_b32(v[74], a232),
  v_accvgpr_read_b32(v[75], a236),
  v_accvgpr_read_b32(v[76], a240),
  v_accvgpr_read_b32(v[77], a244),
  v_accvgpr_read_b32(v[78], a248),
  v_accvgpr_read_b32(v[79], a252),
  v_accvgpr_read_b32(v[80], a1),
  v_accvgpr_read_b32(v[81], a5),
  v_accvgpr_read_b32(v[82], a9),
  v_accvgpr_read_b32(v[83], a13),
  v_accvgpr_read_b32(v[84], a17),
  v_accvgpr_read_b32(v[85], a21),
  v_accvgpr_read_b32(v[86], a25),
  v_accvgpr_read_b32(v[87], a29),
  v_accvgpr_read_b32(v[88], a33),
  v_accvgpr_read_b32(v[89], a37),
  v_accvgpr_read_b32(v[90], a41),
  v_accvgpr_read_b32(v[91], a45),
  v_accvgpr_read_b32(v[92], a49),
  v_accvgpr_read_b32(v[93], a53),
  v_accvgpr_read_b32(v[94], a57),
  v_accvgpr_read_b32(v[95], a61),
  v_accvgpr_read_b32(v[96], a65),
  v_accvgpr_read_b32(v[97], a69),
  v_accvgpr_read_b32(v[98], a73),
  v_accvgpr_read_b32(v[99], a77),
  v_accvgpr_read_b32(v[100], a81),
  v_accvgpr_read_b32(v[101], a85),
  v_accvgpr_read_b32(v[102], a89),
  v_accvgpr_read_b32(v[103], a93),
  v_accvgpr_read_b32(v[104], a97),
  v_accvgpr_read_b32(v[105], a101),
  v_accvgpr_read_b32(v[106], a105),
  v_accvgpr_read_b32(v[107], a109),
  v_accvgpr_read_b32(v[108], a113),
  v_accvgpr_read_b32(v[109], a117),
  v_accvgpr_read_b32(v[110], a121),
  v_accvgpr_read_b32(v[111], a125),
  v_accvgpr_read_b32(v[112], a129),
  v_accvgpr_read_b32(v[113], a133),
  v_accvgpr_read_b32(v[114], a137),
  v_accvgpr_read_b32(v[115], a141),
  v_accvgpr_read_b32(v[116], a145),
  v_accvgpr_read_b32(v[117], a149),
  v_accvgpr_read_b32(v[118], a153),
  v_accvgpr_read_b32(v[119], a157),
  v_accvgpr_read_b32(v[120], a161),
  v_accvgpr_read_b32(v[121], a165),
  v_accvgpr_read_b32(v[122], a169),
  v_accvgpr_read_b32(v[123], a173),
  v_accvgpr_read_b32(v[124], a177),
  v_accvgpr_read_b32(v[125], a181),
  v_accvgpr_read_b32(v[126], a185),
  v_accvgpr_read_b32(v[127], a189),
  v_accvgpr_read_b32(v[136], a193),
  v_accvgpr_read_b32(v[137], a197),
  v_accvgpr_read_b32(v[138], a201),
  v_accvgpr_read_b32(v[139], a205),
  v_accvgpr_read_b32(v[140], a209),
  v_accvgpr_read_b32(v[141], a213),
  v_accvgpr_read_b32(v[142], a217),
  v_accvgpr_read_b32(v[143], a221),
  v_accvgpr_read_b32(v[144], a225),
  v_accvgpr_read_b32(v[145], a229),
  v_accvgpr_read_b32(v[146], a233),
  v_accvgpr_read_b32(v[147], a237),
  v_accvgpr_read_b32(v[148], a241),
  v_accvgpr_read_b32(v[149], a245),
  v_accvgpr_read_b32(v[150], a249),
  v_accvgpr_read_b32(v[151], a253),
  v_accvgpr_read_b32(v[152], a2),
  v_accvgpr_read_b32(v[153], a6),
  v_accvgpr_read_b32(v[154], a10),
  v_accvgpr_read_b32(v[155], a14),
  v_accvgpr_read_b32(v[156], a18),
  v_accvgpr_read_b32(v[157], a22),
  v_accvgpr_read_b32(v[158], a26),
  v_accvgpr_read_b32(v[159], a30),
  v_accvgpr_read_b32(v[160], a34),
  v_accvgpr_read_b32(v[161], a38),
  v_accvgpr_read_b32(v[162], a42),
  v_accvgpr_read_b32(v[163], a46),
  v_accvgpr_read_b32(v[164], a50),
  v_accvgpr_read_b32(v[165], a54),
  v_accvgpr_read_b32(v[166], a58),
  v_accvgpr_read_b32(v[167], a62),
  v_accvgpr_read_b32(v[168], a66),
  v_accvgpr_read_b32(v[169], a70),
  v_accvgpr_read_b32(v[170], a74),
  v_accvgpr_read_b32(v[171], a78),
  v_accvgpr_read_b32(v[172], a82),
  v_accvgpr_read_b32(v[173], a86),
  v_accvgpr_read_b32(v[174], a90),
  v_accvgpr_read_b32(v[175], a94),
  v_accvgpr_read_b32(v[176], a98),
  v_accvgpr_read_b32(v[177], a102),
  v_accvgpr_read_b32(v[178], a106),
  v_accvgpr_read_b32(v[179], a110),
  v_accvgpr_read_b32(v[180], a114),
  v_accvgpr_read_b32(v[181], a118),
  v_accvgpr_read_b32(v[182], a122),
  v_accvgpr_read_b32(v[183], a126),
  v_accvgpr_read_b32(v[184], a130),
  v_accvgpr_read_b32(v[185], a134),
  v_accvgpr_read_b32(v[186], a138),
  v_accvgpr_read_b32(v[187], a142),
  v_accvgpr_read_b32(v[188], a146),
  v_accvgpr_read_b32(v[189], a150),
  v_accvgpr_read_b32(v[190], a154),
  v_accvgpr_read_b32(v[191], a158),
  v_accvgpr_read_b32(v[192], a162),
  v_accvgpr_read_b32(v[193], a166),
  v_accvgpr_read_b32(v[194], a170),
  v_accvgpr_read_b32(v[195], a174),
  v_accvgpr_read_b32(v[196], a178),
  v_accvgpr_read_b32(v[197], a182),
  v_accvgpr_read_b32(v[198], a186),
  v_accvgpr_read_b32(v[199], a190),
  v_accvgpr_read_b32(v[200], a194),
  v_accvgpr_read_b32(v[201], a198),
  v_accvgpr_read_b32(v[202], a202),
  v_accvgpr_read_b32(v[203], a206),
  v_accvgpr_read_b32(v[204], a210),
  v_accvgpr_read_b32(v[205], a214),
  v_accvgpr_read_b32(v[206], a218),
  v_accvgpr_read_b32(v[207], a222),
  v_accvgpr_read_b32(v[208], a226),
  v_accvgpr_read_b32(v[209], a230),
  v_accvgpr_read_b32(v[210], a234),
  v_accvgpr_read_b32(v[211], a238),
  v_accvgpr_read_b32(v[212], a242),
  v_accvgpr_read_b32(v[213], a246),
  v_accvgpr_read_b32(v[214], a250),
  v_accvgpr_read_b32(v[215], a254),
  v_accvgpr_read_b32(v[216], a3),
  v_accvgpr_read_b32(v[217], a7),
  v_accvgpr_read_b32(v[218], a11),
  v_accvgpr_read_b32(v[219], a15),
  v_accvgpr_read_b32(v[220], a19),
  v_accvgpr_read_b32(v[221], a23),
  v_accvgpr_read_b32(v[222], a27),
  v_accvgpr_read_b32(v[223], a31),
  v_accvgpr_read_b32(v[224], a35),
  v_accvgpr_read_b32(v[225], a39),
  v_accvgpr_read_b32(v[226], a43),
  v_accvgpr_read_b32(v[227], a47),
  v_accvgpr_read_b32(v[228], a51),
  v_accvgpr_read_b32(v[229], a55),
  v_accvgpr_read_b32(v[230], a59),
  v_accvgpr_read_b32(v[231], a63),
  v_accvgpr_read_b32(v[232], a67),
  v_accvgpr_read_b32(v[233], a71),
  v_accvgpr_read_b32(v[234], a75),
  v_accvgpr_read_b32(v[235], a79),
  v_accvgpr_read_b32(v[236], a83),
  v_accvgpr_read_b32(v[237], a87),
  v_accvgpr_read_b32(v[238], a91),
  v_accvgpr_read_b32(v[239], a95),
  v_accvgpr_read_b32(v[240], a99),
  v_accvgpr_read_b32(v[241], a103),
  v_accvgpr_read_b32(v[242], a107),
  v_accvgpr_read_b32(v[243], a111),
  v_accvgpr_read_b32(v[244], a115),
  v_accvgpr_read_b32(v[245], a119),
  v_accvgpr_read_b32(v[246], a123),
  v_accvgpr_read_b32(v[247], a127),
  v_mov_b32_e32(v[8], 0xffff0000),
  v_mov_b32_e32(v[9], 0x7fff0000),
  v_mov_b32_e32(v[10], 0x7fff),
  v_cvt_pk_bf16_f32(v[16], v[16], v[17]),
  v_cvt_pk_bf16_f32(v[17], v[18], v[19]),
  v_cvt_pk_bf16_f32(v[18], v[20], v[21]),
  v_cvt_pk_bf16_f32(v[19], v[22], v[23]),
  buffer_store_dwordx4(v[16:19], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[24], v[24], v[25]),
  v_cvt_pk_bf16_f32(v[25], v[26], v[27]),
  v_cvt_pk_bf16_f32(v[26], v[28], v[29]),
  v_cvt_pk_bf16_f32(v[27], v[30], v[31]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[24:27], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[32], v[32], v[33]),
  v_cvt_pk_bf16_f32(v[33], v[34], v[35]),
  v_cvt_pk_bf16_f32(v[34], v[36], v[37]),
  v_cvt_pk_bf16_f32(v[35], v[38], v[39]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[32:35], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[40], v[40], v[41]),
  v_cvt_pk_bf16_f32(v[41], v[42], v[43]),
  v_cvt_pk_bf16_f32(v[42], v[44], v[45]),
  v_cvt_pk_bf16_f32(v[43], v[46], v[47]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[40:43], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[48], v[48], v[49]),
  v_cvt_pk_bf16_f32(v[49], v[50], v[51]),
  v_cvt_pk_bf16_f32(v[50], v[52], v[53]),
  v_cvt_pk_bf16_f32(v[51], v[54], v[55]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[48:51], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[56], v[56], v[57]),
  v_cvt_pk_bf16_f32(v[57], v[58], v[59]),
  v_cvt_pk_bf16_f32(v[58], v[60], v[61]),
  v_cvt_pk_bf16_f32(v[59], v[62], v[63]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[56:59], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[64], v[64], v[65]),
  v_cvt_pk_bf16_f32(v[65], v[66], v[67]),
  v_cvt_pk_bf16_f32(v[66], v[68], v[69]),
  v_cvt_pk_bf16_f32(v[67], v[70], v[71]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[64:67], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[72], v[72], v[73]),
  v_cvt_pk_bf16_f32(v[73], v[74], v[75]),
  v_cvt_pk_bf16_f32(v[74], v[76], v[77]),
  v_cvt_pk_bf16_f32(v[75], v[78], v[79]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[72:75], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[80], v[80], v[81]),
  v_cvt_pk_bf16_f32(v[81], v[82], v[83]),
  v_cvt_pk_bf16_f32(v[82], v[84], v[85]),
  v_cvt_pk_bf16_f32(v[83], v[86], v[87]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[80:83], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[88], v[88], v[89]),
  v_cvt_pk_bf16_f32(v[89], v[90], v[91]),
  v_cvt_pk_bf16_f32(v[90], v[92], v[93]),
  v_cvt_pk_bf16_f32(v[91], v[94], v[95]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[88:91], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[96], v[96], v[97]),
  v_cvt_pk_bf16_f32(v[97], v[98], v[99]),
  v_cvt_pk_bf16_f32(v[98], v[100], v[101]),
  v_cvt_pk_bf16_f32(v[99], v[102], v[103]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[96:99], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[104], v[104], v[105]),
  v_cvt_pk_bf16_f32(v[105], v[106], v[107]),
  v_cvt_pk_bf16_f32(v[106], v[108], v[109]),
  v_cvt_pk_bf16_f32(v[107], v[110], v[111]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[104:107], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[112], v[112], v[113]),
  v_cvt_pk_bf16_f32(v[113], v[114], v[115]),
  v_cvt_pk_bf16_f32(v[114], v[116], v[117]),
  v_cvt_pk_bf16_f32(v[115], v[118], v[119]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[112:115], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[120], v[120], v[121]),
  v_cvt_pk_bf16_f32(v[121], v[122], v[123]),
  v_cvt_pk_bf16_f32(v[122], v[124], v[125]),
  v_cvt_pk_bf16_f32(v[123], v[126], v[127]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[120:123], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[136], v[136], v[137]),
  v_cvt_pk_bf16_f32(v[137], v[138], v[139]),
  v_cvt_pk_bf16_f32(v[138], v[140], v[141]),
  v_cvt_pk_bf16_f32(v[139], v[142], v[143]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[136:139], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[144], v[144], v[145]),
  v_cvt_pk_bf16_f32(v[145], v[146], v[147]),
  v_cvt_pk_bf16_f32(v[146], v[148], v[149]),
  v_cvt_pk_bf16_f32(v[147], v[150], v[151]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[144:147], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[152], v[152], v[153]),
  v_cvt_pk_bf16_f32(v[153], v[154], v[155]),
  v_cvt_pk_bf16_f32(v[154], v[156], v[157]),
  v_cvt_pk_bf16_f32(v[155], v[158], v[159]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[152:155], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[160], v[160], v[161]),
  v_cvt_pk_bf16_f32(v[161], v[162], v[163]),
  v_cvt_pk_bf16_f32(v[162], v[164], v[165]),
  v_cvt_pk_bf16_f32(v[163], v[166], v[167]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[160:163], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[168], v[168], v[169]),
  v_cvt_pk_bf16_f32(v[169], v[170], v[171]),
  v_cvt_pk_bf16_f32(v[170], v[172], v[173]),
  v_cvt_pk_bf16_f32(v[171], v[174], v[175]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[168:171], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[176], v[176], v[177]),
  v_cvt_pk_bf16_f32(v[177], v[178], v[179]),
  v_cvt_pk_bf16_f32(v[178], v[180], v[181]),
  v_cvt_pk_bf16_f32(v[179], v[182], v[183]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[176:179], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[184], v[184], v[185]),
  v_cvt_pk_bf16_f32(v[185], v[186], v[187]),
  v_cvt_pk_bf16_f32(v[186], v[188], v[189]),
  v_cvt_pk_bf16_f32(v[187], v[190], v[191]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[184:187], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[192], v[192], v[193]),
  v_cvt_pk_bf16_f32(v[193], v[194], v[195]),
  v_cvt_pk_bf16_f32(v[194], v[196], v[197]),
  v_cvt_pk_bf16_f32(v[195], v[198], v[199]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[192:195], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[200], v[200], v[201]),
  v_cvt_pk_bf16_f32(v[201], v[202], v[203]),
  v_cvt_pk_bf16_f32(v[202], v[204], v[205]),
  v_cvt_pk_bf16_f32(v[203], v[206], v[207]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[200:203], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[208], v[208], v[209]),
  v_cvt_pk_bf16_f32(v[209], v[210], v[211]),
  v_cvt_pk_bf16_f32(v[210], v[212], v[213]),
  v_cvt_pk_bf16_f32(v[211], v[214], v[215]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[208:211], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[216], v[216], v[217]),
  v_cvt_pk_bf16_f32(v[217], v[218], v[219]),
  v_cvt_pk_bf16_f32(v[218], v[220], v[221]),
  v_cvt_pk_bf16_f32(v[219], v[222], v[223]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[216:219], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[224], v[224], v[225]),
  v_cvt_pk_bf16_f32(v[225], v[226], v[227]),
  v_cvt_pk_bf16_f32(v[226], v[228], v[229]),
  v_cvt_pk_bf16_f32(v[227], v[230], v[231]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[224:227], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[232], v[232], v[233]),
  v_cvt_pk_bf16_f32(v[233], v[234], v[235]),
  v_cvt_pk_bf16_f32(v[234], v[236], v[237]),
  v_cvt_pk_bf16_f32(v[235], v[238], v[239]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[232:235], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[240], v[240], v[241]),
  v_cvt_pk_bf16_f32(v[241], v[242], v[243]),
  v_cvt_pk_bf16_f32(v[242], v[244], v[245]),
  v_cvt_pk_bf16_f32(v[243], v[246], v[247]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[240:243], v[11], s[16:19], 0, offen=1, nt=1),
  s_nop(0),
  v_accvgpr_read_b32(v[16], a131),
  v_accvgpr_read_b32(v[17], a135),
  v_accvgpr_read_b32(v[18], a139),
  v_accvgpr_read_b32(v[19], a143),
  v_accvgpr_read_b32(v[20], a147),
  v_accvgpr_read_b32(v[21], a151),
  v_accvgpr_read_b32(v[22], a155),
  v_accvgpr_read_b32(v[23], a159),
  v_accvgpr_read_b32(v[24], a163),
  v_accvgpr_read_b32(v[25], a167),
  v_accvgpr_read_b32(v[26], a171),
  v_accvgpr_read_b32(v[27], a175),
  v_accvgpr_read_b32(v[28], a179),
  v_accvgpr_read_b32(v[29], a183),
  v_accvgpr_read_b32(v[30], a187),
  v_accvgpr_read_b32(v[31], a191),
  v_accvgpr_read_b32(v[32], a195),
  v_accvgpr_read_b32(v[33], a199),
  v_accvgpr_read_b32(v[34], a203),
  v_accvgpr_read_b32(v[35], a207),
  v_accvgpr_read_b32(v[36], a211),
  v_accvgpr_read_b32(v[37], a215),
  v_accvgpr_read_b32(v[38], a219),
  v_accvgpr_read_b32(v[39], a223),
  v_accvgpr_read_b32(v[40], a227),
  v_accvgpr_read_b32(v[41], a231),
  v_accvgpr_read_b32(v[42], a235),
  v_accvgpr_read_b32(v[43], a239),
  v_accvgpr_read_b32(v[44], a243),
  v_accvgpr_read_b32(v[45], a247),
  v_accvgpr_read_b32(v[46], a251),
  v_accvgpr_read_b32(v[47], a255),
  v_mov_b32_e32(v[8], 0xffff0000),
  v_mov_b32_e32(v[9], 0x7fff0000),
  v_mov_b32_e32(v[10], 0x7fff),
  v_cvt_pk_bf16_f32(v[16], v[16], v[17]),
  v_cvt_pk_bf16_f32(v[17], v[18], v[19]),
  v_cvt_pk_bf16_f32(v[18], v[20], v[21]),
  v_cvt_pk_bf16_f32(v[19], v[22], v[23]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[16:19], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[24], v[24], v[25]),
  v_cvt_pk_bf16_f32(v[25], v[26], v[27]),
  v_cvt_pk_bf16_f32(v[26], v[28], v[29]),
  v_cvt_pk_bf16_f32(v[27], v[30], v[31]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[24:27], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[32], v[32], v[33]),
  v_cvt_pk_bf16_f32(v[33], v[34], v[35]),
  v_cvt_pk_bf16_f32(v[34], v[36], v[37]),
  v_cvt_pk_bf16_f32(v[35], v[38], v[39]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[32:35], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[40], v[40], v[41]),
  v_cvt_pk_bf16_f32(v[41], v[42], v[43]),
  v_cvt_pk_bf16_f32(v[42], v[44], v[45]),
  v_cvt_pk_bf16_f32(v[43], v[46], v[47]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[40:43], v[11], s[16:19], 0, offen=1, nt=1),
  s_nop(0),
  s_endpgm(),
]


# verify a single instruction against llvm

def prepare_verification():
  import pathlib
  raw_txt_lines:list[str] = []
  for l in open(pathlib.Path(__file__).parent/"gemm.s"):
    if l.strip().startswith("//"): continue
    if not l.strip(): continue
    raw_txt_lines.append(l.strip())
  code:list[str] = []
  on = False
  for l in open(__file__):
    if on and l.strip() == "]": break
    if on: code.append(l.strip())
    elif "[" in l: on = True
  return raw_txt_lines, code

if __name__ == "__main__":
  raw_txt_lines, python_code = prepare_verification()

  assert len(python_code) == len(gemm)
  for py_txt,asm_txt,inst in zip(python_code, raw_txt_lines, gemm):
    ref = compile_asm(asm_txt)
    print(asm_txt)
    b = inst.to_bytes()
    st = inst.disasm()
    reasm = asm(st, arch='cdna')
    desc = f"{st:25s} {inst} {b!r} {reasm}"
    ref = compile_asm(st)
    assert b == ref == reasm.to_bytes(), f"Bytes mismatch {b} != {ref} for {st}"
