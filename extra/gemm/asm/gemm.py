import functools
from extra.assembly.amd.autogen.cdna import *
from extra.assembly.amd.asm import asm
from extra.assembly.amd.dsl import Inst, RawImm, a
from extra.assembly.amd.test.test_roundtrip import compile_asm

compile_asm = functools.partial(compile_asm, mcpu='gfx950', mattr='+wavefrontsize64')
# HACKS: cdna is 64 lanes
VCC = VCC_LO
EXEC = EXEC_LO

gemm = [
  s_load_dwordx2(sdata=s[28:29], sbase=s[0:1], offset=0x0, imm=1, soffset=RawImm(0)),
  s_load_dwordx4(sdata=s[32:35], sbase=s[0:1], offset=0x8, imm=1, soffset=RawImm(0)),
  s_load_dword(sdata=s[24], sbase=s[0:1], offset=0x18, imm=1, soffset=RawImm(0)),
  s_load_dword(sdata=s[54], sbase=s[0:1], offset=0x1C, imm=1, soffset=RawImm(0)),
  s_waitcnt(simm16=0xc07f),
  s_mov_b32(s[51], 1),
  s_mov_b32(s[53], 1),
  s_mov_b32(s[11], 0x40010020),
  s_mov_b32(s[25], s[24]),
  s_mov_b32(s[26], 1),
  s_mov_b32(s[27], s[24]),
  s_mov_b32(s[36], s[24]),
  s_mov_b32(s[37], 0),
  s_mov_b32(s[38], s[24]),
  s_mov_b32(s[39], 0),
  s_mov_b32(s[40], s[24]),
  s_mov_b32(s[41], 0),
  s_mov_b32(s[42], s[24]),
  s_mov_b32(s[43], 0),
  s_lshr_b32(s[52], s[51], 30),
  s_and_b32(s[51], 0x3fffffff, s[51]),
  s_cmp_eq_u32(s[52], 0),
  s_and_b32(s[10], s[53], 0xffff0000),
  s_lshr_b32(s[10], s[10], 16),
  s_and_b32(s[50], s[53], 0xffff),
  s_mov_b32(s[5], s[52]),
  s_mov_b32(M0, 0x20800),
  v_mov_b32_e32(v[134], v[0]),
  s_lshr_b32(s[60], s[11], 16),
  s_ff1_i32_b32(s[60], s[60]),
  s_lshr_b32(s[61], s[11], 22),
  v_and_b32_e32(v[5], 63, v[134]),
  v_and_b32_e32(v[4], 15, v[5]),
  v_lshlrev_b32_e32(v[4], 6, v[4]),
  v_lshlrev_b32_e32(v[4], 3, v[4]),
  v_lshrrev_b32_e32(v[5], 4, v[5]),
  v_lshl_add_u32(vdst=v[4], src0=v[5], src1=3, src2=v[4]),
  v_lshrrev_b32_e32(v[8], 6, v[134]),
  v_and_b32_e32(v[8], 1, v[8]),
  v_lshl_add_u32(vdst=v[4], src0=v[8], src1=13, src2=v[4]),
  v_and_b32_e32(v[6], 63, v[134]),
  v_and_b32_e32(v[5], 15, v[6]),
  v_lshlrev_b32_e32(v[5], 6, v[5]),
  v_lshlrev_b32_e32(v[5], 3, v[5]),
  v_lshrrev_b32_e32(v[6], 4, v[6]),
  v_lshl_add_u32(vdst=v[5], src0=v[6], src1=3, src2=v[5]),
  v_lshrrev_b32_e32(v[7], 7, v[134]),
  v_and_b32_e32(v[7], 1, v[7]),
  v_lshl_add_u32(vdst=v[5], src0=v[7], src1=13, src2=v[5]),
  v_lshrrev_b32_e32(v[6], 6, v[134]),
  v_lshrrev_b32_e32(v[6], 2, v[6]),
  s_mov_b32(s[53], 64),
  v_mul_lo_u32(vdst=v[6], src0=s[53], src1=v[6]),
  v_add_lshl_u32(vdst=v[2], src0=v[6], src1=v[4], src2=1),
  v_lshrrev_b32_e32(v[7], 10, v[2]),
  v_lshl_add_u32(vdst=v[2], src0=v[7], src1=4, src2=v[2]),
  v_lshrrev_b32_e32(v[4], 6, v[134]),
  v_lshrrev_b32_e32(v[4], 2, v[4]),
  v_mul_lo_u32(vdst=v[4], src0=s[53], src1=v[4]),
  v_add_lshl_u32(vdst=v[3], src0=v[4], src1=v[5], src2=1),
  v_lshrrev_b32_e32(v[6], 10, v[3]),
  v_lshl_add_u32(vdst=v[3], src0=v[6], src1=4, src2=v[3]),
  v_add_co_u32_e32(v[3], 0x8200, v[3]),
  v_add_u32_e32(v[132], 0x10400, v[2]),
  v_xor_b32_e32(v[132], v[132], v[2]),
  v_add_u32_e32(v[133], 0x10400, v[3]),
  v_xor_b32_e32(v[133], v[133], v[3]),
  v_lshrrev_b32_e32(v[4], 3, v[134]),
  v_and_b32_e32(v[5], 7, v[134]),
  v_lshlrev_b32_e32(v[5], 3, v[5]),
  v_mov_b32_e32(v[8], v[5]),
  v_lshrrev_b32_e32(v[6], 3, v[134]),
  v_and_b32_e32(v[7], 7, v[134]),
  v_lshlrev_b32_e32(v[7], 3, v[7]),
  v_mov_b32_e32(v[9], v[7]),
  v_mul_u32_u24_e32(v[10], 64, v[4]),
  v_add_lshl_u32(vdst=v[10], src0=v[8], src1=v[10], src2=1),
  v_lshrrev_b32_e32(v[12], 10, v[10]),
  v_lshl_add_u32(vdst=v[10], src0=v[12], src1=4, src2=v[10]),
  s_nop(0),
  v_readfirstlane_b32_e32(vdst=s[46], src0=v[10]),
  s_nop(0),
  s_add_u32(s[48], s[46], 0x10400),
  s_xor_b32(s[48], s[48], s[46]),
  v_mul_u32_u24_e32(v[10], 64, v[6]),
  v_add_lshl_u32(vdst=v[10], src0=v[9], src1=v[10], src2=1),
  v_lshrrev_b32_e32(v[12], 10, v[10]),
  v_lshl_add_u32(vdst=v[10], src0=v[12], src1=4, src2=v[10]),
  v_add_co_u32_e32(v[10], 0x8200, v[10]),
  s_nop(0),
  v_readfirstlane_b32_e32(vdst=s[47], src0=v[10]),
  s_nop(0),
  s_add_u32(s[49], s[47], 0x10400),
  s_xor_b32(s[49], s[49], s[47]),
  v_mov_b32_e32(v[12], 0x100),
  v_mov_b32_e32(v[11], s[24]),
  v_cvt_f32_u32_e32(v[10], v[12]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[13], v[11]),
  v_mul_f32_e32(v[10], v[10], v[13]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e32(v[13], v[10], v[12]),
  v_sub_u32_e32(v[13], v[11], v[13]),
  v_cmp_ne_u32(vdst=VCC, src0=v[13], src1=0),  # vdst=VCC_LO=106
  v_addc_co_u32(vdst=v[10], sdst=VCC, src0=v[10], src1=0, src2=VCC_LO),
  v_mov_b32_e32(v[12], 0x100),
  v_mov_b32_e32(v[11], s[25]),
  v_readfirstlane_b32_e32(vdst=s[14], src0=v[10]),
  v_cvt_f32_u32_e32(v[10], v[12]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[13], v[11]),
  v_mul_f32_e32(v[10], v[10], v[13]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e32(v[13], v[10], v[12]),
  v_sub_u32_e32(v[13], v[11], v[13]),
  v_cmp_ne_u32(vdst=VCC, src0=v[13], src1=0),
  v_addc_co_u32(vdst=v[10], sdst=VCC, src0=v[10], src1=0, src2=VCC_LO),
  s_nop(0),
  v_readfirstlane_b32_e32(vdst=s[15], src0=v[10]),
  s_waitcnt(simm16=0xc07f),
  s_mul_i32(s[52], s[14], s[15]),
  s_and_b32(s[53], s[50], 0x3fff),
  s_mul_i32(s[52], s[52], s[53]),
  v_cvt_f32_u32_e32(v[10], s[52]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[11], s[2]),
  v_mul_f32_e32(v[10], v[10], v[11]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24(vdst=v[11], src0=v[10], src1=s[52]),
  v_sub_u32_e32(v[11], s[2], v[11]),
  v_cmpx_eq_u32(vdst=EXEC, src0=v[11], src1=s[52]),  # vdst=EXEC_LO=126
  v_add_u32_e32(v[10], 1, v[10]),
  s_mov_b64(s[126:127], -1),  # EXEC = -1 (all ones)
  v_cmpx_gt_u32(vdst=EXEC, src0=v[11], src1=s[52]),
  v_sub_u32(vdst=v[10], src0=v[10], src1=1),
  s_mov_b64(s[126:127], -1),
  v_readfirstlane_b32_e32(vdst=s[52], src0=v[10]),
  s_mov_b32(s[4], s[52]),
  s_mul_i32(s[52], s[15], s[14]),
  s_mul_i32(s[52], s[52], s[4]),
  s_mul_i32(s[52], s[52], s[53]),
  s_sub_u32(s[2], s[2], s[52]),
  v_cvt_f32_u32_e32(v[10], s[14]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[11], s[2]),
  v_mul_f32_e32(v[10], v[10], v[11]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24(vdst=v[11], src0=v[10], src1=s[14]),
  v_sub_u32_e32(v[11], s[2], v[11]),
  v_cmpx_eq_u32(vdst=EXEC, src0=v[11], src1=s[14]),
  v_add_u32_e32(v[10], 1, v[10]),
  s_mov_b64(s[126:127], -1),
  v_cmpx_gt_u32(vdst=EXEC, src0=v[11], src1=s[14]),
  v_sub_u32(vdst=v[10], src0=v[10], src1=1),
  s_mov_b64(s[126:127], -1),
  v_readfirstlane_b32_e32(vdst=s[52], src0=v[10]),
  s_mov_b32(s[3], s[52]),
  s_mul_i32(s[52], s[3], s[14]),
  s_sub_u32(s[2], s[2], s[52]),
  s_sub_u32(s[32], s[32], 16),
  s_subb_u32(s[33], s[33], 0),
  s_sub_u32(s[34], s[34], 16),
  s_subb_u32(s[35], s[35], 0),
  s_and_b32(s[84], s[50], 0x3fff),
  s_mov_b64(s[6:7], 0),
  s_mov_b32(s[8], 1),
  s_mov_b32(s[9], 1),
  s_sext_i32_i16(s[11], s[11]),
  v_mul_lo_u32(vdst=v[10], src0=s[40], src1=v[4]),
  v_add_co_u32_e32(v[0], v[5], v[10]),
  v_add_u32_e32(v[0], 8, v[0]),
  v_lshlrev_b32_e32(v[0], 1, v[0]),
  s_mul_i32(s[70], s[40], 32),
  s_lshl_b32(s[70], s[70], 1),
  s_mul_i32(s[71], s[40], 64),
  s_lshl_b32(s[71], s[71], 1),
  s_mul_i32(s[72], s[40], 0x60),
  s_lshl_b32(s[72], s[72], 1),
  s_mul_i32(s[73], s[40], 0x80),
  s_lshl_b32(s[73], s[73], 1),
  s_mul_i32(s[74], s[40], 0xa0),
  s_lshl_b32(s[74], s[74], 1),
  s_mul_i32(s[75], s[40], 0xc0),
  s_lshl_b32(s[75], s[75], 1),
  s_mul_i32(s[76], s[40], 0xe0),
  s_lshl_b32(s[76], s[76], 1),
  v_mul_lo_u32(vdst=v[10], src0=s[42], src1=v[6]),
  v_add_co_u32_e32(v[1], v[7], v[10]),
  v_add_u32_e32(v[1], 8, v[1]),
  v_lshlrev_b32_e32(v[1], 1, v[1]),
  s_mul_i32(s[77], s[42], 32),
  s_lshl_b32(s[77], s[77], 1),
  s_mul_i32(s[78], s[42], 64),
  s_lshl_b32(s[78], s[78], 1),
  s_mul_i32(s[79], s[42], 0x60),
  s_lshl_b32(s[79], s[79], 1),
  s_mul_i32(s[80], s[42], 0x80),
  s_lshl_b32(s[80], s[80], 1),
  s_mul_i32(s[81], s[42], 0xa0),
  s_lshl_b32(s[81], s[81], 1),
  s_mul_i32(s[82], s[42], 0xc0),
  s_lshl_b32(s[82], s[82], 1),
  s_mul_i32(s[83], s[42], 0xe0),
  s_lshl_b32(s[83], s[83], 1),
  s_mul_hi_u32(s[87], s[2], 0x100),
  s_mul_i32(s[86], s[2], 0x100),
  s_mul_hi_u32(s[87], s[86], s[40]),
  s_mul_i32(s[86], s[86], s[40]),
  s_and_b32(s[84], s[50], 0x8000),
  s_mul_hi_u32(s[85], 64, s[6]),
  s_mul_i32(s[84], 64, s[6]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_mov_b64(s[60:61], 1),
  s_sub_u32(s[84], s[27], 1),
  s_mul_hi_u32(s[85], 1, s[84]),
  s_mul_i32(s[84], 1, s[84]),
  s_add_u32(s[60], s[60], s[84]),
  s_addc_u32(s[61], s[61], s[85]),
  s_sub_u32(s[84], s[24], 1),
  s_mul_hi_u32(s[85], s[40], s[84]),
  s_mul_i32(s[84], s[40], s[84]),
  s_add_u32(s[60], s[60], s[84]),
  s_addc_u32(s[61], s[61], s[85]),
  s_sub_u32(s[60], s[60], s[86]),
  s_subb_u32(s[61], s[61], s[87]),
  s_lshl_b64(s[60:61], s[60:61], 1),
  s_add_u32(s[60], s[60], 16),
  s_addc_u32(s[61], s[61], 0),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_mul_hi_u32(s[85], s[41], s[4]),
  s_mul_i32(s[84], s[41], s[4]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_lshl_b64(s[86:87], s[86:87], 1),
  s_add_u32(s[52], s[32], s[86]),
  s_addc_u32(s[53], s[33], s[87]),
  s_mov_b32(s[55], 0x20000),
  s_mul_hi_u32(s[87], s[3], 0x100),
  s_mul_i32(s[86], s[3], 0x100),
  s_mul_hi_u32(s[87], s[86], s[42]),
  s_mul_i32(s[86], s[86], s[42]),
  s_and_b32(s[84], s[50], 0x8000),
  s_mul_hi_u32(s[85], 64, s[6]),
  s_mul_i32(s[84], 64, s[6]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_mov_b64(s[62:63], 1),
  s_sub_u32(s[84], s[27], 1),
  s_mul_hi_u32(s[85], 1, s[84]),
  s_mul_i32(s[84], 1, s[84]),
  s_add_u32(s[62], s[62], s[84]),
  s_addc_u32(s[63], s[63], s[85]),
  s_sub_u32(s[84], s[25], 1),
  s_mul_hi_u32(s[85], s[42], s[84]),
  s_mul_i32(s[84], s[42], s[84]),
  s_add_u32(s[62], s[62], s[84]),
  s_addc_u32(s[63], s[63], s[85]),
  s_sub_u32(s[62], s[62], s[86]),
  s_subb_u32(s[63], s[63], s[87]),
  s_lshl_b64(s[62:63], s[62:63], 1),
  s_add_u32(s[62], s[62], 16),
  s_addc_u32(s[63], s[63], 0),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  s_mul_hi_u32(s[85], s[43], s[4]),
  s_mul_i32(s[84], s[43], s[4]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_lshl_b64(s[86:87], s[86:87], 1),
  s_add_u32(s[56], s[34], s[86]),
  s_addc_u32(s[57], s[35], s[87]),
  s_mov_b32(s[59], 0x20000),
  s_and_b32(s[85], s[50], 0x3fff),
  s_mul_i32(s[85], s[85], 0x80),
  s_and_b32(s[84], s[50], 0x8000),
  s_cselect_b32(s[68], 0x80, s[85]),
  s_and_b32(s[85], s[50], 0x3fff),
  s_mul_i32(s[85], s[85], 0x80),
  s_and_b32(s[84], s[50], 0x8000),
  s_cselect_b32(s[69], 0x80, s[85]),
  s_lshr_b32(s[12], s[27], 6),
  s_and_b32(s[84], s[50], 0x3fff),
  s_mov_b32(s[13], s[12]),
  s_and_b32(s[86], s[10], 0x1f00),
  s_lshr_b32(s[86], s[86], 8),
  s_and_b32(s[87], s[10], 0xe000),
  s_and_b32(s[10], s[10], 0xff),
  s_mov_b32(s[84], s[10]),
  s_lshl_b32(s[85], s[84], s[86]),
  s_cmp_ge_u32(s[13], s[85]),
  s_sub_u32(s[85], s[84], 1),
  s_cmp_ge_u32(s[84], 1),
  s_cselect_b32(s[51], s[85], 0),
  s_cmp_eq_u32(s[87], 0x2000),
  s_and_b32(s[51], s[51], s[84]),
  s_lshl_b32(s[51], s[51], s[86]),
  s_mul_hi_i32(s[85], s[51], s[68]),
  s_mul_i32(s[84], s[51], s[68]),
  s_mul_hi_i32(s[65], s[12], s[68]),
  s_mul_i32(s[64], s[12], s[68]),
  s_sub_u32(s[64], s[68], s[64]),
  s_subb_u32(s[65], 0, s[65]),
  s_add_u32(s[52], s[52], s[84]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_mul_hi_i32(s[85], s[51], s[69]),
  s_mul_i32(s[84], s[51], s[69]),
  s_mul_hi_i32(s[67], s[12], s[69]),
  s_mul_i32(s[66], s[12], s[69]),
  s_sub_u32(s[66], s[69], s[66]),
  s_subb_u32(s[67], 0, s[67]),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  s_sub_u32(s[62], s[62], s[84]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  v_cmp_ne_u32(vdst=VCC, src0=v[13], src1=0),
  v_addc_co_u32(vdst=v[10], sdst=VCC, src0=v[10], src1=0, src2=VCC),
  v_mov_b32_e32(v[12], 0x100),
  v_mov_b32_e32(v[11], s[25]),
  v_readfirstlane_b32_e32(vdst=s[14], src0=v[10]),
  v_cvt_f32_u32_e32(v[10], v[12]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[13], v[11]),
  v_mul_f32_e32(v[10], v[10], v[13]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24_e32(v[13], v[10], v[12]),
  v_sub_u32_e32(v[13], v[11], v[13]),
  v_cmp_ne_u32(vdst=VCC, src0=v[13], src1=0),
  v_addc_co_u32(vdst=v[10], sdst=VCC, src0=v[10], src1=0, src2=VCC),
  s_nop(0),
  v_readfirstlane_b32_e32(vdst=s[15], src0=v[10]),
  s_waitcnt(simm16=0xc07f),
  s_mul_i32(s[52], s[14], s[15]),
  s_and_b32(s[53], s[50], 0x3fff),
  s_mul_i32(s[52], s[52], s[53]),
  v_cvt_f32_u32_e32(v[10], s[52]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[11], s[2]),
  v_mul_f32_e32(v[10], v[10], v[11]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24(vdst=v[11], src0=v[10], src1=s[52]),
  v_sub_u32_e32(v[11], s[2], v[11]),
  v_cmpx_eq_u32(vdst=EXEC, src0=v[11], src1=s[52]),
  v_add_u32_e32(v[10], 1, v[10]),
  s_mov_b64(EXEC_LO, -1),
  v_cmpx_gt_u32(vdst=EXEC, src0=v[11], src1=s[52]),
  v_sub_u32(vdst=v[10], src0=v[10], src1=1),
  s_mov_b64(EXEC_LO, -1),
  v_readfirstlane_b32_e32(vdst=s[52], src0=v[10]),
  s_mov_b32(s[4], s[52]),
  s_mul_i32(s[52], s[15], s[14]),
  s_mul_i32(s[52], s[52], s[4]),
  s_mul_i32(s[52], s[52], s[53]),
  s_sub_u32(s[2], s[2], s[52]),
  v_cvt_f32_u32_e32(v[10], s[14]),
  v_rcp_iflag_f32_e32(v[10], v[10]),
  v_cvt_f32_u32_e32(v[11], s[2]),
  v_mul_f32_e32(v[10], v[10], v[11]),
  v_cvt_u32_f32_e32(v[10], v[10]),
  v_mul_u32_u24(vdst=v[11], src0=v[10], src1=s[14]),
  v_sub_u32_e32(v[11], s[2], v[11]),
  v_cmpx_eq_u32(vdst=EXEC, src0=v[11], src1=s[14]),
  v_add_u32_e32(v[10], 1, v[10]),
  s_mov_b64(EXEC_LO, -1),
  v_cmpx_gt_u32(vdst=EXEC, src0=v[11], src1=s[14]),
  v_sub_u32(vdst=v[10], src0=v[10], src1=1),
  s_mov_b64(EXEC_LO, -1),
  v_readfirstlane_b32_e32(vdst=s[52], src0=v[10]),
  s_mov_b32(s[3], s[52]),
  s_mul_i32(s[52], s[3], s[14]),
  s_sub_u32(s[2], s[2], s[52]),
  s_sub_u32(s[32], s[32], 16),
  s_subb_u32(s[33], s[33], 0),
  s_sub_u32(s[34], s[34], 16),
  s_subb_u32(s[35], s[35], 0),
  s_and_b32(s[84], s[50], 0x3fff),
  s_mov_b64(s[6:7], 0),
  s_mov_b32(s[8], 1),
  s_mov_b32(s[9], 1),
  s_sext_i32_i16(s[11], s[11]),
  v_mul_lo_u32(v[10], s[40], v[4]),
  v_add_co_u32_e32(v[0], VCC_LO, v[5], v[10]),
  v_add_u32_e32(v[0], 8, v[0]),
  v_lshlrev_b32_e32(v[0], 1, v[0]),
  s_mul_i32(s[70], s[40], 32),
  s_lshl_b32(s[70], s[70], 1),
  s_mul_i32(s[71], s[40], 64),
  s_lshl_b32(s[71], s[71], 1),
  s_mul_i32(s[72], s[40], 0x60),
  s_lshl_b32(s[72], s[72], 1),
  s_mul_i32(s[73], s[40], 0x80),
  s_lshl_b32(s[73], s[73], 1),
  s_mul_i32(s[74], s[40], 0xa0),
  s_lshl_b32(s[74], s[74], 1),
  s_mul_i32(s[75], s[40], 0xc0),
  s_lshl_b32(s[75], s[75], 1),
  s_mul_i32(s[76], s[40], 0xe0),
  s_lshl_b32(s[76], s[76], 1),
  v_mul_lo_u32(v[10], s[42], v[6]),
  v_add_co_u32_e32(v[1], VCC_LO, v[7], v[10]),
  v_add_u32_e32(v[1], 8, v[1]),
  v_lshlrev_b32_e32(v[1], 1, v[1]),
  s_mul_i32(s[77], s[42], 32),
  s_lshl_b32(s[77], s[77], 1),
  s_mul_i32(s[78], s[42], 64),
  s_lshl_b32(s[78], s[78], 1),
  s_mul_i32(s[79], s[42], 0x60),
  s_lshl_b32(s[79], s[79], 1),
  s_mul_i32(s[80], s[42], 0x80),
  s_lshl_b32(s[80], s[80], 1),
  s_mul_i32(s[81], s[42], 0xa0),
  s_lshl_b32(s[81], s[81], 1),
  s_mul_i32(s[82], s[42], 0xc0),
  s_lshl_b32(s[82], s[82], 1),
  s_mul_i32(s[83], s[42], 0xe0),
  s_lshl_b32(s[83], s[83], 1),
  s_mul_hi_u32(s[87], s[2], 0x100),
  s_mul_i32(s[86], s[2], 0x100),
  s_mul_hi_u32(s[87], s[86], s[40]),
  s_mul_i32(s[86], s[86], s[40]),
  s_and_b32(s[84], s[50], 0x8000),
  s_cbranch_scc1("skip_offset_A"),
  s_mul_hi_u32(s[85], 64, s[6]),
  s_mul_i32(s[84], 64, s[6]),
  "skip_offset_A:",
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_mov_b64(s[60:61], 1),
  s_sub_u32(s[84], s[27], 1),
  s_mul_hi_u32(s[85], 1, s[84]),
  s_mul_i32(s[84], 1, s[84]),
  s_add_u32(s[60], s[60], s[84]),
  s_addc_u32(s[61], s[61], s[85]),
  s_sub_u32(s[84], s[24], 1),
  s_mul_hi_u32(s[85], s[40], s[84]),
  s_mul_i32(s[84], s[40], s[84]),
  s_add_u32(s[60], s[60], s[84]),
  s_addc_u32(s[61], s[61], s[85]),
  s_sub_u32(s[60], s[60], s[86]),
  s_subb_u32(s[61], s[61], s[87]),
  s_lshl_b64(s[60:61], s[60:61], 1),
  s_add_u32(s[60], s[60], 16),
  s_addc_u32(s[61], s[61], 0),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_mul_hi_u32(s[85], s[41], s[4]),
  s_mul_i32(s[84], s[41], s[4]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_lshl_b64(s[86:87], s[86:87], 1),
  s_add_u32(s[52], s[32], s[86]),
  s_addc_u32(s[53], s[33], s[87]),
  s_mov_b32(s[55], 0x20000),
  s_mul_hi_u32(s[87], s[3], 0x100),
  s_mul_i32(s[86], s[3], 0x100),
  s_mul_hi_u32(s[87], s[86], s[42]),
  s_mul_i32(s[86], s[86], s[42]),
  s_and_b32(s[84], s[50], 0x8000),
  s_cbranch_scc1("skip_offset_B"),
  s_mul_hi_u32(s[85], 64, s[6]),
  s_mul_i32(s[84], 64, s[6]),
  "skip_offset_B:",
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_mov_b64(s[62:63], 1),
  s_sub_u32(s[84], s[27], 1),
  s_mul_hi_u32(s[85], 1, s[84]),
  s_mul_i32(s[84], 1, s[84]),
  s_add_u32(s[62], s[62], s[84]),
  s_addc_u32(s[63], s[63], s[85]),
  s_sub_u32(s[84], s[25], 1),
  s_mul_hi_u32(s[85], s[42], s[84]),
  s_mul_i32(s[84], s[42], s[84]),
  s_add_u32(s[62], s[62], s[84]),
  s_addc_u32(s[63], s[63], s[85]),
  s_sub_u32(s[62], s[62], s[86]),
  s_subb_u32(s[63], s[63], s[87]),
  s_lshl_b64(s[62:63], s[62:63], 1),
  s_add_u32(s[62], s[62], 16),
  s_addc_u32(s[63], s[63], 0),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  s_mul_hi_u32(s[85], s[43], s[4]),
  s_mul_i32(s[84], s[43], s[4]),
  s_add_u32(s[86], s[86], s[84]),
  s_addc_u32(s[87], s[87], s[85]),
  s_lshl_b64(s[86:87], s[86:87], 1),
  s_add_u32(s[56], s[34], s[86]),
  s_addc_u32(s[57], s[35], s[87]),
  s_mov_b32(s[59], 0x20000),
  s_and_b32(s[85], s[50], 0x3fff),
  s_mul_i32(s[85], s[85], 0x80),
  s_and_b32(s[84], s[50], 0x8000),
  s_cselect_b32(s[68], 0x80, s[85]),
  s_and_b32(s[85], s[50], 0x3fff),
  s_mul_i32(s[85], s[85], 0x80),
  s_and_b32(s[84], s[50], 0x8000),
  s_cselect_b32(s[69], 0x80, s[85]),
  s_lshr_b32(s[12], s[27], 6),
  s_and_b32(s[84], s[50], 0x3fff),
  s_mov_b32(s[13], s[12]),
  s_and_b32(s[86], s[10], 0x1f00),
  s_lshr_b32(s[86], s[86], 8),
  s_and_b32(s[87], s[10], 0xe000),
  s_and_b32(s[10], s[10], 0xff),
  s_mov_b32(s[84], s[10]),
  s_lshl_b32(s[85], s[84], s[86]),
  s_cmp_ge_u32(s[13], s[85]),
  s_sub_u32(s[85], s[84], 1),
  s_cmp_ge_u32(s[84], 1),
  s_cselect_b32(s[51], s[85], 0),
  s_cmp_eq_u32(s[87], 0x2000),
  s_and_b32(s[51], s[51], s[84]),
  s_lshl_b32(s[51], s[51], s[86]),
  s_mul_hi_i32(s[85], s[51], s[68]),
  s_mul_i32(s[84], s[51], s[68]),
  s_mul_hi_i32(s[65], s[12], s[68]),
  s_mul_i32(s[64], s[12], s[68]),
  s_sub_u32(s[64], s[68], s[64]),
  s_subb_u32(s[65], 0, s[65]),
  s_add_u32(s[52], s[52], s[84]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_mul_hi_i32(s[85], s[51], s[69]),
  s_mul_i32(s[84], s[51], s[69]),
  s_mul_hi_i32(s[67], s[12], s[69]),
  s_mul_i32(s[66], s[12], s[69]),
  s_sub_u32(s[66], s[69], s[66]),
  s_subb_u32(s[67], 0, s[67]),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  s_sub_u32(s[62], s[62], s[84]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  s_add_u32(s[51], s[51], 2),
  s_cmp_eq_u32(s[12], 0),
  s_cbranch_scc1("init_output_buffers"),
  s_mov_b32(M0, s[46]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[70], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[71], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[72], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[73], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[74], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[75], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[76], offen=1, lds=1),
  s_mov_b32(M0, s[47]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[77], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[78], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  v_accvgpr_write(a[0], 0),
  v_accvgpr_write(a[1], 0),
  v_accvgpr_write(a[2], 0),
  v_accvgpr_write(a[3], 0),
  v_accvgpr_write(a[4], 0),
  v_accvgpr_write(a[5], 0),
  v_accvgpr_write(a[6], 0),
  v_accvgpr_write(a[7], 0),
  v_accvgpr_write(a[8], 0),
  v_accvgpr_write(a[9], 0),
  v_accvgpr_write(a[10], 0),
  v_accvgpr_write(a[11], 0),
  v_accvgpr_write(a[12], 0),
  v_accvgpr_write(a[13], 0),
  v_accvgpr_write(a[14], 0),
  v_accvgpr_write(a[15], 0),
  v_mov_b64_e32(v[6:7], 0),
  v_mov_b64_e32(v[8:9], 0),
  v_mfma_f32_32x32x16_bf16(a[16:31], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[32:47], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[48:63], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[64:79], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[80:95], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[96:111], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[112:127], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[128:143], v[6:9], v[6:9], a[0:15]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[79], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_32x32x16_bf16(a[144:159], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[160:175], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[176:191], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[192:207], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[208:223], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[224:239], v[6:9], v[6:9], a[0:15]),
  v_mfma_f32_32x32x16_bf16(a[240:255], v[6:9], v[6:9], a[0:15]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[80], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[81], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[82], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[83], offen=1, lds=1),
  s_add_u32(s[86], s[12], 1),
  s_cmp_eq_u32(s[51], s[86]),
  s_cselect_b32(s[84], s[64], s[68]),
  s_cselect_b32(s[85], s[65], 0),
  s_add_u32(s[52], s[52], s[84]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  s_cselect_b32(s[54], s[60], -1),
  s_add_u32(s[86], s[12], 1),
  s_cmp_eq_u32(s[51], s[86]),
  s_cselect_b32(s[84], s[66], s[69]),
  s_cselect_b32(s[85], s[67], 0),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  s_sub_u32(s[62], s[62], s[84]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  s_cselect_b32(s[58], s[62], -1),
  "init_output_buffers:",
  s_mov_b64(s[16:17], s[28:29]),
  s_mov_b32(s[18], 0x80000000),
  s_mov_b32(s[19], 0x20000),
  s_mov_b64(s[20:21], s[30:31]),
  s_mov_b32(s[22], 0x80000000),
  s_mov_b32(s[23], 0x20000),
  s_mul_i32(s[86], 0x100, s[3]),
  s_mul_hi_u32(s[85], s[86], s[38]),
  s_mul_i32(s[84], s[86], s[38]),
  s_lshl_b64(s[84:85], s[84:85], s[8]),
  s_add_u32(s[20], s[30], s[84]),
  s_addc_u32(s[21], s[31], s[85]),
  s_mul_hi_u32(s[85], s[86], s[36]),
  s_mul_i32(s[84], s[86], s[36]),
  s_lshl_b64(s[84:85], s[84:85], s[9]),
  s_add_u32(s[16], s[28], s[84]),
  s_addc_u32(s[17], s[29], s[85]),
  s_mul_hi_u32(s[85], s[4], s[39]),
  s_mul_i32(s[84], s[4], s[39]),
  s_lshl_b64(s[84:85], s[84:85], s[8]),
  s_add_u32(s[20], s[20], s[84]),
  s_addc_u32(s[21], s[21], s[85]),
  s_mul_hi_u32(s[85], s[4], s[37]),
  s_mul_i32(s[84], s[4], s[37]),
  s_lshl_b64(s[84:85], s[84:85], s[9]),
  s_add_u32(s[16], s[16], s[84]),
  s_addc_u32(s[17], s[17], s[85]),
  s_mul_hi_u32(s[85], s[24], s[6]),
  s_mul_i32(s[84], s[24], s[6]),
  s_sub_u32(s[86], s[25], 1),
  s_mul_i32(s[86], s[86], s[6]),
  s_mul_hi_u32(s[87], s[86], s[38]),
  s_mul_i32(s[86], s[86], s[38]),
  s_add_u32(s[84], s[84], s[86]),
  s_addc_u32(s[85], s[85], s[87]),
  s_sub_u32(s[86], s[26], 1),
  s_mul_i32(s[86], s[86], s[6]),
  s_mul_hi_u32(s[87], s[86], s[39]),
  s_mul_i32(s[86], s[86], s[39]),
  s_add_u32(s[84], s[84], s[86]),
  s_addc_u32(s[85], s[85], s[87]),
  s_lshl_b64(s[84:85], s[84:85], 2),
  s_add_u32(s[16], s[16], s[84]),
  s_addc_u32(s[17], s[17], s[85]),
  s_xor_b32(s[46], s[48], s[46]),
  s_xor_b32(s[47], s[49], s[47]),
  s_cmp_eq_u32(s[12], 1),
  s_cbranch_scc1("after_prefetch"),
  s_mov_b32(M0, s[46]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[70], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[71], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[72], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[73], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[74], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[75], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[76], offen=1, lds=1),
  s_mov_b32(M0, s[47]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=0, offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[77], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[78], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[79], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[80], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[81], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[82], offen=1, lds=1),
  s_add_u32(M0, M0, 0x1040),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[83], offen=1, lds=1),
  s_xor_b32(s[46], s[48], s[46]),
  s_xor_b32(s[47], s[49], s[47]),
  "after_prefetch:",
  s_waitcnt(simm16=25591),
  s_barrier(),
  ds_read_b128(addr=v[4:7], data0=v[2], offset0=0, offset1=0),
  ds_read_b128(addr=v[8:11], data0=v[2], offset0=128, offset1=0),
  ds_read_b128(addr=v[12:15], data0=v[2], offset0=0, offset1=1),
  ds_read_b128(addr=v[16:19], data0=v[2], offset0=128, offset1=1),
  ds_read_b128(addr=v[20:23], data0=v[2], offset0=0, offset1=2),
  ds_read_b128(addr=v[24:27], data0=v[2], offset0=128, offset1=2),
  ds_read_b128(addr=v[28:31], data0=v[2], offset0=0, offset1=3),
  ds_read_b128(addr=v[32:35], data0=v[2], offset0=128, offset1=3),
  s_waitcnt(simm16=17399),
  s_barrier(),
  ds_read_b128(addr=v[68:71], data0=v[3], offset0=0, offset1=0),
  ds_read_b128(addr=v[72:75], data0=v[3], offset0=128, offset1=0),
  ds_read_b128(addr=v[76:79], data0=v[3], offset0=0, offset1=1),
  ds_read_b128(addr=v[80:83], data0=v[3], offset0=128, offset1=1),
  ds_read_b128(addr=v[84:87], data0=v[3], offset0=0, offset1=2),
  ds_read_b128(addr=v[88:91], data0=v[3], offset0=128, offset1=2),
  ds_read_b128(addr=v[92:95], data0=v[3], offset0=0, offset1=3),
  ds_read_b128(addr=v[96:99], data0=v[3], offset0=128, offset1=3),
  s_waitcnt(simm16=0xc07f),
  s_cmp_eq_u32(s[12], 1),
  s_cbranch_scc1("final_compute"),
  s_cmp_le_u32(s[12], 2),
  s_cbranch_scc1("loop_epilogue"),
  "main_loop:",
  v_mfma_f32_16x16x32_bf16(a[0:3], v[68:71], v[4:7], a[0:3]),
  ds_read_b128(addr=v[36:39], data0=v[2], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[68:71], v[8:11], a[4:7]),
  s_cmp_eq_u32(s[12], s[51]),
  s_cselect_b32(s[84], s[64], s[68]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[68:71], v[12:15], a[8:11]),
  ds_read_b128(addr=v[40:43], data0=v[2], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[68:71], v[16:19], a[12:15]),
  s_cselect_b32(s[85], s[65], 0),
  s_add_u32(s[52], s[52], s[84]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[68:71], v[20:23], a[16:19]),
  ds_read_b128(addr=v[44:47], data0=v[2], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[68:71], v[24:27], a[20:23]),
  s_addc_u32(s[53], s[53], s[85]),
  s_sub_u32(s[60], s[60], s[84]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[68:71], v[28:31], a[24:27]),
  ds_read_b128(addr=v[48:51], data0=v[2], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[68:71], v[32:35], a[28:31]),
  s_subb_u32(s[61], s[61], s[85]),
  s_cmp_eq_u32(s[61], 0),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[72:75], v[4:7], a[32:35]),
  ds_read_b128(addr=v[52:55], data0=v[2], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[72:75], v[8:11], a[36:39]),
  s_cselect_b32(s[54], s[60], -1),
  s_cmp_eq_u32(s[12], s[51]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[72:75], v[12:15], a[40:43]),
  ds_read_b128(addr=v[56:59], data0=v[2], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[72:75], v[16:19], a[44:47]),
  s_cselect_b32(s[84], s[66], s[69]),
  s_cselect_b32(s[85], s[67], 0),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[72:75], v[20:23], a[48:51]),
  ds_read_b128(addr=v[60:63], data0=v[2], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[72:75], v[24:27], a[52:55]),
  s_add_u32(s[56], s[56], s[84]),
  s_addc_u32(s[57], s[57], s[85]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[72:75], v[28:31], a[56:59]),
  ds_read_b128(addr=v[64:67], data0=v[2], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[72:75], v[32:35], a[60:63]),
  s_mov_b32(M0, s[46]),
  s_sub_u32(s[62], s[62], s[84]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[76:79], v[4:7], a[64:67]),
  s_subb_u32(s[63], s[63], s[85]),
  s_cmp_eq_u32(s[63], 0),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[76:79], v[8:11], a[68:71]),
  s_cselect_b32(s[58], s[62], -1),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[76:79], v[12:15], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[76:79], v[16:19], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[76:79], v[20:23], a[80:83]),
  s_waitcnt(simm16=0xc07f),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[76:79], v[24:27], a[84:87]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[76:79], v[28:31], a[88:91]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=0, offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[76:79], v[32:35], a[92:95]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[80:83], v[4:7], a[96:99]),
  ds_read_b128(addr=v[100:103], data0=v[3], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[80:83], v[8:11], a[100:103]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[70], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[80:83], v[12:15], a[104:107]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[80:83], v[16:19], a[108:111]),
  ds_read_b128(addr=v[104:107], data0=v[3], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[80:83], v[20:23], a[112:115]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[71], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[80:83], v[24:27], a[116:119]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[80:83], v[28:31], a[120:123]),
  ds_read_b128(addr=v[108:111], data0=v[3], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[80:83], v[32:35], a[124:127]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[72], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[84:87], v[4:7], a[128:131]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[84:87], v[8:11], a[132:135]),
  ds_read_b128(addr=v[112:115], data0=v[3], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[84:87], v[12:15], a[136:139]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[73], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[84:87], v[16:19], a[140:143]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[84:87], v[20:23], a[144:147]),
  ds_read_b128(addr=v[116:119], data0=v[3], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[84:87], v[24:27], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[84:87], v[28:31], a[152:155]),
  ds_read_b128(addr=v[120:123], data0=v[3], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[84:87], v[32:35], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[88:91], v[4:7], a[160:163]),
  ds_read_b128(addr=v[124:127], data0=v[3], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[88:91], v[8:11], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[88:91], v[12:15], a[168:171]),
  ds_read_b128(addr=v[128:131], data0=v[3], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[88:91], v[16:19], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[88:91], v[20:23], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[88:91], v[24:27], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[88:91], v[28:31], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[88:91], v[32:35], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[92:95], v[4:7], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[92:95], v[8:11], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[92:95], v[12:15], a[200:203]),
  s_waitcnt(simm16=0xc07f),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[92:95], v[16:19], a[204:207]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[92:95], v[20:23], a[208:211]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[74], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[92:95], v[24:27], a[212:215]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[92:95], v[28:31], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[92:95], v[32:35], a[220:223]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[75], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[96:99], v[4:7], a[224:227]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[96:99], v[8:11], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[96:99], v[12:15], a[232:235]),
  buffer_load_dwordx4(vdata=v[0], vaddr=v[0], srsrc=s[52:55], soffset=s[76], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[96:99], v[16:19], a[236:239]),
  s_mov_b32(M0, s[47]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[96:99], v[20:23], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[96:99], v[24:27], a[244:247]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=0, offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[96:99], v[28:31], a[248:251]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[96:99], v[32:35], a[252:255]),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[100:103], v[36:39], a[0:3]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[77], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[100:103], v[40:43], a[4:7]),
  s_add_u32(M0, M0, 0x1040),
  s_xor_b32(s[46], s[48], s[46]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[100:103], v[44:47], a[8:11]),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[100:103], v[48:51], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[100:103], v[52:55], a[16:19]),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[100:103], v[56:59], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[100:103], v[60:63], a[24:27]),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[100:103], v[64:67], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[104:107], v[36:39], a[32:35]),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[104:107], v[40:43], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[104:107], v[44:47], a[40:43]),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[104:107], v[48:51], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[104:107], v[52:55], a[48:51]),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[104:107], v[56:59], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[104:107], v[60:63], a[56:59]),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[104:107], v[64:67], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[108:111], v[36:39], a[64:67]),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[108:111], v[40:43], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[108:111], v[44:47], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[108:111], v[48:51], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[108:111], v[52:55], a[80:83]),
  v_xor_b32_e32(v[2], v[132], v[2]),
  v_xor_b32_e32(v[3], v[133], v[3]),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[108:111], v[56:59], a[84:87]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[78], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[108:111], v[60:63], a[88:91]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[108:111], v[64:67], a[92:95]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[79], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[112:115], v[36:39], a[96:99]),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[112:115], v[40:43], a[100:103]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[80], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[112:115], v[44:47], a[104:107]),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[112:115], v[48:51], a[108:111]),
  s_waitcnt(simm16=14327),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[112:115], v[52:55], a[112:115]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[112:115], v[56:59], a[116:119]),
  ds_read_b128(addr=v[4:7], data0=v[2], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[112:115], v[60:63], a[120:123]),
  ds_read_b128(addr=v[8:11], data0=v[2], offset0=128, offset1=0),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[112:115], v[64:67], a[124:127]),
  ds_read_b128(addr=v[12:15], data0=v[2], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[116:119], v[36:39], a[128:131]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[81], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[116:119], v[40:43], a[132:135]),
  ds_read_b128(addr=v[16:19], data0=v[2], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[116:119], v[44:47], a[136:139]),
  ds_read_b128(addr=v[20:23], data0=v[2], offset0=0, offset1=2),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[116:119], v[48:51], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[116:119], v[52:55], a[144:147]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[82], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[116:119], v[56:59], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[116:119], v[60:63], a[152:155]),
  ds_read_b128(addr=v[24:27], data0=v[2], offset0=128, offset1=2),
  s_add_u32(M0, M0, 0x1040),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[116:119], v[64:67], a[156:159]),
  ds_read_b128(addr=v[28:31], data0=v[2], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[120:123], v[36:39], a[160:163]),
  ds_read_b128(addr=v[32:35], data0=v[2], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[120:123], v[40:43], a[164:167]),
  ds_read_b128(addr=v[68:71], data0=v[3], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[120:123], v[44:47], a[168:171]),
  ds_read_b128(addr=v[72:75], data0=v[3], offset0=128, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[120:123], v[48:51], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[120:123], v[52:55], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[120:123], v[56:59], a[180:183]),
  ds_read_b128(addr=v[76:79], data0=v[3], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[120:123], v[60:63], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[120:123], v[64:67], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[124:127], v[36:39], a[192:195]),
  ds_read_b128(addr=v[80:83], data0=v[3], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[124:127], v[40:43], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[124:127], v[44:47], a[200:203]),
  ds_read_b128(addr=v[84:87], data0=v[3], offset0=0, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[124:127], v[48:51], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[124:127], v[52:55], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[124:127], v[56:59], a[212:215]),
  ds_read_b128(addr=v[88:91], data0=v[3], offset0=128, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[124:127], v[60:63], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[124:127], v[64:67], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[128:131], v[36:39], a[224:227]),
  ds_read_b128(addr=v[92:95], data0=v[3], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[128:131], v[40:43], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[128:131], v[44:47], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[128:131], v[48:51], a[236:239]),
  ds_read_b128(addr=v[96:99], data0=v[3], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[128:131], v[52:55], a[240:243]),
  buffer_load_dwordx4(vdata=v[1], vaddr=v[1], srsrc=s[56:59], soffset=s[83], offen=1, lds=1),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[128:131], v[56:59], a[244:247]),
  s_xor_b32(s[47], s[49], s[47]),
  s_sub_u32(s[12], s[12], 1),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[128:131], v[60:63], a[248:251]),
  s_cmp_eq_i32(s[12], 2),
  s_waitcnt(simm16=0xc07f),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[128:131], v[64:67], a[252:255]),
  s_cbranch_scc0("main_loop"),
  "loop_epilogue:",
  v_mfma_f32_16x16x32_bf16(a[0:3], v[68:71], v[4:7], a[0:3]),
  ds_read_b128(addr=v[36:39], data0=v[2], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[68:71], v[8:11], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[68:71], v[12:15], a[8:11]),
  ds_read_b128(addr=v[100:103], data0=v[3], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[68:71], v[16:19], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[68:71], v[20:23], a[16:19]),
  ds_read_b128(addr=v[40:43], data0=v[2], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[68:71], v[24:27], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[68:71], v[28:31], a[24:27]),
  ds_read_b128(addr=v[44:47], data0=v[2], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[68:71], v[32:35], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[72:75], v[4:7], a[32:35]),
  ds_read_b128(addr=v[48:51], data0=v[2], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[72:75], v[8:11], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[72:75], v[12:15], a[40:43]),
  ds_read_b128(addr=v[52:55], data0=v[2], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[72:75], v[16:19], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[72:75], v[20:23], a[48:51]),
  ds_read_b128(addr=v[56:59], data0=v[2], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[72:75], v[24:27], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[72:75], v[28:31], a[56:59]),
  ds_read_b128(addr=v[60:63], data0=v[2], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[72:75], v[32:35], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[76:79], v[4:7], a[64:67]),
  ds_read_b128(addr=v[64:67], data0=v[2], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[76:79], v[8:11], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[76:79], v[12:15], a[72:75]),
  ds_read_b128(addr=v[104:107], data0=v[3], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[76:79], v[16:19], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[76:79], v[20:23], a[80:83]),
  ds_read_b128(addr=v[108:111], data0=v[3], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[76:79], v[24:27], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[76:79], v[28:31], a[88:91]),
  ds_read_b128(addr=v[112:115], data0=v[3], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[76:79], v[32:35], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[80:83], v[4:7], a[96:99]),
  ds_read_b128(addr=v[116:119], data0=v[3], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[80:83], v[8:11], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[80:83], v[12:15], a[104:107]),
  ds_read_b128(addr=v[120:123], data0=v[3], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[80:83], v[16:19], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[80:83], v[20:23], a[112:115]),
  ds_read_b128(addr=v[124:127], data0=v[3], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[80:83], v[24:27], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[80:83], v[28:31], a[120:123]),
  ds_read_b128(addr=v[128:131], data0=v[3], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[80:83], v[32:35], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[84:87], v[4:7], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[84:87], v[8:11], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[84:87], v[12:15], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[84:87], v[16:19], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[84:87], v[20:23], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[84:87], v[24:27], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[84:87], v[28:31], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[84:87], v[32:35], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[88:91], v[4:7], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[88:91], v[8:11], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[88:91], v[12:15], a[168:171]),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[88:91], v[16:19], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[88:91], v[20:23], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[88:91], v[24:27], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[88:91], v[28:31], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[88:91], v[32:35], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[92:95], v[4:7], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[92:95], v[8:11], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[92:95], v[12:15], a[200:203]),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[92:95], v[16:19], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[92:95], v[20:23], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[92:95], v[24:27], a[212:215]),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[92:95], v[28:31], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[92:95], v[32:35], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[96:99], v[4:7], a[224:227]),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[96:99], v[8:11], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[96:99], v[12:15], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[96:99], v[16:19], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[96:99], v[20:23], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[96:99], v[24:27], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[96:99], v[28:31], a[248:251]),
  v_xor_b32_e32(v[2], v[132], v[2]),
  v_xor_b32_e32(v[3], v[133], v[3]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[96:99], v[32:35], a[252:255]),
  s_waitcnt(simm16=0xc07f),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[100:103], v[36:39], a[0:3]),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[100:103], v[40:43], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[100:103], v[44:47], a[8:11]),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[100:103], v[48:51], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[100:103], v[52:55], a[16:19]),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[100:103], v[56:59], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[100:103], v[60:63], a[24:27]),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[100:103], v[64:67], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[104:107], v[36:39], a[32:35]),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[104:107], v[40:43], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[104:107], v[44:47], a[40:43]),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[104:107], v[48:51], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[104:107], v[52:55], a[48:51]),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[104:107], v[56:59], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[104:107], v[60:63], a[56:59]),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[104:107], v[64:67], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[108:111], v[36:39], a[64:67]),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[108:111], v[40:43], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[108:111], v[44:47], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[108:111], v[48:51], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[108:111], v[52:55], a[80:83]),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[108:111], v[56:59], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[108:111], v[60:63], a[88:91]),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[108:111], v[64:67], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[112:115], v[36:39], a[96:99]),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[112:115], v[40:43], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[112:115], v[44:47], a[104:107]),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[112:115], v[48:51], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[112:115], v[52:55], a[112:115]),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[112:115], v[56:59], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[112:115], v[60:63], a[120:123]),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[112:115], v[64:67], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[116:119], v[36:39], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[116:119], v[40:43], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[116:119], v[44:47], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[116:119], v[48:51], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[116:119], v[52:55], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[116:119], v[56:59], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[116:119], v[60:63], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[116:119], v[64:67], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[120:123], v[36:39], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[120:123], v[40:43], a[164:167]),
  s_waitcnt(simm16=1015),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[120:123], v[44:47], a[168:171]),
  s_barrier(),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[120:123], v[48:51], a[172:175]),
  ds_read_b128(addr=v[4:7], data0=v[2], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[120:123], v[52:55], a[176:179]),
  ds_read_b128(addr=v[68:71], data0=v[3], offset0=0, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[120:123], v[56:59], a[180:183]),
  ds_read_b128(addr=v[8:11], data0=v[2], offset0=128, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[120:123], v[60:63], a[184:187]),
  ds_read_b128(addr=v[12:15], data0=v[2], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[120:123], v[64:67], a[188:191]),
  ds_read_b128(addr=v[16:19], data0=v[2], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[124:127], v[36:39], a[192:195]),
  ds_read_b128(addr=v[20:23], data0=v[2], offset0=0, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[124:127], v[40:43], a[196:199]),
  ds_read_b128(addr=v[24:27], data0=v[2], offset0=128, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[124:127], v[44:47], a[200:203]),
  ds_read_b128(addr=v[28:31], data0=v[2], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[124:127], v[48:51], a[204:207]),
  ds_read_b128(addr=v[32:35], data0=v[2], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[124:127], v[52:55], a[208:211]),
  ds_read_b128(addr=v[72:75], data0=v[3], offset0=128, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[124:127], v[56:59], a[212:215]),
  ds_read_b128(addr=v[76:79], data0=v[3], offset0=0, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[124:127], v[60:63], a[216:219]),
  ds_read_b128(addr=v[80:83], data0=v[3], offset0=128, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[124:127], v[64:67], a[220:223]),
  ds_read_b128(addr=v[84:87], data0=v[3], offset0=0, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[128:131], v[36:39], a[224:227]),
  ds_read_b128(addr=v[88:91], data0=v[3], offset0=128, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[128:131], v[40:43], a[228:231]),
  ds_read_b128(addr=v[92:95], data0=v[3], offset0=0, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[128:131], v[44:47], a[232:235]),
  ds_read_b128(addr=v[96:99], data0=v[3], offset0=128, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[128:131], v[48:51], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[128:131], v[52:55], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[128:131], v[56:59], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[128:131], v[60:63], a[248:251]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[128:131], v[64:67], a[252:255]),
  "final_compute:",
  s_and_b32(s[8], s[50], 0x3fff),
  s_and_b32(s[84], 0xff, s[24]),
  s_add_u32(s[85], -1, s[14]),
  s_cmp_ge_u32(s[2], s[85]),
  s_cselect_b32(s[84], s[84], 0),
  s_and_b32(s[84], 0xff, s[25]),
  s_add_u32(s[85], -1, s[15]),
  s_cmp_ge_u32(s[3], s[85]),
  s_cselect_b32(s[84], s[84], 0),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[68:71], v[4:7], a[0:3]),
  ds_read_b128(addr=v[36:39], data0=v[2], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[68:71], v[8:11], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[68:71], v[12:15], a[8:11]),
  ds_read_b128(addr=v[100:103], data0=v[3], offset0=64, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[68:71], v[16:19], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[68:71], v[20:23], a[16:19]),
  ds_read_b128(addr=v[40:43], data0=v[2], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[68:71], v[24:27], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[68:71], v[28:31], a[24:27]),
  ds_read_b128(addr=v[44:47], data0=v[2], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[68:71], v[32:35], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[72:75], v[4:7], a[32:35]),
  ds_read_b128(addr=v[48:51], data0=v[2], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[72:75], v[8:11], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[72:75], v[12:15], a[40:43]),
  ds_read_b128(addr=v[52:55], data0=v[2], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[72:75], v[16:19], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[72:75], v[20:23], a[48:51]),
  ds_read_b128(addr=v[56:59], data0=v[2], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[72:75], v[24:27], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[72:75], v[28:31], a[56:59]),
  ds_read_b128(addr=v[60:63], data0=v[2], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[72:75], v[32:35], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[76:79], v[4:7], a[64:67]),
  ds_read_b128(addr=v[64:67], data0=v[2], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[76:79], v[8:11], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[76:79], v[12:15], a[72:75]),
  ds_read_b128(addr=v[104:107], data0=v[3], offset0=192, offset1=0),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[76:79], v[16:19], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[76:79], v[20:23], a[80:83]),
  ds_read_b128(addr=v[108:111], data0=v[3], offset0=64, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[76:79], v[24:27], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[76:79], v[28:31], a[88:91]),
  ds_read_b128(addr=v[112:115], data0=v[3], offset0=192, offset1=1),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[76:79], v[32:35], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[80:83], v[4:7], a[96:99]),
  ds_read_b128(addr=v[116:119], data0=v[3], offset0=64, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[80:83], v[8:11], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[80:83], v[12:15], a[104:107]),
  ds_read_b128(addr=v[120:123], data0=v[3], offset0=192, offset1=2),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[80:83], v[16:19], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[80:83], v[20:23], a[112:115]),
  ds_read_b128(addr=v[124:127], data0=v[3], offset0=64, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[80:83], v[24:27], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[80:83], v[28:31], a[120:123]),
  ds_read_b128(addr=v[128:131], data0=v[3], offset0=192, offset1=3),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[80:83], v[32:35], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[84:87], v[4:7], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[84:87], v[8:11], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[84:87], v[12:15], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[84:87], v[16:19], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[84:87], v[20:23], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[84:87], v[24:27], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[84:87], v[28:31], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[84:87], v[32:35], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[88:91], v[4:7], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[88:91], v[8:11], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[88:91], v[12:15], a[168:171]),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[88:91], v[16:19], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[88:91], v[20:23], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[88:91], v[24:27], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[88:91], v[28:31], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[88:91], v[32:35], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[92:95], v[4:7], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[92:95], v[8:11], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[92:95], v[12:15], a[200:203]),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[92:95], v[16:19], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[92:95], v[20:23], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[92:95], v[24:27], a[212:215]),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[92:95], v[28:31], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[92:95], v[32:35], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[96:99], v[4:7], a[224:227]),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[96:99], v[8:11], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[96:99], v[12:15], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[96:99], v[16:19], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[96:99], v[20:23], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[96:99], v[24:27], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[96:99], v[28:31], a[248:251]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[96:99], v[32:35], a[252:255]),
  s_waitcnt(simm16=0xc07f),
  v_mfma_f32_16x16x32_bf16(a[0:3], v[100:103], v[36:39], a[0:3]),
  v_mfma_f32_16x16x32_bf16(a[4:7], v[100:103], v[40:43], a[4:7]),
  v_mfma_f32_16x16x32_bf16(a[8:11], v[100:103], v[44:47], a[8:11]),
  v_mfma_f32_16x16x32_bf16(a[12:15], v[100:103], v[48:51], a[12:15]),
  v_mfma_f32_16x16x32_bf16(a[16:19], v[100:103], v[52:55], a[16:19]),
  v_mfma_f32_16x16x32_bf16(a[20:23], v[100:103], v[56:59], a[20:23]),
  v_mfma_f32_16x16x32_bf16(a[24:27], v[100:103], v[60:63], a[24:27]),
  v_mfma_f32_16x16x32_bf16(a[28:31], v[100:103], v[64:67], a[28:31]),
  v_mfma_f32_16x16x32_bf16(a[32:35], v[104:107], v[36:39], a[32:35]),
  v_mfma_f32_16x16x32_bf16(a[36:39], v[104:107], v[40:43], a[36:39]),
  v_mfma_f32_16x16x32_bf16(a[40:43], v[104:107], v[44:47], a[40:43]),
  v_mfma_f32_16x16x32_bf16(a[44:47], v[104:107], v[48:51], a[44:47]),
  v_mfma_f32_16x16x32_bf16(a[48:51], v[104:107], v[52:55], a[48:51]),
  v_mfma_f32_16x16x32_bf16(a[52:55], v[104:107], v[56:59], a[52:55]),
  v_mfma_f32_16x16x32_bf16(a[56:59], v[104:107], v[60:63], a[56:59]),
  v_mfma_f32_16x16x32_bf16(a[60:63], v[104:107], v[64:67], a[60:63]),
  v_mfma_f32_16x16x32_bf16(a[64:67], v[108:111], v[36:39], a[64:67]),
  v_mfma_f32_16x16x32_bf16(a[68:71], v[108:111], v[40:43], a[68:71]),
  v_mfma_f32_16x16x32_bf16(a[72:75], v[108:111], v[44:47], a[72:75]),
  v_mfma_f32_16x16x32_bf16(a[76:79], v[108:111], v[48:51], a[76:79]),
  v_mfma_f32_16x16x32_bf16(a[80:83], v[108:111], v[52:55], a[80:83]),
  v_mfma_f32_16x16x32_bf16(a[84:87], v[108:111], v[56:59], a[84:87]),
  v_mfma_f32_16x16x32_bf16(a[88:91], v[108:111], v[60:63], a[88:91]),
  v_mfma_f32_16x16x32_bf16(a[92:95], v[108:111], v[64:67], a[92:95]),
  v_mfma_f32_16x16x32_bf16(a[96:99], v[112:115], v[36:39], a[96:99]),
  v_mfma_f32_16x16x32_bf16(a[100:103], v[112:115], v[40:43], a[100:103]),
  v_mfma_f32_16x16x32_bf16(a[104:107], v[112:115], v[44:47], a[104:107]),
  v_mfma_f32_16x16x32_bf16(a[108:111], v[112:115], v[48:51], a[108:111]),
  v_mfma_f32_16x16x32_bf16(a[112:115], v[112:115], v[52:55], a[112:115]),
  v_mfma_f32_16x16x32_bf16(a[116:119], v[112:115], v[56:59], a[116:119]),
  v_mfma_f32_16x16x32_bf16(a[120:123], v[112:115], v[60:63], a[120:123]),
  v_mfma_f32_16x16x32_bf16(a[124:127], v[112:115], v[64:67], a[124:127]),
  v_mfma_f32_16x16x32_bf16(a[128:131], v[116:119], v[36:39], a[128:131]),
  v_mfma_f32_16x16x32_bf16(a[132:135], v[116:119], v[40:43], a[132:135]),
  v_mfma_f32_16x16x32_bf16(a[136:139], v[116:119], v[44:47], a[136:139]),
  v_mfma_f32_16x16x32_bf16(a[140:143], v[116:119], v[48:51], a[140:143]),
  v_mfma_f32_16x16x32_bf16(a[144:147], v[116:119], v[52:55], a[144:147]),
  v_mfma_f32_16x16x32_bf16(a[148:151], v[116:119], v[56:59], a[148:151]),
  v_mfma_f32_16x16x32_bf16(a[152:155], v[116:119], v[60:63], a[152:155]),
  v_mfma_f32_16x16x32_bf16(a[156:159], v[116:119], v[64:67], a[156:159]),
  v_mfma_f32_16x16x32_bf16(a[160:163], v[120:123], v[36:39], a[160:163]),
  v_mfma_f32_16x16x32_bf16(a[164:167], v[120:123], v[40:43], a[164:167]),
  v_mfma_f32_16x16x32_bf16(a[168:171], v[120:123], v[44:47], a[168:171]),
  v_mfma_f32_16x16x32_bf16(a[172:175], v[120:123], v[48:51], a[172:175]),
  v_mfma_f32_16x16x32_bf16(a[176:179], v[120:123], v[52:55], a[176:179]),
  v_mfma_f32_16x16x32_bf16(a[180:183], v[120:123], v[56:59], a[180:183]),
  v_mfma_f32_16x16x32_bf16(a[184:187], v[120:123], v[60:63], a[184:187]),
  v_mfma_f32_16x16x32_bf16(a[188:191], v[120:123], v[64:67], a[188:191]),
  v_mfma_f32_16x16x32_bf16(a[192:195], v[124:127], v[36:39], a[192:195]),
  v_mfma_f32_16x16x32_bf16(a[196:199], v[124:127], v[40:43], a[196:199]),
  v_mfma_f32_16x16x32_bf16(a[200:203], v[124:127], v[44:47], a[200:203]),
  v_mfma_f32_16x16x32_bf16(a[204:207], v[124:127], v[48:51], a[204:207]),
  v_mfma_f32_16x16x32_bf16(a[208:211], v[124:127], v[52:55], a[208:211]),
  v_mfma_f32_16x16x32_bf16(a[212:215], v[124:127], v[56:59], a[212:215]),
  v_mfma_f32_16x16x32_bf16(a[216:219], v[124:127], v[60:63], a[216:219]),
  v_mfma_f32_16x16x32_bf16(a[220:223], v[124:127], v[64:67], a[220:223]),
  v_mfma_f32_16x16x32_bf16(a[224:227], v[128:131], v[36:39], a[224:227]),
  v_mfma_f32_16x16x32_bf16(a[228:231], v[128:131], v[40:43], a[228:231]),
  v_mfma_f32_16x16x32_bf16(a[232:235], v[128:131], v[44:47], a[232:235]),
  v_mfma_f32_16x16x32_bf16(a[236:239], v[128:131], v[48:51], a[236:239]),
  v_mfma_f32_16x16x32_bf16(a[240:243], v[128:131], v[52:55], a[240:243]),
  v_mfma_f32_16x16x32_bf16(a[244:247], v[128:131], v[56:59], a[244:247]),
  v_mfma_f32_16x16x32_bf16(a[248:251], v[128:131], v[60:63], a[248:251]),
  v_mfma_f32_16x16x32_bf16(a[252:255], v[128:131], v[64:67], a[252:255]),
  v_lshrrev_b32_e32(v[4], 6, v[134]),
  v_lshrrev_b32_e32(v[5], 1, v[4]),
  v_mul_lo_u32(v[5], 16, v[5]),
  v_and_b32_e32(v[1], 63, v[134]),
  v_lshrrev_b32_e32(v[1], 4, v[1]),
  v_lshlrev_b32_e32(v[1], 2, v[1]),
  v_add_lshl_u32(v[1], v[5], v[1], 3),
  v_mul_lo_u32(v[2], v[1], s[38]),
  v_mul_lo_u32(v[3], v[1], s[36]),
  v_and_b32_e32(v[0], 1, v[4]),
  v_mul_lo_u32(v[0], 16, v[0]),
  v_and_b32_e32(v[5], 15, v[134]),
  v_add_lshl_u32(v[0], v[5], v[0], 3),
  s_mul_i32(s[8], 0x100, s[2]),
  v_add_u32_e32(v[0], s[8], v[0]),
  s_mul_i32(s[8], 0x100, s[3]),
  v_add_u32_e32(v[1], s[8], v[1]),
  v_add_lshl_u32(v[11], v[3], v[0], 1),
  # TODO: should be AGPR
  v_accvgpr_read(v[16], a[0]),
  v_accvgpr_read(v[17], a[4]),
  v_accvgpr_read(v[18], a[8]),
  v_accvgpr_read(v[19], a[12]),
  v_accvgpr_read(v[20], a[16]),
  v_accvgpr_read(v[21], a[20]),
  v_accvgpr_read(v[22], a[24]),
  v_accvgpr_read(v[23], a[28]),
  v_accvgpr_read(v[24], a[32]),
  v_accvgpr_read(v[25], a[36]),
  v_accvgpr_read(v[26], a[40]),
  v_accvgpr_read(v[27], a[44]),
  v_accvgpr_read(v[28], a[48]),
  v_accvgpr_read(v[29], a[52]),
  v_accvgpr_read(v[30], a[56]),
  v_accvgpr_read(v[31], a[60]),
  v_accvgpr_read(v[32], a[64]),
  v_accvgpr_read(v[33], a[68]),
  v_accvgpr_read(v[34], a[72]),
  v_accvgpr_read(v[35], a[76]),
  v_accvgpr_read(v[36], a[80]),
  v_accvgpr_read(v[37], a[84]),
  v_accvgpr_read(v[38], a[88]),
  v_accvgpr_read(v[39], a[92]),
  v_accvgpr_read(v[40], a[96]),
  v_accvgpr_read(v[41], a[100]),
  v_accvgpr_read(v[42], a[104]),
  v_accvgpr_read(v[43], a[108]),
  v_accvgpr_read(v[44], a[112]),
  v_accvgpr_read(v[45], a[116]),
  v_accvgpr_read(v[46], a[120]),
  v_accvgpr_read(v[47], a[124]),
  v_accvgpr_read(v[48], a[128]),
  v_accvgpr_read(v[49], a[132]),
  v_accvgpr_read(v[50], a[136]),
  v_accvgpr_read(v[51], a[140]),
  v_accvgpr_read(v[52], a[144]),
  v_accvgpr_read(v[53], a[148]),
  v_accvgpr_read(v[54], a[152]),
  v_accvgpr_read(v[55], a[156]),
  v_accvgpr_read(v[56], a[160]),
  v_accvgpr_read(v[57], a[164]),
  v_accvgpr_read(v[58], a[168]),
  v_accvgpr_read(v[59], a[172]),
  v_accvgpr_read(v[60], a[176]),
  v_accvgpr_read(v[61], a[180]),
  v_accvgpr_read(v[62], a[184]),
  v_accvgpr_read(v[63], a[188]),
  v_accvgpr_read(v[64], a[192]),
  v_accvgpr_read(v[65], a[196]),
  v_accvgpr_read(v[66], a[200]),
  v_accvgpr_read(v[67], a[204]),
  v_accvgpr_read(v[68], a[208]),
  v_accvgpr_read(v[69], a[212]),
  v_accvgpr_read(v[70], a[216]),
  v_accvgpr_read(v[71], a[220]),
  v_accvgpr_read(v[72], a[224]),
  v_accvgpr_read(v[73], a[228]),
  v_accvgpr_read(v[74], a[232]),
  v_accvgpr_read(v[75], a[236]),
  v_accvgpr_read(v[76], a[240]),
  v_accvgpr_read(v[77], a[244]),
  v_accvgpr_read(v[78], a[248]),
  v_accvgpr_read(v[79], a[252]),
  v_accvgpr_read(v[80], a[1]),
  v_accvgpr_read(v[81], a[5]),
  v_accvgpr_read(v[82], a[9]),
  v_accvgpr_read(v[83], a[13]),
  v_accvgpr_read(v[84], a[17]),
  v_accvgpr_read(v[85], a[21]),
  v_accvgpr_read(v[86], a[25]),
  v_accvgpr_read(v[87], a[29]),
  v_accvgpr_read(v[88], a[33]),
  v_accvgpr_read(v[89], a[37]),
  v_accvgpr_read(v[90], a[41]),
  v_accvgpr_read(v[91], a[45]),
  v_accvgpr_read(v[92], a[49]),
  v_accvgpr_read(v[93], a[53]),
  v_accvgpr_read(v[94], a[57]),
  v_accvgpr_read(v[95], a[61]),
  v_accvgpr_read(v[96], a[65]),
  v_accvgpr_read(v[97], a[69]),
  v_accvgpr_read(v[98], a[73]),
  v_accvgpr_read(v[99], a[77]),
  v_accvgpr_read(v[100], a[81]),
  v_accvgpr_read(v[101], a[85]),
  v_accvgpr_read(v[102], a[89]),
  v_accvgpr_read(v[103], a[93]),
  v_accvgpr_read(v[104], a[97]),
  v_accvgpr_read(v[105], a[101]),
  v_accvgpr_read(v[106], a[105]),
  v_accvgpr_read(v[107], a[109]),
  v_accvgpr_read(v[108], a[113]),
  v_accvgpr_read(v[109], a[117]),
  v_accvgpr_read(v[110], a[121]),
  v_accvgpr_read(v[111], a[125]),
  v_accvgpr_read(v[112], a[129]),
  v_accvgpr_read(v[113], a[133]),
  v_accvgpr_read(v[114], a[137]),
  v_accvgpr_read(v[115], a[141]),
  v_accvgpr_read(v[116], a[145]),
  v_accvgpr_read(v[117], a[149]),
  v_accvgpr_read(v[118], a[153]),
  v_accvgpr_read(v[119], a[157]),
  v_accvgpr_read(v[120], a[161]),
  v_accvgpr_read(v[121], a[165]),
  v_accvgpr_read(v[122], a[169]),
  v_accvgpr_read(v[123], a[173]),
  v_accvgpr_read(v[124], a[177]),
  v_accvgpr_read(v[125], a[181]),
  v_accvgpr_read(v[126], a[185]),
  v_accvgpr_read(v[127], a[189]),
  v_accvgpr_read(v[136], a[193]),
  v_accvgpr_read(v[137], a[197]),
  v_accvgpr_read(v[138], a[201]),
  v_accvgpr_read(v[139], a[205]),
  v_accvgpr_read(v[140], a[209]),
  v_accvgpr_read(v[141], a[213]),
  v_accvgpr_read(v[142], a[217]),
  v_accvgpr_read(v[143], a[221]),
  v_accvgpr_read(v[144], a[225]),
  v_accvgpr_read(v[145], a[229]),
  v_accvgpr_read(v[146], a[233]),
  v_accvgpr_read(v[147], a[237]),
  v_accvgpr_read(v[148], a[241]),
  v_accvgpr_read(v[149], a[245]),
  v_accvgpr_read(v[150], a[249]),
  v_accvgpr_read(v[151], a[253]),
  v_accvgpr_read(v[152], a[2]),
  v_accvgpr_read(v[153], a[6]),
  v_accvgpr_read(v[154], a[10]),
  v_accvgpr_read(v[155], a[14]),
  v_accvgpr_read(v[156], a[18]),
  v_accvgpr_read(v[157], a[22]),
  v_accvgpr_read(v[158], a[26]),
  v_accvgpr_read(v[159], a[30]),
  v_accvgpr_read(v[160], a[34]),
  v_accvgpr_read(v[161], a[38]),
  v_accvgpr_read(v[162], a[42]),
  v_accvgpr_read(v[163], a[46]),
  v_accvgpr_read(v[164], a[50]),
  v_accvgpr_read(v[165], a[54]),
  v_accvgpr_read(v[166], a[58]),
  v_accvgpr_read(v[167], a[62]),
  v_accvgpr_read(v[168], a[66]),
  v_accvgpr_read(v[169], a[70]),
  v_accvgpr_read(v[170], a[74]),
  v_accvgpr_read(v[171], a[78]),
  v_accvgpr_read(v[172], a[82]),
  v_accvgpr_read(v[173], a[86]),
  v_accvgpr_read(v[174], a[90]),
  v_accvgpr_read(v[175], a[94]),
  v_accvgpr_read(v[176], a[98]),
  v_accvgpr_read(v[177], a[102]),
  v_accvgpr_read(v[178], a[106]),
  v_accvgpr_read(v[179], a[110]),
  v_accvgpr_read(v[180], a[114]),
  v_accvgpr_read(v[181], a[118]),
  v_accvgpr_read(v[182], a[122]),
  v_accvgpr_read(v[183], a[126]),
  v_accvgpr_read(v[184], a[130]),
  v_accvgpr_read(v[185], a[134]),
  v_accvgpr_read(v[186], a[138]),
  v_accvgpr_read(v[187], a[142]),
  v_accvgpr_read(v[188], a[146]),
  v_accvgpr_read(v[189], a[150]),
  v_accvgpr_read(v[190], a[154]),
  v_accvgpr_read(v[191], a[158]),
  v_accvgpr_read(v[192], a[162]),
  v_accvgpr_read(v[193], a[166]),
  v_accvgpr_read(v[194], a[170]),
  v_accvgpr_read(v[195], a[174]),
  v_accvgpr_read(v[196], a[178]),
  v_accvgpr_read(v[197], a[182]),
  v_accvgpr_read(v[198], a[186]),
  v_accvgpr_read(v[199], a[190]),
  v_accvgpr_read(v[200], a[194]),
  v_accvgpr_read(v[201], a[198]),
  v_accvgpr_read(v[202], a[202]),
  v_accvgpr_read(v[203], a[206]),
  v_accvgpr_read(v[204], a[210]),
  v_accvgpr_read(v[205], a[214]),
  v_accvgpr_read(v[206], a[218]),
  v_accvgpr_read(v[207], a[222]),
  v_accvgpr_read(v[208], a[226]),
  v_accvgpr_read(v[209], a[230]),
  v_accvgpr_read(v[210], a[234]),
  v_accvgpr_read(v[211], a[238]),
  v_accvgpr_read(v[212], a[242]),
  v_accvgpr_read(v[213], a[246]),
  v_accvgpr_read(v[214], a[250]),
  v_accvgpr_read(v[215], a[254]),
  v_accvgpr_read(v[216], a[3]),
  v_accvgpr_read(v[217], a[7]),
  v_accvgpr_read(v[218], a[11]),
  v_accvgpr_read(v[219], a[15]),
  v_accvgpr_read(v[220], a[19]),
  v_accvgpr_read(v[221], a[23]),
  v_accvgpr_read(v[222], a[27]),
  v_accvgpr_read(v[223], a[31]),
  v_accvgpr_read(v[224], a[35]),
  v_accvgpr_read(v[225], a[39]),
  v_accvgpr_read(v[226], a[43]),
  v_accvgpr_read(v[227], a[47]),
  v_accvgpr_read(v[228], a[51]),
  v_accvgpr_read(v[229], a[55]),
  v_accvgpr_read(v[230], a[59]),
  v_accvgpr_read(v[231], a[63]),
  v_accvgpr_read(v[232], a[67]),
  v_accvgpr_read(v[233], a[71]),
  v_accvgpr_read(v[234], a[75]),
  v_accvgpr_read(v[235], a[79]),
  v_accvgpr_read(v[236], a[83]),
  v_accvgpr_read(v[237], a[87]),
  v_accvgpr_read(v[238], a[91]),
  v_accvgpr_read(v[239], a[95]),
  v_accvgpr_read(v[240], a[99]),
  v_accvgpr_read(v[241], a[103]),
  v_accvgpr_read(v[242], a[107]),
  v_accvgpr_read(v[243], a[111]),
  v_accvgpr_read(v[244], a[115]),
  v_accvgpr_read(v[245], a[119]),
  v_accvgpr_read(v[246], a[123]),
  v_accvgpr_read(v[247], a[127]),
  v_mov_b32_e32(v[8], 0xffff0000),
  v_mov_b32_e32(v[9], 0x7fff0000),
  v_mov_b32_e32(v[10], 0x7fff),
  v_cvt_pk_bf16_f32(v[16], v[16], v[17]),
  v_cvt_pk_bf16_f32(v[17], v[18], v[19]),
  v_cvt_pk_bf16_f32(v[18], v[20], v[21]),
  v_cvt_pk_bf16_f32(v[19], v[22], v[23]),
  buffer_store_dwordx4(v[16:19], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[24], v[24], v[25]),
  v_cvt_pk_bf16_f32(v[25], v[26], v[27]),
  v_cvt_pk_bf16_f32(v[26], v[28], v[29]),
  v_cvt_pk_bf16_f32(v[27], v[30], v[31]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[24:27], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[32], v[32], v[33]),
  v_cvt_pk_bf16_f32(v[33], v[34], v[35]),
  v_cvt_pk_bf16_f32(v[34], v[36], v[37]),
  v_cvt_pk_bf16_f32(v[35], v[38], v[39]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[32:35], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[40], v[40], v[41]),
  v_cvt_pk_bf16_f32(v[41], v[42], v[43]),
  v_cvt_pk_bf16_f32(v[42], v[44], v[45]),
  v_cvt_pk_bf16_f32(v[43], v[46], v[47]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[40:43], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[48], v[48], v[49]),
  v_cvt_pk_bf16_f32(v[49], v[50], v[51]),
  v_cvt_pk_bf16_f32(v[50], v[52], v[53]),
  v_cvt_pk_bf16_f32(v[51], v[54], v[55]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[48:51], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[56], v[56], v[57]),
  v_cvt_pk_bf16_f32(v[57], v[58], v[59]),
  v_cvt_pk_bf16_f32(v[58], v[60], v[61]),
  v_cvt_pk_bf16_f32(v[59], v[62], v[63]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[56:59], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[64], v[64], v[65]),
  v_cvt_pk_bf16_f32(v[65], v[66], v[67]),
  v_cvt_pk_bf16_f32(v[66], v[68], v[69]),
  v_cvt_pk_bf16_f32(v[67], v[70], v[71]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[64:67], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[72], v[72], v[73]),
  v_cvt_pk_bf16_f32(v[73], v[74], v[75]),
  v_cvt_pk_bf16_f32(v[74], v[76], v[77]),
  v_cvt_pk_bf16_f32(v[75], v[78], v[79]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[72:75], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[80], v[80], v[81]),
  v_cvt_pk_bf16_f32(v[81], v[82], v[83]),
  v_cvt_pk_bf16_f32(v[82], v[84], v[85]),
  v_cvt_pk_bf16_f32(v[83], v[86], v[87]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[80:83], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[88], v[88], v[89]),
  v_cvt_pk_bf16_f32(v[89], v[90], v[91]),
  v_cvt_pk_bf16_f32(v[90], v[92], v[93]),
  v_cvt_pk_bf16_f32(v[91], v[94], v[95]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[88:91], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[96], v[96], v[97]),
  v_cvt_pk_bf16_f32(v[97], v[98], v[99]),
  v_cvt_pk_bf16_f32(v[98], v[100], v[101]),
  v_cvt_pk_bf16_f32(v[99], v[102], v[103]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[96:99], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[104], v[104], v[105]),
  v_cvt_pk_bf16_f32(v[105], v[106], v[107]),
  v_cvt_pk_bf16_f32(v[106], v[108], v[109]),
  v_cvt_pk_bf16_f32(v[107], v[110], v[111]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[104:107], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[112], v[112], v[113]),
  v_cvt_pk_bf16_f32(v[113], v[114], v[115]),
  v_cvt_pk_bf16_f32(v[114], v[116], v[117]),
  v_cvt_pk_bf16_f32(v[115], v[118], v[119]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[112:115], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[120], v[120], v[121]),
  v_cvt_pk_bf16_f32(v[121], v[122], v[123]),
  v_cvt_pk_bf16_f32(v[122], v[124], v[125]),
  v_cvt_pk_bf16_f32(v[123], v[126], v[127]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[120:123], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[136], v[136], v[137]),
  v_cvt_pk_bf16_f32(v[137], v[138], v[139]),
  v_cvt_pk_bf16_f32(v[138], v[140], v[141]),
  v_cvt_pk_bf16_f32(v[139], v[142], v[143]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[136:139], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[144], v[144], v[145]),
  v_cvt_pk_bf16_f32(v[145], v[146], v[147]),
  v_cvt_pk_bf16_f32(v[146], v[148], v[149]),
  v_cvt_pk_bf16_f32(v[147], v[150], v[151]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[144:147], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[152], v[152], v[153]),
  v_cvt_pk_bf16_f32(v[153], v[154], v[155]),
  v_cvt_pk_bf16_f32(v[154], v[156], v[157]),
  v_cvt_pk_bf16_f32(v[155], v[158], v[159]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[152:155], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[160], v[160], v[161]),
  v_cvt_pk_bf16_f32(v[161], v[162], v[163]),
  v_cvt_pk_bf16_f32(v[162], v[164], v[165]),
  v_cvt_pk_bf16_f32(v[163], v[166], v[167]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[160:163], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[168], v[168], v[169]),
  v_cvt_pk_bf16_f32(v[169], v[170], v[171]),
  v_cvt_pk_bf16_f32(v[170], v[172], v[173]),
  v_cvt_pk_bf16_f32(v[171], v[174], v[175]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[168:171], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[176], v[176], v[177]),
  v_cvt_pk_bf16_f32(v[177], v[178], v[179]),
  v_cvt_pk_bf16_f32(v[178], v[180], v[181]),
  v_cvt_pk_bf16_f32(v[179], v[182], v[183]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[176:179], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[184], v[184], v[185]),
  v_cvt_pk_bf16_f32(v[185], v[186], v[187]),
  v_cvt_pk_bf16_f32(v[186], v[188], v[189]),
  v_cvt_pk_bf16_f32(v[187], v[190], v[191]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[184:187], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[192], v[192], v[193]),
  v_cvt_pk_bf16_f32(v[193], v[194], v[195]),
  v_cvt_pk_bf16_f32(v[194], v[196], v[197]),
  v_cvt_pk_bf16_f32(v[195], v[198], v[199]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[192:195], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[200], v[200], v[201]),
  v_cvt_pk_bf16_f32(v[201], v[202], v[203]),
  v_cvt_pk_bf16_f32(v[202], v[204], v[205]),
  v_cvt_pk_bf16_f32(v[203], v[206], v[207]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[200:203], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[208], v[208], v[209]),
  v_cvt_pk_bf16_f32(v[209], v[210], v[211]),
  v_cvt_pk_bf16_f32(v[210], v[212], v[213]),
  v_cvt_pk_bf16_f32(v[211], v[214], v[215]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[208:211], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[216], v[216], v[217]),
  v_cvt_pk_bf16_f32(v[217], v[218], v[219]),
  v_cvt_pk_bf16_f32(v[218], v[220], v[221]),
  v_cvt_pk_bf16_f32(v[219], v[222], v[223]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[216:219], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[224], v[224], v[225]),
  v_cvt_pk_bf16_f32(v[225], v[226], v[227]),
  v_cvt_pk_bf16_f32(v[226], v[228], v[229]),
  v_cvt_pk_bf16_f32(v[227], v[230], v[231]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[224:227], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[232], v[232], v[233]),
  v_cvt_pk_bf16_f32(v[233], v[234], v[235]),
  v_cvt_pk_bf16_f32(v[234], v[236], v[237]),
  v_cvt_pk_bf16_f32(v[235], v[238], v[239]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[232:235], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[240], v[240], v[241]),
  v_cvt_pk_bf16_f32(v[241], v[242], v[243]),
  v_cvt_pk_bf16_f32(v[242], v[244], v[245]),
  v_cvt_pk_bf16_f32(v[243], v[246], v[247]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[240:243], v[11], s[16:19], 0, offen=1, nt=1),
  s_nop(0),
  v_accvgpr_read(v[16], a[131]),
  v_accvgpr_read(v[17], a[135]),
  v_accvgpr_read(v[18], a[139]),
  v_accvgpr_read(v[19], a[143]),
  v_accvgpr_read(v[20], a[147]),
  v_accvgpr_read(v[21], a[151]),
  v_accvgpr_read(v[22], a[155]),
  v_accvgpr_read(v[23], a[159]),
  v_accvgpr_read(v[24], a[163]),
  v_accvgpr_read(v[25], a[167]),
  v_accvgpr_read(v[26], a[171]),
  v_accvgpr_read(v[27], a[175]),
  v_accvgpr_read(v[28], a[179]),
  v_accvgpr_read(v[29], a[183]),
  v_accvgpr_read(v[30], a[187]),
  v_accvgpr_read(v[31], a[191]),
  v_accvgpr_read(v[32], a[195]),
  v_accvgpr_read(v[33], a[199]),
  v_accvgpr_read(v[34], a[203]),
  v_accvgpr_read(v[35], a[207]),
  v_accvgpr_read(v[36], a[211]),
  v_accvgpr_read(v[37], a[215]),
  v_accvgpr_read(v[38], a[219]),
  v_accvgpr_read(v[39], a[223]),
  v_accvgpr_read(v[40], a[227]),
  v_accvgpr_read(v[41], a[231]),
  v_accvgpr_read(v[42], a[235]),
  v_accvgpr_read(v[43], a[239]),
  v_accvgpr_read(v[44], a[243]),
  v_accvgpr_read(v[45], a[247]),
  v_accvgpr_read(v[46], a[251]),
  v_accvgpr_read(v[47], a[255]),
  v_mov_b32_e32(v[8], 0xffff0000),
  v_mov_b32_e32(v[9], 0x7fff0000),
  v_mov_b32_e32(v[10], 0x7fff),
  v_cvt_pk_bf16_f32(v[16], v[16], v[17]),
  v_cvt_pk_bf16_f32(v[17], v[18], v[19]),
  v_cvt_pk_bf16_f32(v[18], v[20], v[21]),
  v_cvt_pk_bf16_f32(v[19], v[22], v[23]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[16:19], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[24], v[24], v[25]),
  v_cvt_pk_bf16_f32(v[25], v[26], v[27]),
  v_cvt_pk_bf16_f32(v[26], v[28], v[29]),
  v_cvt_pk_bf16_f32(v[27], v[30], v[31]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[24:27], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[32], v[32], v[33]),
  v_cvt_pk_bf16_f32(v[33], v[34], v[35]),
  v_cvt_pk_bf16_f32(v[34], v[36], v[37]),
  v_cvt_pk_bf16_f32(v[35], v[38], v[39]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[32:35], v[11], s[16:19], 0, offen=1, nt=1),
  v_cvt_pk_bf16_f32(v[40], v[40], v[41]),
  v_cvt_pk_bf16_f32(v[41], v[42], v[43]),
  v_cvt_pk_bf16_f32(v[42], v[44], v[45]),
  v_cvt_pk_bf16_f32(v[43], v[46], v[47]),
  s_lshl_b32(s[12], s[36], 1),
  s_add_u32(s[16], s[16], s[12]),
  s_addc_u32(s[17], s[17], 0),
  buffer_store_dwordx4(v[40:43], v[11], s[16:19], 0, offen=1, nt=1),
  s_nop(0),
  s_endpgm(),
]


# verify a single instruction against llvm

def prepare_verification():
  import pathlib
  raw_txt_lines:list[str] = []
  for l in open(pathlib.Path(__file__).parent/"gemm.s"):
    if l.strip().startswith("//"): continue
    if not l.strip(): continue
    if l.strip().endswith(":"): continue  # skip labels
    if "s_cbranch" in l or "s_branch" in l: continue  # skip branches
    raw_txt_lines.append(l.strip())
  code:list[tuple[int, str]] = []
  on = False
  for lineno,l in enumerate(open(__file__)):
    if on and l.strip() == "]": break
    if on: code.append((lineno, l.strip()))
    elif "[" in l: on = True
  return raw_txt_lines, code

if __name__ == "__main__":
  raw_txt_lines, python_code = prepare_verification()

  #assert len(python_code) == len(gemm)

  for pysrc,asm_txt,inst in zip(python_code, raw_txt_lines, gemm):
    ref = compile_asm(asm_txt)
    try:
      b = inst.to_bytes()
      st = inst.disasm()
      reasm = asm(st, arch='cdna')
      desc = f"{st:25s} {inst} {b!r} {reasm}"
      ref = compile_asm(st)
      assert b == ref == reasm.to_bytes(), f"Bytes mismatch {b} != {ref} for {st}"
    except Exception as e:
      raise Exception(f"failure at Python source lineno {pysrc[0]+1} {pysrc[1]}\n{e}")

    #print(f"PASS {st}")
