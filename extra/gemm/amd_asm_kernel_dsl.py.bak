# RDNA3 128x128 tiled GEMM kernel - DSL version of kernel8_batched_gmem.s
from extra.assembly.amd.dsl import Inst, Inst32, Inst64, Inst96, s, v, NULL, VCC_LO, RawImm, EXEC_LO, SrcMod
from extra.assembly.amd.autogen.rdna3.ins import *

# Kernel constants
LDS_SIZE = 8320
N = 4096
BLOCK_M, BLOCK_N, BLOCK_K = 128, 128, 8
STRIDE = N * 4  # N * sizeof(float)

# Accumulator register pairs to zero (128 vgprs: 64 pairs)
ACC_ZERO_PAIRS = [
  (2,3),(4,5),(18,19),(20,21),(34,35),(36,37),(50,51),(52,53),
  (6,7),(8,9),(22,23),(24,25),(38,39),(40,41),(54,55),(56,57),
  (10,11),(12,13),(26,27),(28,29),(42,43),(44,45),(58,59),(60,61),
  (14,15),(16,17),(30,31),(32,33),(46,47),(48,49),(62,63),(64,65),
  (66,67),(68,69),(82,83),(84,85),(98,99),(100,101),(114,115),(116,117),
  (70,71),(72,73),(86,87),(88,89),(102,103),(104,105),(120,121),(122,123),
  (74,75),(76,77),(90,91),(92,93),(106,107),(108,109),(126,127),(128,129),
  (78,79),(80,81),(94,95),(96,97),(110,111),(112,113),(131,132),(133,124),
]

# Register permutation swaps for output (uses v[200] as temp)
PERMUTE_SWAPS = [
  (128,2), (56,2), (46,2), (100,2), (77,2), (87,2), (27,2), (54,2),
  (42,2), (98,2), (76,2), (83,2), (32,2), (40,2), (110,2), (68,2),
  (93,2), (23,2), (59,2), (38,2), (106,2), (66,2), (92,2), (19,2),
  (64,2), (24,2), (62,2), (20,2), (61,2), (39,2), (107,2), (70,2),
  (90,2), (18,2), (60,2), (35,2), (112,2), (72,2), (94,2), (4,2),
  (129,2), (7,2), (127,2), (6,2), (126,2), (133,3), (57,3), (47,3),
  (101,3), (81,3), (89,3), (31,3), (37,3), (113,3), (73,3), (95,3),
  (5,3), (124,3), (131,8), (53,8), (49,8), (105,8), (79,8), (85,8),
  (33,8), (41,8), (111,8), (69,8), (97,8), (9,8), (132,8), (114,10),
  (12,10), (115,10), (16,10), (122,10), (120,11), (14,11), (116,11), (13,11),
  (121,11), (15,11), (117,11), (17,11), (123,11), (65,21), (25,21), (63,21),
  (58,22), (34,22), (108,22), (67,22), (96,22), (8,22), (50,26), (44,26),
  (99,26), (80,26), (88,26), (30,26), (36,26), (109,26), (71,26), (91,26),
  (22,26), (51,28), (48,28), (104,28), (78,28), (84,28), (29,28), (55,28),
  (43,28), (102,28), (74,28), (82,28), (103,45), (75,45), (86,45), (26,45),
  (45,52), (52,214),
]

# FMAC pattern for one inner loop iteration (64 dual FMACs)
# (vdstx, vdsty, srcx0, vsrcx1, srcy0, vsrcy1)
FMAC_PATTERN = [
  (5,2,186,184,187,185), (3,4,186,185,187,184), (9,6,186,188,187,189), (7,8,187,188,186,189),
  (13,10,190,188,191,189), (11,12,190,189,191,188), (17,14,190,184,191,185), (15,16,191,184,190,185),
  (21,18,194,184,195,185), (19,20,194,185,195,184), (25,22,194,188,195,189), (23,24,195,188,194,189),
  (29,26,198,188,199,189), (27,28,198,189,199,188), (33,30,198,192,199,193), (31,32,199,192,198,193),
  (37,34,186,192,187,193), (35,36,186,193,187,192), (41,38,186,196,187,197), (39,40,187,196,186,197),
  (45,42,190,196,191,197), (43,44,190,197,191,196), (49,46,190,192,191,193), (47,48,191,192,190,193),
  (53,50,194,192,195,193), (51,52,194,193,195,192), (57,54,194,196,195,197), (55,56,195,196,194,197),
  (61,58,198,196,199,197), (59,60,198,197,199,196), (65,62,198,200,199,201), (63,64,199,200,198,201),
  (69,66,186,200,187,201), (67,68,186,201,187,200), (73,70,186,204,187,205), (71,72,187,204,186,205),
  (77,74,190,204,191,205), (75,76,190,205,191,204), (81,78,190,200,191,201), (79,80,191,200,190,201),
  (85,82,194,200,195,201), (83,84,194,201,195,200), (89,86,194,204,195,205), (87,88,195,204,194,205),
  (93,90,198,204,199,205), (91,92,198,205,199,204), (97,94,198,208,199,209), (95,96,199,208,198,209),
  (101,98,186,208,187,209), (99,100,186,209,187,208), (105,102,186,212,187,213), (103,104,187,212,186,213),
  (109,106,190,212,191,213), (107,108,190,213,191,212), (113,110,190,208,191,209), (111,112,191,208,190,209),
  (117,114,194,208,195,209), (115,116,194,209,195,208), (121,122,194,212,195,213), (123,120,195,212,194,213),
  (129,126,198,212,199,213), (127,124,198,213,199,212), (133,214,198,184,199,185), (131,128,199,184,198,185),
]

# Prefetch load pairs: (vdst1, vdst2, addr_vreg, saddr_lo1, saddr_lo2)
# addr_vreg: 203 for first 4 loads, 215 for last 8 loads
PREFETCH_LOADS = [
  (171, 172, 203, 32, 34), (173, 174, 203, 36, 38),
  (175, 176, 215, 40, 42), (177, 178, 215, 44, 46),
  (179, 180, 215, 48, 50), (181, 182, 215, 52, 54),
]

# LDS store pairs for writing prefetched data to LDS (addr, data)
LDS_STORE_PAIRS = [
  (155, 167), (141, 175), (158, 168), (142, 176),
  (159, 169), (143, 177), (160, 170), (144, 178),
  (161, 171), (145, 179), (162, 172), (146, 180),
  (163, 173), (147, 181), (164, 174), (148, 182),
]

# LDS B-tile address calculations: (dest, src) pairs for v_mad_u32_u24(dest, 0x210, v[118], src)
LDS_ADDR_PAIRS = [(142, 9), (143, 10), (144, 11), (145, 14), (146, 15), (147, 16), (148, 17)]

# Chained lshlrev_b32 pairs: (dst, src) for v[dst] = v[src] << 2
LSHL_CHAIN = [(9, 10), (10, 11), (11, 14), (14, 15), (15, 16), (16, 17), (17, 18)]

# LDS offset subtractions: v[a] = v[a] - v[b]
LDS_SUB_PAIRS = [(10, 19), (11, 20), (14, 21), (15, 22), (16, 32), (17, 33), (18, 34)]

# LDS base offset adds: v[dst] = s[12] + v[src]
LDS_ADD_PAIRS = [(19, 10), (20, 11), (21, 14), (32, 15), (33, 16), (34, 17), (35, 18)]

# LDS address masking: v[dst] = v[src] & 0x3fffff80
LDS_MASK_PAIRS = [(19, 19), (20, 20), (21, 21), (22, 32), (32, 33), (33, 34), (34, 35)]

# LDS row offset ORs: (dst, offset) for v[dst] = v[22] | offset
LDS_ROW_OFFSETS = [(10, 16), (11, 32), (14, 48), (15, 64), (16, 0x50), (17, 0x60), (18, 0x70)]

# Initial B-tile prefetch: (vdst, saddr_lo) pairs for global_load_b32 from v[203]
INIT_PREFETCH = [(167, 24), (168, 26), (169, 28), (170, 30)]

# LDS A-tile address offsets: (dst, shift_amt) for v[dst] = (shift_amt << 9) + v[155]
LDS_A_OFFSETS = [(158, 1), (159, 2), (160, 3), (161, 4), (162, 5), (163, 6), (164, 7)]

# Initial B-tile loads: (vdst, addr_lo) pairs for global_load_b32
INIT_B_LOADS_1 = [(23, 5), (24, 9), (25, 7), (26, 2), (27, 11), (28, 13)]
INIT_B_LOADS_2 = [(29, 6), (30, 8), (31, 10), (12, 12), (13, 14)]
INIT_B_LOADS_3 = [(3, 2), (4, 4)]
INIT_B_LOADS_4 = [(5, 8), (6, 6), (7, 10)]

# Accumulator zero pairs for LBB0_4 path (59 pairs) - zeros vgprs using immediate 0
ACC_ZERO_PAIRS_B = [
  (111,94),(97,80),(95,78),(81,128),(79,126),(129,108),(127,106),(109,92),
  (107,90),(93,76),(91,74),(77,122),(75,120),(123,104),(121,102),(105,88),
  (103,86),(89,72),(87,70),(73,116),(71,114),(117,100),(115,98),(101,84),
  (99,82),(85,68),(83,66),(69,64),(67,62),(65,48),(63,46),(49,32),
  (47,30),(33,16),(31,14),(17,60),(15,58),(61,44),(59,42),(45,28),
  (43,26),(29,12),(27,10),(13,56),(11,54),(57,40),(55,38),(41,24),
  (39,22),(25,8),(23,6),(9,52),(7,50),(53,36),(51,34),(37,20),
  (35,18),(21,4),(19,2),
]

class Kernel:
  def __init__(self, arch: str = 'gfx1100'):
    self.instructions = []
    self.labels = {}
    self.branch_targets = {}  # Maps instruction index to target label
    self.arch = arch

  def emit(self, inst): self.instructions.append(inst); return inst
  def label(self, name): self.labels[name] = len(self.instructions)
  def branch_to(self, label): self.branch_targets[len(self.instructions) - 1] = label

  # Helper: emit 64-bit address = base + offset (with carry)
  def add64_imm(self, dst_lo, dst_hi, src_lo, src_hi, offset):
    self.emit(s_add_u32(s[dst_lo], s[src_lo], offset))
    self.emit(s_addc_u32(s[dst_hi], s[src_hi], 0))

  # Helper: emit dual mov to zero two vgprs (using sgpr as source)
  def dual_mov_zero(self, vdst1, vdst2, zero_sgpr):
    self.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_MOV_B32,
                   vdstx=v[vdst1], vdsty=v[vdst2], srcx0=s[zero_sgpr], vsrcx1=v[0], srcy0=s[zero_sgpr], vsrcy1=v[0]))

  # Helper: emit dual mov to zero two vgprs (using immediate 0)
  def dual_mov_zero_imm(self, vdst1, vdst2):
    self.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_MOV_B32,
                   vdstx=v[vdst1], vdsty=v[vdst2], srcx0=0, vsrcx1=v[0], srcy0=0, vsrcy1=v[0]))

  # Helper: emit dual fmac
  def dual_fmac(self, vdstx, vdsty, ax, bx, ay, by):
    self.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32,
                   vdstx=v[vdstx], vdsty=v[vdsty], srcx0=v[ax], vsrcx1=v[bx], srcy0=v[ay], vsrcy1=v[by]))

  # Helper: emit the 64 dual FMACs for one inner loop iteration
  # First FMAC, then s_setprio(1), then remaining 63 FMACs
  def fmac_block(self):
    self.dual_fmac(*FMAC_PATTERN[0])
    self.emit(s_setprio(1))
    for vdstx, vdsty, ax, bx, ay, by in FMAC_PATTERN[1:]:
      self.dual_fmac(vdstx, vdsty, ax, bx, ay, by)

  # Helper: emit the standard 12 ds_load_b64 for loading A and B tiles from LDS
  def lds_load_ab_tiles(self):
    # A matrix tile from v[183]: 4 pairs at offsets 0,8,64,72 -> v[186:199] (step 4)
    for i, (vdst, off) in enumerate([(186,0), (190,8), (194,64), (198,72)]):
      self.emit(ds_load_b64(vdst=v[vdst:vdst+1], addr=v[183], offset0=off, offset1=0))
    # B matrix tile from v[202]: 4 pairs at offsets 0,8,128,136 with offset1=0 -> v[184:197] (step 4)
    for vdst, off in [(184,0), (188,8), (192,128), (196,136)]:
      self.emit(ds_load_b64(vdst=v[vdst:vdst+1], addr=v[202], offset0=off, offset1=0))
    # B matrix tile from v[202]: 4 pairs at offsets 0,8,128,136 with offset1=1 -> v[200:213] (step 4)
    for vdst, off in [(200,0), (204,8), (208,128), (212,136)]:
      self.emit(ds_load_b64(vdst=v[vdst:vdst+1], addr=v[202], offset0=off, offset1=1))

  # Helper: swap two vgprs using v[200] as temp
  def vswap(self, a, b):
    self.emit(v_mov_b32_e32(v[200], v[a]))
    self.emit(v_mov_b32_e32(v[a], v[b]))
    self.emit(v_mov_b32_e32(v[b], v[200]))

  # Helper: one iteration of the main GEMM loop with prefetch loads
  def main_loop_iter(self, prefetch_idx):
    self.emit(s_clause(simm16=11))
    self.lds_load_ab_tiles()
    self.emit(v_add_nc_u32_e32(v[183], 0x210, v[183]))
    self.emit(v_add_nc_u32_e32(v[202], 0x200, v[202]))
    self.emit(s_waitcnt(simm16=64519))
    self.fmac_block()
    self.emit(s_setprio(0))
    if prefetch_idx is not None:
      vdst1, vdst2, addr, slo1, slo2 = PREFETCH_LOADS[prefetch_idx]
      self.emit(s_clause(simm16=1))
      self.emit(global_load_b32(vdst=v[vdst1], addr=v[addr], saddr=s[slo1:slo1+2]))
      self.emit(global_load_b32(vdst=v[vdst2], addr=v[addr], saddr=s[slo2:slo2+2]))

  # Helper: write prefetched data to LDS (16 stores)
  def lds_store_prefetch(self):
    for addr, data in LDS_STORE_PAIRS:
      self.emit(ds_store_b32(addr=v[addr], data0=v[data], offset0=0, offset1=0))

  def inst_size(self, inst):
    if isinstance(inst, Inst96): return 12
    if isinstance(inst, Inst64): return 8
    return 4

  def byte_offset(self, from_idx, to_idx):
    if from_idx <= to_idx:
      return sum(self.inst_size(self.instructions[i]) for i in range(from_idx, to_idx))
    else:
      return -sum(self.inst_size(self.instructions[i]) for i in range(to_idx, from_idx))

  def to_asm(self):
    lines = ['\t.text', f'\t.amdgcn_target "amdgcn-amd-amdhsa--{self.arch}"',
             '\t.protected\tkernel', '\t.globl\tkernel', '\t.p2align\t8',
             '\t.type\tkernel,@function', 'kernel:']
    label_at = {pos: name for name, pos in self.labels.items()}
    for i, inst in enumerate(self.instructions):
      if i in label_at: lines.append(f'.{label_at[i]}:')
      asm_line = inst.disasm()
      # Fix up branch instructions to use label references
      if i in self.branch_targets:
        target_label = self.branch_targets[i]
        import re
        asm_line = re.sub(r'(s_cbranch_\w+|s_branch)\s+\S+', rf'\1 .{target_label}', asm_line)
      lines.append('\t' + asm_line)
    lines.extend(['\t.section\t.rodata,"a",@progbits', '\t.p2align\t6, 0x0',
      '\t.amdhsa_kernel kernel', f'\t\t.amdhsa_group_segment_fixed_size {LDS_SIZE}',
      '\t\t.amdhsa_private_segment_fixed_size 0', '\t\t.amdhsa_kernarg_size 36',
      '\t\t.amdhsa_user_sgpr_count 14', '\t\t.amdhsa_user_sgpr_dispatch_ptr 0',
      '\t\t.amdhsa_user_sgpr_queue_ptr 0', '\t\t.amdhsa_user_sgpr_kernarg_segment_ptr 1',
      '\t\t.amdhsa_user_sgpr_dispatch_id 0', '\t\t.amdhsa_user_sgpr_private_segment_size 0',
      '\t\t.amdhsa_wavefront_size32 1', '\t\t.amdhsa_uses_dynamic_stack 0',
      '\t\t.amdhsa_enable_private_segment 0', '\t\t.amdhsa_system_sgpr_workgroup_id_x 1',
      '\t\t.amdhsa_system_sgpr_workgroup_id_y 1', '\t\t.amdhsa_system_sgpr_workgroup_id_z 0',
      '\t\t.amdhsa_system_sgpr_workgroup_info 0', '\t\t.amdhsa_system_vgpr_workitem_id 0',
      '\t\t.amdhsa_next_free_vgpr 216', '\t\t.amdhsa_next_free_sgpr 16',
      '\t\t.amdhsa_float_round_mode_32 0', '\t\t.amdhsa_float_round_mode_16_64 0',
      '\t\t.amdhsa_float_denorm_mode_32 3', '\t\t.amdhsa_float_denorm_mode_16_64 3',
      '\t\t.amdhsa_dx10_clamp 1', '\t\t.amdhsa_ieee_mode 1', '\t\t.amdhsa_fp16_overflow 0',
      '\t\t.amdhsa_workgroup_processor_mode 0', '\t\t.amdhsa_memory_ordered 1',
      '\t\t.amdhsa_forward_progress 0', '\t\t.amdhsa_shared_vgpr_count 0',
      '\t.end_amdhsa_kernel',
      '\t.text', '.Lfunc_end0:', '\t.size\tkernel, .Lfunc_end0-kernel',
      '\t.amdgpu_metadata', '---', 'amdhsa.kernels:', '  - .args:',
      '      - .address_space: global', '        .offset: 0', '        .size: 8',
      '        .value_kind: global_buffer', '      - .address_space: global',
      '        .offset: 8', '        .size: 8', '        .value_kind: global_buffer',
      '      - .address_space: global', '        .offset: 16', '        .size: 8',
      '        .value_kind: global_buffer', f'    .group_segment_fixed_size: {LDS_SIZE}',
      '    .kernarg_segment_align: 8', '    .kernarg_segment_size: 24',
      '    .max_flat_workgroup_size: 128', '    .name: kernel',
      '    .private_segment_fixed_size: 0', '    .sgpr_count: 60', '    .symbol: kernel.kd',
      '    .vgpr_count: 216', '    .wavefront_size: 32',
      f'amdhsa.target: amdgcn-amd-amdhsa--{self.arch}', 'amdhsa.version:', '  - 1',
      '  - 2', '...', '\t.end_amdgpu_metadata'])
    return '\n'.join(lines)

def build_kernel(arch='gfx1100'):
  k = Kernel(arch)

  # === KERNEL SETUP: Load arguments and compute matrix tile offsets ===
  k.emit(s_load_b128(sdata=s[20:23], sbase=s[0:1], offset=0x0, soffset=RawImm(124)))
  k.emit(s_waitcnt(simm16=64519))
  # B matrix offsets: s[24:39] = s[22:23] + i*0x4000 for i in 0..7
  for i in range(8): k.add64_imm(24 + i*2, 25 + i*2, 22, 23, i * 0x4000)
  k.emit(s_lshl_b32(s[19], s[14], 7))
  k.emit(v_add_nc_u32_e32(v[203], s[19], v[0]))
  k.emit(v_lshlrev_b32_e32(v[203], 2, v[203]))
  # A matrix offsets: s[40:55] = s[20:21] + i*0x40000 for i in 0..7
  for i in range(8): k.add64_imm(40 + i*2, 41 + i*2, 20, 21, i * 0x40000)
  k.emit(s_lshl_b32(s[19], s[15], 19))
  k.emit(v_lshrrev_b32_e32(v[1], 3, v[0]))
  k.emit(v_lshlrev_b32_e32(v[1], 12, v[1]))
  k.emit(v_and_b32_e32(v[215], 7, v[0]))
  k.emit(v_add_nc_u32_e32(v[215], v[1], v[215]))
  k.emit(v_add_nc_u32_e32(v[215], s[19], v[215]))
  k.emit(v_lshlrev_b32_e32(v[215], 2, v[215]))
  k.emit(s_clause(simm16=1))
  k.emit(s_mov_b32(s[4], 4096))
  k.emit(s_mov_b32(s[5], 0x3F800000))
  k.emit(s_mov_b32(s[6], 0))
  k.emit(s_load_b128(sdata=s[8:11], sbase=s[0:1], offset=0x0, soffset=RawImm(124)))
  k.emit(s_lshl_b32(s[2], s[14], 7))
  k.emit(v_lshrrev_b32_e32(v[4], 3, v[0]))
  k.emit(v_or_b32_e32(v[1], s[2], v[0]))
  k.emit(s_lshl_b32(s[3], s[15], 7))
  k.emit(v_and_b32_e32(v[118], 7, v[0]))
  k.emit(s_bfe_i32(s[12], s[15], 0x10018))
  k.emit(v_or_b32_e32(v[22], s[3], v[4]))
  k.emit(v_ashrrev_i32_e32(v[2], 31, v[1]))
  k.emit(s_lshr_b32(s[12], s[12], 25))
  k.emit(s_load_b64(sdata=s[0:1], sbase=s[0:1], offset=0x10, soffset=RawImm(124)))
  k.emit(v_lshlrev_b32_e32(v[135], 2, v[118]))
  k.emit(s_delay_alu(simm16=450))
  k.emit(v_lshlrev_b64(v[5:6], 2, v[1:2]))
  k.emit(s_waitcnt(simm16=64519))
  k.emit(v_add_nc_u32_e32(v[3], s[4], v[1]))
  k.emit(v_mul_lo_u32(v[119], v[22], s[4]))
  k.emit(v_add_co_u32(v[5], VCC_LO, s[10], v[5]))
  k.emit(s_delay_alu(simm16=532))
  k.emit(v_add_co_ci_u32_e32(v[6], s[11], v[6]))
  k.emit(v_add_nc_u32_e32(v[7], s[4], v[3]))
  k.emit(v_ashrrev_i32_e32(v[4], 31, v[3]))
  k.emit(s_lshl_b32(s[7], s[4], 4))
  k.emit(s_delay_alu(simm16=409))
  k.emit(v_add_nc_u32_e32(v[125], s[7], v[119]))
  k.emit(v_add_nc_u32_e32(v[2], s[4], v[7]))
  k.emit(v_ashrrev_i32_e32(v[8], 31, v[7]))
  k.emit(v_lshlrev_b64(v[9:10], 2, v[3:4]))
  k.emit(s_delay_alu(simm16=532))
  k.emit(v_add_nc_u32_e32(v[130], s[7], v[125]))
  k.emit(v_add_nc_u32_e32(v[11], s[4], v[2]))
  k.emit(v_ashrrev_i32_e32(v[3], 31, v[2]))
  k.emit(v_lshlrev_b64(v[7:8], 2, v[7:8]))
  k.emit(v_add_co_u32(v[9], VCC_LO, s[10], v[9]))
  k.emit(s_delay_alu(simm16=580))
  k.emit(v_add_nc_u32_e32(v[13], s[4], v[11]))
  k.emit(v_ashrrev_i32_e32(v[12], 31, v[11]))
  k.emit(v_lshlrev_b64(v[2:3], 2, v[2:3]))
  k.emit(v_add_co_ci_u32_e32(v[10], s[11], v[10]))
  k.emit(v_ashrrev_i32_e32(v[14], 31, v[13]))
  k.emit(v_add_co_u32(v[7], VCC_LO, s[10], v[7]))
  k.emit(v_lshlrev_b64(v[11:12], 2, v[11:12]))
  k.emit(v_add_co_ci_u32_e32(v[8], s[11], v[8]))
  k.emit(v_add_nc_u32_e32(v[15], s[4], v[13]))
  k.emit(v_add_co_u32(v[2], VCC_LO, s[10], v[2]))
  k.emit(v_lshlrev_b64(v[13:14], 2, v[13:14]))
  k.emit(v_add_co_ci_u32_e32(v[3], s[11], v[3]))
  k.emit(v_add_co_u32(v[11], VCC_LO, s[10], v[11]))
  k.emit(v_add_nc_u32_e32(v[4], s[4], v[15]))
  k.emit(v_add_co_ci_u32_e32(v[12], s[11], v[12]))
  k.emit(v_add_co_u32(v[13], VCC_LO, s[10], v[13]))
  k.emit(v_ashrrev_i32_e32(v[16], 31, v[15]))
  k.emit(v_add_nc_u32_e32(v[134], s[7], v[130]))
  k.emit(v_add_co_ci_u32_e32(v[14], s[11], v[14]))
  k.emit(s_clause(simm16=5))
  for vdst, alo in INIT_B_LOADS_1: k.emit(global_load_b32(vdst=v[vdst], addr=v[alo:alo+1], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[6], v[119], v[118]))
  k.emit(v_ashrrev_i32_e32(v[5], 31, v[4]))
  k.emit(v_add_nc_u32_e32(v[8], v[125], v[118]))
  k.emit(v_lshlrev_b64(v[2:3], 2, v[15:16]))
  k.emit(v_add_nc_u32_e32(v[137], s[7], v[134]))
  k.emit(v_ashrrev_i32_e32(v[7], 31, v[6]))
  k.emit(v_add_nc_u32_e32(v[10], v[130], v[118]))
  k.emit(v_lshlrev_b64(v[4:5], 2, v[4:5]))
  k.emit(v_ashrrev_i32_e32(v[9], 31, v[8]))
  k.emit(v_add_nc_u32_e32(v[12], v[134], v[118]))
  k.emit(v_add_nc_u32_e32(v[138], s[7], v[137]))
  k.emit(v_add_co_u32(v[2], VCC_LO, s[10], v[2]))
  k.emit(v_lshlrev_b64(v[6:7], 2, v[6:7]))
  k.emit(v_ashrrev_i32_e32(v[11], 31, v[10]))
  k.emit(v_add_co_ci_u32_e32(v[3], s[11], v[3]))
  k.emit(v_add_nc_u32_e32(v[14], v[137], v[118]))
  k.emit(v_add_co_u32(v[4], VCC_LO, s[10], v[4]))
  k.emit(v_lshlrev_b64(v[8:9], 2, v[8:9]))
  k.emit(v_ashrrev_i32_e32(v[13], 31, v[12]))
  k.emit(v_add_nc_u32_e32(v[139], s[7], v[138]))
  k.emit(v_add_co_ci_u32_e32(v[5], s[11], v[5]))
  k.emit(v_add_co_u32(v[6], VCC_LO, s[8], v[6]))
  k.emit(v_lshlrev_b64(v[10:11], 2, v[10:11]))
  k.emit(v_ashrrev_i32_e32(v[15], 31, v[14]))
  k.emit(v_add_co_ci_u32_e32(v[7], s[9], v[7]))
  k.emit(v_add_nc_u32_e32(v[16], v[138], v[118]))
  k.emit(v_add_co_u32(v[8], VCC_LO, s[8], v[8]))
  k.emit(v_lshlrev_b64(v[12:13], 2, v[12:13]))
  k.emit(v_add_nc_u32_e32(v[140], s[7], v[139]))
  k.emit(v_add_co_ci_u32_e32(v[9], s[9], v[9]))
  k.emit(v_add_nc_u32_e32(v[18], v[139], v[118]))
  k.emit(v_add_co_u32(v[10], VCC_LO, s[8], v[10]))
  k.emit(v_lshlrev_b64(v[14:15], 2, v[14:15]))
  k.emit(v_ashrrev_i32_e32(v[17], 31, v[16]))
  k.emit(v_add_co_ci_u32_e32(v[11], s[9], v[11]))
  k.emit(v_add_nc_u32_e32(v[20], v[140], v[118]))
  k.emit(v_add_co_u32(v[12], VCC_LO, s[8], v[12]))
  k.emit(v_ashrrev_i32_e32(v[19], 31, v[18]))
  k.emit(v_add_co_ci_u32_e32(v[13], s[9], v[13]))
  k.emit(v_add_co_u32(v[14], VCC_LO, s[8], v[14]))
  k.emit(v_lshlrev_b64(v[16:17], 2, v[16:17]))
  k.emit(v_ashrrev_i32_e32(v[21], 31, v[20]))
  k.emit(v_add_co_ci_u32_e32(v[15], s[9], v[15]))
  k.emit(s_clause(simm16=4))
  for vdst, alo in INIT_B_LOADS_2: k.emit(global_load_b32(vdst=v[vdst], addr=v[alo:alo+1], saddr=RawImm(124)))
  k.emit(v_lshlrev_b64(v[6:7], 2, v[18:19]))
  k.emit(v_add_co_u32(v[8], VCC_LO, s[8], v[16]))
  k.emit(v_lshlrev_b64(v[10:11], 2, v[20:21]))
  k.emit(v_add_co_ci_u32_e32(v[9], s[9], v[17]))
  k.emit(s_delay_alu(simm16=548))
  k.emit(v_add_co_u32(v[6], VCC_LO, s[8], v[6]))
  k.emit(v_add_co_ci_u32_e32(v[7], s[9], v[7]))
  k.emit(v_add_co_u32(v[10], VCC_LO, s[8], v[10]))
  k.emit(v_add_co_ci_u32_e32(v[11], s[9], v[11]))
  k.emit(s_clause(simm16=1))
  for vdst, alo in INIT_B_LOADS_3: k.emit(global_load_b32(vdst=v[vdst], addr=v[alo:alo+1], saddr=RawImm(124)))
  k.emit(s_clause(simm16=2))
  for vdst, alo in INIT_B_LOADS_4: k.emit(global_load_b32(vdst=v[vdst], addr=v[alo:alo+1], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[9], s[12], v[22]))
  for dst, off in LDS_ROW_OFFSETS: k.emit(v_or_b32_e32(v[dst], off, v[22]))
  k.emit(s_bfe_i32(s[7], s[14], 0x10018))
  k.emit(v_and_b32_e32(v[9], 0x3fffff80, v[9]))
  k.emit(s_lshr_b32(s[7], s[7], 25))
  for dst, src in LDS_ADD_PAIRS[:1]: k.emit(v_add_nc_u32_e32(v[dst], s[12], v[src]))
  k.emit(v_add_nc_u32_e32(v[8], s[7], v[1]))
  for dst, src in LDS_ADD_PAIRS[1:]: k.emit(v_add_nc_u32_e32(v[dst], s[12], v[src]))
  k.emit(v_and_b32_e32(v[8], 0x3fffff80, v[8]))
  k.emit(v_sub_nc_u32_e32(v[9], v[22], v[9]))
  for dst, src in LDS_MASK_PAIRS: k.emit(v_and_b32_e32(v[dst], 0x3fffff80, v[src]))
  k.emit(v_sub_nc_u32_e32(v[8], v[1], v[8]))
  k.emit(v_lshlrev_b32_e32(v[9], 2, v[9]))
  for a, b in LDS_SUB_PAIRS: k.emit(v_sub_nc_u32_e32(v[a], v[a], v[b]))
  k.emit(v_bfe_u32(v[2], v[0], 3, 2))
  k.emit(v_lshlrev_b32_e32(v[8], 2, v[8]))
  k.emit(v_mad_u32_u24(v[141], 0x210, v[118], v[9]))
  for dst, src in LSHL_CHAIN: k.emit(v_lshlrev_b32_e32(v[dst], 2, v[src]))
  k.emit(v_lshlrev_b32_e32(v[136], 2, v[2]))
  k.emit(v_add_nc_u32_e32(v[8], 0x80, v[8]))
  for dst, src in LDS_ADDR_PAIRS: k.emit(v_mad_u32_u24(v[dst], 0x210, v[118], v[src]))
  k.emit(s_mov_b32(s[7], 0))
  k.emit(s_cmp_gt_i32(s[4], 0))
  k.emit(s_waitcnt(simm16=15351))
  k.emit(ds_store_2addr_stride64_b32(addr=v[8], data0=v[23], data1=v[24], offset0=16, offset1=18))
  k.emit(s_waitcnt(simm16=10231))
  k.emit(ds_store_b32(addr=v[141], data0=v[29], offset0=0, offset1=0))
  k.emit(ds_store_2addr_stride64_b32(addr=v[8], data0=v[25], data1=v[26], offset0=20, offset1=22))
  k.emit(s_waitcnt(simm16=9207))
  k.emit(ds_store_b32(addr=v[142], data0=v[30], offset0=0, offset1=0))
  k.emit(s_waitcnt(simm16=8183))
  k.emit(ds_store_b32(addr=v[143], data0=v[31], offset0=0, offset1=0))
  k.emit(ds_store_2addr_stride64_b32(addr=v[8], data0=v[27], data1=v[28], offset0=24, offset1=26))
  k.emit(s_waitcnt(simm16=7159))
  k.emit(ds_store_b32(addr=v[144], data0=v[12], offset0=0, offset1=0))
  k.emit(s_waitcnt(simm16=6135))
  k.emit(ds_store_b32(addr=v[145], data0=v[13], offset0=0, offset1=0))
  k.emit(s_waitcnt(simm16=4087))
  k.emit(ds_store_2addr_stride64_b32(addr=v[8], data0=v[3], data1=v[4], offset0=28, offset1=30))
  k.emit(s_waitcnt(simm16=3063))
  k.emit(ds_store_b32(addr=v[146], data0=v[5], offset0=0, offset1=0))
  k.emit(s_waitcnt(simm16=2039))
  k.emit(ds_store_b32(addr=v[147], data0=v[6], offset0=0, offset1=0))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(ds_store_b32(addr=v[148], data0=v[7], offset0=0, offset1=0))
  k.emit(s_waitcnt(simm16=64519))
  k.emit(s_barrier())
  k.emit(s_cbranch_scc1(simm16=0))
  k.branch_to('LBB0_3')
  k.emit(v_lshlrev_b32_e32(v[149], 2, v[118]))
  k.emit(v_lshlrev_b32_e32(v[150], 2, v[2]))
  k.emit(s_mov_b32(s[12], 0))
  k.emit(s_and_not1_b32(VCC_LO, EXEC_LO, s[7]))
  k.emit(s_cbranch_vccz(simm16=0))
  k.branch_to('LBB0_4')
  # Zero 128 accumulator vgprs (64 pairs)
  for vx, vy in ACC_ZERO_PAIRS: k.dual_mov_zero(vx, vy, 12)
  k.emit(s_branch(simm16=0))
  k.branch_to('LBB0_13')
  k.label('LBB0_3')
  k.emit(s_mov_b32(s[7], -1))
  k.label('LBB0_4')
  k.emit(s_ashr_i32(s[7], s[2], 31))
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_LSHLREV_B32, vdstx=v[133], vdsty=v[2], srcx0=0, vsrcx1=v[0], srcy0=4, vsrcy1=v[2]))
  k.emit(s_lshr_b32(s[7], s[7], 25))
  k.emit(s_delay_alu(simm16=585))
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[124], vdsty=v[3], srcx0=0, vsrcx1=v[0], srcy0=s[7], vsrcy1=v[1]))
  k.emit(v_ashrrev_i32_e32(v[149], 31, v[119]))
  k.emit(v_ashrrev_i32_e32(v[150], 31, v[125]))
  k.emit(v_ashrrev_i32_e32(v[151], 31, v[130]))
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_AND_B32, vdstx=v[132], vdsty=v[3], srcx0=0, vsrcx1=v[0], srcy0=0x3fffff80, vsrcy1=v[3]))
  k.emit(v_ashrrev_i32_e32(v[152], 31, v[134]))
  k.emit(v_ashrrev_i32_e32(v[153], 31, v[137]))
  k.emit(v_ashrrev_i32_e32(v[154], 31, v[138]))
  k.emit(v_ashrrev_i32_e32(v[156], 31, v[139]))
  k.emit(v_sub_nc_u32_e32(v[3], v[1], v[3]))
  k.emit(v_ashrrev_i32_e32(v[157], 31, v[140]))
  k.emit(v_lshl_or_b32(v[166], v[118], 4, 0x1080))
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_MOV_B32, vdstx=v[131], vdsty=v[110], srcx0=0, vsrcx1=v[0], srcy0=0, vsrcy1=v[0]))
  k.emit(s_delay_alu(simm16=436))
  k.emit(v_lshl_add_u32(v[155], v[3], 2, 0x1080))
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_LSHLREV_B32, vdstx=v[112], vdsty=v[3], srcx0=0, vsrcx1=v[0], srcy0=2, vsrcy1=v[0]))
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_MOV_B32, vdstx=v[113], vdsty=v[96], srcx0=0, vsrcx1=v[0], srcy0=0, vsrcy1=v[0]))
  for dst, amt in LDS_A_OFFSETS: k.emit(v_lshl_add_u32(v[dst], amt, 9, v[155]))
  k.emit(v_and_or_b32(v[165], 0x180, v[3], v[2]))
  for vx, vy in ACC_ZERO_PAIRS_B: k.dual_mov_zero_imm(vx, vy)
  k.emit(v_mov_b32_e32(v[214], 0))
  k.emit(v_mov_b32_e32(v[5], 0))
  k.emit(v_mov_b32_e32(v[3], 0))
  k.emit(s_add_i32(s[7], s[4], -8))
  k.emit(s_add_u32(s[8], s[8], 32))
  k.emit(s_addc_u32(s[9], s[9], 0))
  k.emit(s_mov_b32(s[12], 0))
  k.emit(s_branch(simm16=0))
  k.branch_to('LBB0_6')

  # === MAIN GEMM LOOP: 8 iterations of FMAC with LDS loads and global prefetch ===
  k.label('LBB0_5')
  k.emit(s_add_i32(s[12], s[12], 8))
  k.emit(s_delay_alu(simm16=9))
  k.emit(s_cmp_ge_i32(s[12], s[4]))
  k.emit(s_cbranch_scc1(simm16=0))
  k.branch_to('LBB0_12')
  k.label('LBB0_6')
  k.emit(s_cmp_lt_i32(s[12], s[7]))
  k.emit(s_cselect_b32(s[13], -1, 0))
  k.emit(s_cmp_ge_i32(s[12], s[7]))
  k.emit(s_cbranch_scc1(simm16=0))
  k.branch_to('LBB0_8')
  k.emit(v_add_nc_u32_e32(v[203], 0x20000, v[203]))
  k.emit(v_add_nc_u32_e32(v[215], 0x20, v[215]))
  k.emit(s_setprio(0))
  for vdst, slo in INIT_PREFETCH: k.emit(global_load_b32(vdst=v[vdst], addr=v[203], saddr=s[slo:slo+2]))
  k.label('LBB0_8')
  k.emit(v_mov_b32_e32(v[183], v[165]))
  k.emit(s_mov_b32(s[14], 0))
  k.emit(v_mov_b32_e32(v[202], v[166]))
  k.label('LBB0_9')
  for i in range(6): k.main_loop_iter(i)  # 6 iterations with prefetch
  k.main_loop_iter(None)  # iteration 7: no prefetch
  k.main_loop_iter(None)  # iteration 8: no prefetch
  k.emit(s_and_not1_b32(VCC_LO, EXEC_LO, s[13]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(s_barrier())
  k.emit(s_cbranch_vccnz(simm16=0))
  k.branch_to('LBB0_5')
  k.lds_store_prefetch()
  k.emit(s_waitcnt(simm16=64519))
  k.emit(s_barrier())
  k.emit(s_branch(simm16=0))
  k.branch_to('LBB0_5')
  k.label('LBB0_12')
  # Register permutation for output layout (122 swaps)
  for a, b in PERMUTE_SWAPS: k.vswap(a, b)
  k.emit(VOPD(VOPDOp.V_DUAL_MOV_B32, VOPDOp.V_DUAL_MOV_B32, vdstx=v[149], vdsty=v[150], srcx0=v[135], vsrcx1=v[0], srcy0=v[136], vsrcy1=v[0]))

  # === EPILOGUE: Scale and store accumulated results (software-pipelined) ===
  k.label('LBB0_13')
  k.emit(s_delay_alu(simm16=273))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_AND_B32, vdstx=v[139], vdsty=v[0], srcx0=s[5], vsrcx1=v[133], srcy0=0x60, vsrcy1=v[0]))
  k.emit(v_or_b32_e32(v[118], s[2], v[149]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[140], vdsty=v[141], srcx0=s[5], vsrcx1=v[132], srcy0=s[5], vsrcy1=v[131]))
  k.emit(s_delay_alu(simm16=147))
  k.emit(v_add_nc_u32_e32(v[0], s[3], v[0]))
  k.emit(v_or_b32_e32(v[119], v[0], v[150]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_mul_lo_u32(v[144], v[119], s[4]))
  k.emit(v_add_nc_u32_e32(v[0], v[118], v[144]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[1], 31, v[0]))
  k.emit(v_lshlrev_b64(v[0:1], 2, v[0:1]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[0], VCC_LO, s[0], v[0]))
  k.emit(v_add_co_ci_u32_e32(v[1], s[1], v[1]))
  k.emit(global_load_b128(vdst=v[134:137], addr=v[0:1], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[138], vdsty=v[141], srcx0=s[5], vsrcx1=v[124], srcy0=s[6], vsrcy1=v[137]))
  k.emit(s_delay_alu(simm16=433))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[138], vdsty=v[145], srcx0=s[6], vsrcx1=v[134], srcy0=s[4], vsrcy1=v[144]))
  k.emit(v_fmac_f32_e32(v[139], s[6], v[135]))
  k.emit(v_mul_f32_e32(v[137], s[5], v[126]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[135], vdsty=v[142], srcx0=s[5], vsrcx1=v[128], srcy0=v[118], vsrcy1=v[145]))
  k.emit(v_fmac_f32_e32(v[140], s[6], v[136]))
  k.emit(v_mul_f32_e32(v[134], s[5], v[129]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[128], vdsty=v[129], srcx0=s[5], vsrcx1=v[123], srcy0=s[5], vsrcy1=v[122]))
  k.emit(s_delay_alu(simm16=212))
  k.emit(v_ashrrev_i32_e32(v[143], 31, v[142]))
  k.emit(global_store_b128(addr=v[0:1], data=v[138:141], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[138], s[4], v[145]))
  k.emit(v_mul_f32_e32(v[136], s[5], v[127]))
  k.emit(v_lshlrev_b64(v[124:125], 2, v[142:143]))
  k.emit(v_add_co_u32(v[124], VCC_LO, s[0], v[124]))
  k.emit(s_delay_alu(simm16=194))
  k.emit(v_add_co_ci_u32_e32(v[125], s[1], v[125]))
  k.emit(global_load_b128(vdst=v[130:133], addr=v[124:125], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[137], vdsty=v[0], srcx0=s[6], vsrcx1=v[133], srcy0=v[118], vsrcy1=v[138]))
  k.emit(v_ashrrev_i32_e32(v[1], 31, v[0]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[135], vdsty=v[136], srcx0=s[6], vsrcx1=v[131], srcy0=s[6], vsrcy1=v[132]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[131], vdsty=v[134], srcx0=s[5], vsrcx1=v[120], srcy0=s[6], vsrcy1=v[130]))
  k.emit(s_delay_alu(simm16=3))
  k.emit(v_lshlrev_b64(v[0:1], 2, v[0:1]))
  k.emit(global_store_b128(addr=v[124:125], data=v[134:137], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[134], s[4], v[138]))
  k.emit(v_add_co_u32(v[0], VCC_LO, s[0], v[0]))
  k.emit(v_add_co_ci_u32_e32(v[1], s[1], v[1]))
  k.emit(global_load_b128(vdst=v[124:127], addr=v[0:1], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(v_fmac_f32_e32(v[129], s[6], v[125]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[125], vdsty=v[132], srcx0=s[5], vsrcx1=v[116], srcy0=v[118], vsrcy1=v[134]))
  k.emit(v_fmac_f32_e32(v[131], s[6], v[127]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[127], vdsty=v[130], srcx0=s[5], vsrcx1=v[114], srcy0=s[5], vsrcy1=v[121]))
  k.emit(v_fmac_f32_e32(v[128], s[6], v[124]))
  k.emit(s_delay_alu(simm16=548))
  k.emit(v_ashrrev_i32_e32(v[133], 31, v[132]))
  k.emit(v_mul_f32_e32(v[124], s[5], v[117]))
  k.emit(v_fmac_f32_e32(v[130], s[6], v[126]))
  k.emit(s_delay_alu(simm16=3))
  k.emit(v_lshlrev_b64(v[120:121], 2, v[132:133]))
  k.emit(global_store_b128(addr=v[0:1], data=v[128:131], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[1], 32, v[118]))
  k.emit(v_add_nc_u32_e32(v[0], 0x60, v[118]))
  k.emit(v_add_co_u32(v[132], VCC_LO, s[0], v[120]))
  k.emit(v_add_co_ci_u32_e32(v[133], s[1], v[121]))
  k.emit(global_load_b128(vdst=v[120:123], addr=v[132:133], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(v_fmac_f32_e32(v[125], s[6], v[121]))
  k.emit(v_mul_f32_e32(v[121], s[5], v[112]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[127], vdsty=v[128], srcx0=s[6], vsrcx1=v[123], srcy0=v[1], vsrcy1=v[144]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[123], vdsty=v[126], srcx0=s[5], vsrcx1=v[110], srcy0=s[5], vsrcy1=v[115]))
  k.emit(v_fmac_f32_e32(v[124], s[6], v[120]))
  k.emit(s_delay_alu(simm16=547))
  k.emit(v_ashrrev_i32_e32(v[129], 31, v[128]))
  k.emit(v_mul_f32_e32(v[120], s[5], v[113]))
  k.emit(v_fmac_f32_e32(v[126], s[6], v[122]))
  k.emit(s_delay_alu(simm16=467))
  k.emit(v_lshlrev_b64(v[114:115], 2, v[128:129]))
  k.emit(global_store_b128(addr=v[132:133], data=v[124:127], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[124], v[1], v[145]))
  k.emit(v_add_co_u32(v[128], VCC_LO, s[0], v[114]))
  k.emit(v_add_co_ci_u32_e32(v[129], s[1], v[115]))
  k.emit(v_ashrrev_i32_e32(v[125], 31, v[124]))
  k.emit(global_load_b128(vdst=v[114:117], addr=v[128:129], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(v_fmac_f32_e32(v[123], s[6], v[117]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[117], vdsty=v[122], srcx0=s[5], vsrcx1=v[106], srcy0=s[5], vsrcy1=v[111]))
  k.emit(v_lshlrev_b64(v[110:111], 2, v[124:125]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[120], vdsty=v[121], srcx0=s[6], vsrcx1=v[114], srcy0=s[6], vsrcy1=v[115]))
  k.emit(v_mul_f32_e32(v[114], s[5], v[109]))
  k.emit(s_delay_alu(simm16=4))
  k.emit(v_fmac_f32_e32(v[122], s[6], v[116]))
  k.emit(v_mul_f32_e32(v[116], s[5], v[107]))
  k.emit(v_add_co_u32(v[124], VCC_LO, s[0], v[110]))
  k.emit(v_add_co_ci_u32_e32(v[125], s[1], v[111]))
  k.emit(global_store_b128(addr=v[128:129], data=v[120:123], saddr=RawImm(124)))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[115], vdsty=v[120], srcx0=s[5], vsrcx1=v[108], srcy0=v[1], vsrcy1=v[138]))
  k.emit(global_load_b128(vdst=v[110:113], addr=v[124:125], saddr=RawImm(124)))
  k.emit(v_ashrrev_i32_e32(v[121], 31, v[120]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_lshlrev_b64(v[106:107], 2, v[120:121]))
  k.emit(v_add_co_u32(v[120], VCC_LO, s[0], v[106]))
  k.emit(s_delay_alu(simm16=2))
  k.emit(v_add_co_ci_u32_e32(v[121], s[1], v[107]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[114], vdsty=v[115], srcx0=s[6], vsrcx1=v[110], srcy0=s[6], vsrcy1=v[111]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[116], vdsty=v[117], srcx0=s[6], vsrcx1=v[112], srcy0=s[6], vsrcy1=v[113]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[112], vdsty=v[113], srcx0=s[5], vsrcx1=v[103], srcy0=s[5], vsrcy1=v[102]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[110], vdsty=v[111], srcx0=s[5], vsrcx1=v[105], srcy0=s[5], vsrcy1=v[104]))
  k.emit(global_store_b128(addr=v[124:125], data=v[114:117], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[106:109], addr=v[120:121], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[114], v[1], v[134]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[115], 31, v[114]))
  k.emit(v_lshlrev_b64(v[102:103], 2, v[114:115]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[114], VCC_LO, s[0], v[102]))
  k.emit(v_add_co_ci_u32_e32(v[115], s[1], v[103]))
  k.emit(v_add_nc_u32_e32(v[102], 64, v[118]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[110], vdsty=v[111], srcx0=s[6], vsrcx1=v[106], srcy0=s[6], vsrcy1=v[107]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[112], vdsty=v[113], srcx0=s[6], vsrcx1=v[108], srcy0=s[6], vsrcy1=v[109]))
  k.emit(v_mul_f32_e32(v[109], s[5], v[99]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[107], vdsty=v[108], srcx0=s[5], vsrcx1=v[101], srcy0=s[5], vsrcy1=v[100]))
  k.emit(global_store_b128(addr=v[120:121], data=v[110:113], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[103:106], addr=v[114:115], saddr=RawImm(124)))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[110], vdsty=v[111], srcx0=s[5], vsrcx1=v[98], srcy0=v[102], vsrcy1=v[144]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[112], 31, v[111]))
  k.emit(v_lshlrev_b64(v[98:99], 2, v[111:112]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[111], VCC_LO, s[0], v[98]))
  k.emit(v_add_co_ci_u32_e32(v[112], s[1], v[99]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[107], vdsty=v[108], srcx0=s[6], vsrcx1=v[103], srcy0=s[6], vsrcy1=v[104]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[109], vdsty=v[110], srcx0=s[6], vsrcx1=v[105], srcy0=s[6], vsrcy1=v[106]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[104], vdsty=v[105], srcx0=s[5], vsrcx1=v[96], srcy0=s[5], vsrcy1=v[95]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[106], vdsty=v[103], srcx0=s[5], vsrcx1=v[94], srcy0=s[5], vsrcy1=v[97]))
  k.emit(global_store_b128(addr=v[114:115], data=v[107:110], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[98:101], addr=v[111:112], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[104], vdsty=v[99], srcx0=s[6], vsrcx1=v[99], srcy0=s[5], vsrcy1=v[92]))
  k.emit(v_add_nc_u32_e32(v[107], v[102], v[145]))
  k.emit(v_fmac_f32_e32(v[103], s[6], v[98]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[105], vdsty=v[106], srcx0=s[6], vsrcx1=v[100], srcy0=s[6], vsrcy1=v[101]))
  k.emit(v_mul_f32_e32(v[100], s[5], v[91]))
  k.emit(s_delay_alu(simm16=340))
  k.emit(v_ashrrev_i32_e32(v[108], 31, v[107]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[101], vdsty=v[98], srcx0=s[5], vsrcx1=v[90], srcy0=s[5], vsrcy1=v[93]))
  k.emit(global_store_b128(addr=v[111:112], data=v[103:106], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[103], v[102], v[138]))
  k.emit(v_lshlrev_b64(v[94:95], 2, v[107:108]))
  k.emit(v_ashrrev_i32_e32(v[104], 31, v[103]))
  k.emit(s_delay_alu(simm16=402))
  k.emit(v_add_co_u32(v[107], VCC_LO, s[0], v[94]))
  k.emit(v_add_co_ci_u32_e32(v[108], s[1], v[95]))
  k.emit(s_delay_alu(simm16=3))
  k.emit(v_lshlrev_b64(v[90:91], 2, v[103:104]))
  k.emit(global_load_b128(vdst=v[94:97], addr=v[107:108], saddr=RawImm(124)))
  k.emit(v_add_co_u32(v[103], VCC_LO, s[0], v[90]))
  k.emit(v_add_co_ci_u32_e32(v[104], s[1], v[91]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[98], vdsty=v[99], srcx0=s[6], vsrcx1=v[94], srcy0=s[6], vsrcy1=v[95]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[100], vdsty=v[101], srcx0=s[6], vsrcx1=v[96], srcy0=s[6], vsrcy1=v[97]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[96], vdsty=v[97], srcx0=s[5], vsrcx1=v[87], srcy0=s[5], vsrcy1=v[86]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[94], vdsty=v[95], srcx0=s[5], vsrcx1=v[89], srcy0=s[5], vsrcy1=v[88]))
  k.emit(global_store_b128(addr=v[107:108], data=v[98:101], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[90:93], addr=v[103:104], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[98], v[102], v[134]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[99], 31, v[98]))
  k.emit(v_lshlrev_b64(v[86:87], 2, v[98:99]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[98], VCC_LO, s[0], v[86]))
  k.emit(v_add_co_ci_u32_e32(v[99], s[1], v[87]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[94], vdsty=v[95], srcx0=s[6], vsrcx1=v[90], srcy0=s[6], vsrcy1=v[91]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[96], vdsty=v[97], srcx0=s[6], vsrcx1=v[92], srcy0=s[6], vsrcy1=v[93]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[92], vdsty=v[93], srcx0=s[5], vsrcx1=v[83], srcy0=s[5], vsrcy1=v[82]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[90], vdsty=v[91], srcx0=s[5], vsrcx1=v[85], srcy0=s[5], vsrcy1=v[84]))
  k.emit(global_store_b128(addr=v[103:104], data=v[94:97], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[86:89], addr=v[98:99], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[94], v[0], v[144]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[95], 31, v[94]))
  k.emit(v_lshlrev_b64(v[82:83], 2, v[94:95]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[94], VCC_LO, s[0], v[82]))
  k.emit(v_add_co_ci_u32_e32(v[95], s[1], v[83]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[90], vdsty=v[91], srcx0=s[6], vsrcx1=v[86], srcy0=s[6], vsrcy1=v[87]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[92], vdsty=v[93], srcx0=s[6], vsrcx1=v[88], srcy0=s[6], vsrcy1=v[89]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[87], vdsty=v[88], srcx0=s[5], vsrcx1=v[80], srcy0=s[5], vsrcy1=v[79]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[89], vdsty=v[86], srcx0=s[5], vsrcx1=v[78], srcy0=s[5], vsrcy1=v[81]))
  k.emit(global_store_b128(addr=v[98:99], data=v[90:93], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[82:85], addr=v[94:95], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(v_fmac_f32_e32(v[87], s[6], v[83]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_ADD_NC_U32, vdstx=v[83], vdsty=v[90], srcx0=s[5], vsrcx1=v[76], srcy0=v[0], vsrcy1=v[145]))
  k.emit(v_fmac_f32_e32(v[86], s[6], v[82]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[88], vdsty=v[89], srcx0=s[6], vsrcx1=v[84], srcy0=s[6], vsrcy1=v[85]))
  k.emit(v_mul_f32_e32(v[84], s[5], v[75]))
  k.emit(s_delay_alu(simm16=340))
  k.emit(v_ashrrev_i32_e32(v[91], 31, v[90]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[85], vdsty=v[82], srcx0=s[5], vsrcx1=v[74], srcy0=s[5], vsrcy1=v[77]))
  k.emit(global_store_b128(addr=v[94:95], data=v[86:89], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[86], v[0], v[138]))
  k.emit(v_lshlrev_b64(v[78:79], 2, v[90:91]))
  k.emit(v_ashrrev_i32_e32(v[87], 31, v[86]))
  k.emit(s_delay_alu(simm16=402))
  k.emit(v_add_co_u32(v[90], VCC_LO, s[0], v[78]))
  k.emit(v_add_co_ci_u32_e32(v[91], s[1], v[79]))
  k.emit(s_delay_alu(simm16=3))
  k.emit(v_lshlrev_b64(v[74:75], 2, v[86:87]))
  k.emit(global_load_b128(vdst=v[78:81], addr=v[90:91], saddr=RawImm(124)))
  k.emit(v_add_co_u32(v[86], VCC_LO, s[0], v[74]))
  k.emit(v_add_co_ci_u32_e32(v[87], s[1], v[75]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[82], vdsty=v[83], srcx0=s[6], vsrcx1=v[78], srcy0=s[6], vsrcy1=v[79]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[84], vdsty=v[85], srcx0=s[6], vsrcx1=v[80], srcy0=s[6], vsrcy1=v[81]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[80], vdsty=v[81], srcx0=s[5], vsrcx1=v[71], srcy0=s[5], vsrcy1=v[70]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[78], vdsty=v[79], srcx0=s[5], vsrcx1=v[73], srcy0=s[5], vsrcy1=v[72]))
  k.emit(global_store_b128(addr=v[90:91], data=v[82:85], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[74:77], addr=v[86:87], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[82], v[0], v[134]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[83], 31, v[82]))
  k.emit(v_lshlrev_b64(v[70:71], 2, v[82:83]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[82], VCC_LO, s[0], v[70]))
  k.emit(v_add_co_ci_u32_e32(v[83], s[1], v[71]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[78], vdsty=v[79], srcx0=s[6], vsrcx1=v[74], srcy0=s[6], vsrcy1=v[75]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[80], vdsty=v[81], srcx0=s[6], vsrcx1=v[76], srcy0=s[6], vsrcy1=v[77]))
  k.emit(v_or_b32_e32(v[74], 16, v[119]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[76], vdsty=v[77], srcx0=s[5], vsrcx1=v[67], srcy0=s[5], vsrcy1=v[66]))
  k.emit(v_mul_f32_e32(v[75], s[5], v[68]))
  k.emit(global_store_b128(addr=v[86:87], data=v[78:81], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[70:73], addr=v[82:83], saddr=RawImm(124)))
  k.emit(v_mul_lo_u32(v[80], v[74], s[4]))
  k.emit(v_mul_f32_e32(v[74], s[5], v[69]))
  k.emit(s_delay_alu(simm16=146))
  k.emit(v_add_nc_u32_e32(v[78], v[118], v[80]))
  k.emit(v_ashrrev_i32_e32(v[79], 31, v[78]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_lshlrev_b64(v[66:67], 2, v[78:79]))
  k.emit(v_add_co_u32(v[78], VCC_LO, s[0], v[66]))
  k.emit(s_delay_alu(simm16=2))
  k.emit(v_add_co_ci_u32_e32(v[79], s[1], v[67]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[74], vdsty=v[75], srcx0=s[6], vsrcx1=v[70], srcy0=s[6], vsrcy1=v[71]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[76], vdsty=v[77], srcx0=s[6], vsrcx1=v[72], srcy0=s[6], vsrcy1=v[73]))
  k.emit(v_or_b32_e32(v[70], 17, v[119]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[72], vdsty=v[73], srcx0=s[5], vsrcx1=v[63], srcy0=s[5], vsrcy1=v[62]))
  k.emit(v_mul_f32_e32(v[71], s[5], v[64]))
  k.emit(global_store_b128(addr=v[82:83], data=v[74:77], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[66:69], addr=v[78:79], saddr=RawImm(124)))
  k.emit(v_mul_lo_u32(v[76], v[70], s[4]))
  k.emit(v_mul_f32_e32(v[70], s[5], v[65]))
  k.emit(s_delay_alu(simm16=146))
  k.emit(v_add_nc_u32_e32(v[74], v[118], v[76]))
  k.emit(v_ashrrev_i32_e32(v[75], 31, v[74]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_lshlrev_b64(v[62:63], 2, v[74:75]))
  k.emit(v_add_co_u32(v[74], VCC_LO, s[0], v[62]))
  k.emit(s_delay_alu(simm16=2))
  k.emit(v_add_co_ci_u32_e32(v[75], s[1], v[63]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[70], vdsty=v[71], srcx0=s[6], vsrcx1=v[66], srcy0=s[6], vsrcy1=v[67]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[72], vdsty=v[73], srcx0=s[6], vsrcx1=v[68], srcy0=s[6], vsrcy1=v[69]))
  k.emit(v_or_b32_e32(v[66], 18, v[119]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[68], vdsty=v[69], srcx0=s[5], vsrcx1=v[59], srcy0=s[5], vsrcy1=v[58]))
  k.emit(v_mul_f32_e32(v[67], s[5], v[60]))
  k.emit(global_store_b128(addr=v[78:79], data=v[70:73], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[62:65], addr=v[74:75], saddr=RawImm(124)))
  k.emit(v_mul_lo_u32(v[72], v[66], s[4]))
  k.emit(v_mul_f32_e32(v[66], s[5], v[61]))
  k.emit(s_delay_alu(simm16=146))
  k.emit(v_add_nc_u32_e32(v[70], v[118], v[72]))
  k.emit(v_ashrrev_i32_e32(v[71], 31, v[70]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_lshlrev_b64(v[58:59], 2, v[70:71]))
  k.emit(v_add_co_u32(v[70], VCC_LO, s[0], v[58]))
  k.emit(s_delay_alu(simm16=2))
  k.emit(v_add_co_ci_u32_e32(v[71], s[1], v[59]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[66], vdsty=v[67], srcx0=s[6], vsrcx1=v[62], srcy0=s[6], vsrcy1=v[63]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[68], vdsty=v[69], srcx0=s[6], vsrcx1=v[64], srcy0=s[6], vsrcy1=v[65]))
  k.emit(v_or_b32_e32(v[62], 19, v[119]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[64], vdsty=v[65], srcx0=s[5], vsrcx1=v[55], srcy0=s[5], vsrcy1=v[54]))
  k.emit(v_mul_f32_e32(v[63], s[5], v[56]))
  k.emit(global_store_b128(addr=v[74:75], data=v[66:69], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[58:61], addr=v[70:71], saddr=RawImm(124)))
  k.emit(v_mul_lo_u32(v[68], v[62], s[4]))
  k.emit(v_mul_f32_e32(v[62], s[5], v[57]))
  k.emit(s_delay_alu(simm16=146))
  k.emit(v_add_nc_u32_e32(v[66], v[118], v[68]))
  k.emit(v_ashrrev_i32_e32(v[67], 31, v[66]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_lshlrev_b64(v[54:55], 2, v[66:67]))
  k.emit(v_add_co_u32(v[66], VCC_LO, s[0], v[54]))
  k.emit(s_delay_alu(simm16=2))
  k.emit(v_add_co_ci_u32_e32(v[67], s[1], v[55]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[62], vdsty=v[63], srcx0=s[6], vsrcx1=v[58], srcy0=s[6], vsrcy1=v[59]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[64], vdsty=v[65], srcx0=s[6], vsrcx1=v[60], srcy0=s[6], vsrcy1=v[61]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[60], vdsty=v[61], srcx0=s[5], vsrcx1=v[51], srcy0=s[5], vsrcy1=v[50]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[58], vdsty=v[59], srcx0=s[5], vsrcx1=v[53], srcy0=s[5], vsrcy1=v[52]))
  k.emit(global_store_b128(addr=v[70:71], data=v[62:65], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[54:57], addr=v[66:67], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[62], v[1], v[80]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[63], 31, v[62]))
  k.emit(v_lshlrev_b64(v[50:51], 2, v[62:63]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[62], VCC_LO, s[0], v[50]))
  k.emit(v_add_co_ci_u32_e32(v[63], s[1], v[51]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[58], vdsty=v[59], srcx0=s[6], vsrcx1=v[54], srcy0=s[6], vsrcy1=v[55]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[60], vdsty=v[61], srcx0=s[6], vsrcx1=v[56], srcy0=s[6], vsrcy1=v[57]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[56], vdsty=v[57], srcx0=s[5], vsrcx1=v[47], srcy0=s[5], vsrcy1=v[46]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[54], vdsty=v[55], srcx0=s[5], vsrcx1=v[49], srcy0=s[5], vsrcy1=v[48]))
  k.emit(global_store_b128(addr=v[66:67], data=v[58:61], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[50:53], addr=v[62:63], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[58], v[1], v[76]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[59], 31, v[58]))
  k.emit(v_lshlrev_b64(v[46:47], 2, v[58:59]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[58], VCC_LO, s[0], v[46]))
  k.emit(v_add_co_ci_u32_e32(v[59], s[1], v[47]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[54], vdsty=v[55], srcx0=s[6], vsrcx1=v[50], srcy0=s[6], vsrcy1=v[51]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[56], vdsty=v[57], srcx0=s[6], vsrcx1=v[52], srcy0=s[6], vsrcy1=v[53]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[52], vdsty=v[53], srcx0=s[5], vsrcx1=v[43], srcy0=s[5], vsrcy1=v[42]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[50], vdsty=v[51], srcx0=s[5], vsrcx1=v[45], srcy0=s[5], vsrcy1=v[44]))
  k.emit(global_store_b128(addr=v[62:63], data=v[54:57], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[46:49], addr=v[58:59], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[54], v[1], v[72]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[55], 31, v[54]))
  k.emit(v_lshlrev_b64(v[42:43], 2, v[54:55]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[54], VCC_LO, s[0], v[42]))
  k.emit(v_add_co_ci_u32_e32(v[55], s[1], v[43]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[50], vdsty=v[51], srcx0=s[6], vsrcx1=v[46], srcy0=s[6], vsrcy1=v[47]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[52], vdsty=v[53], srcx0=s[6], vsrcx1=v[48], srcy0=s[6], vsrcy1=v[49]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[48], vdsty=v[49], srcx0=s[5], vsrcx1=v[39], srcy0=s[5], vsrcy1=v[38]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[46], vdsty=v[47], srcx0=s[5], vsrcx1=v[41], srcy0=s[5], vsrcy1=v[40]))
  k.emit(global_store_b128(addr=v[58:59], data=v[50:53], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[42:45], addr=v[54:55], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[50], v[1], v[68]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[51], 31, v[50]))
  k.emit(v_lshlrev_b64(v[38:39], 2, v[50:51]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[50], VCC_LO, s[0], v[38]))
  k.emit(v_add_co_ci_u32_e32(v[51], s[1], v[39]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[46], vdsty=v[47], srcx0=s[6], vsrcx1=v[42], srcy0=s[6], vsrcy1=v[43]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[48], vdsty=v[49], srcx0=s[6], vsrcx1=v[44], srcy0=s[6], vsrcy1=v[45]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[44], vdsty=v[45], srcx0=s[5], vsrcx1=v[35], srcy0=s[5], vsrcy1=v[34]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[42], vdsty=v[43], srcx0=s[5], vsrcx1=v[37], srcy0=s[5], vsrcy1=v[36]))
  k.emit(global_store_b128(addr=v[54:55], data=v[46:49], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[38:41], addr=v[50:51], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[46], v[102], v[80]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[47], 31, v[46]))
  k.emit(v_lshlrev_b64(v[34:35], 2, v[46:47]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[46], VCC_LO, s[0], v[34]))
  k.emit(v_add_co_ci_u32_e32(v[47], s[1], v[35]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[42], vdsty=v[43], srcx0=s[6], vsrcx1=v[38], srcy0=s[6], vsrcy1=v[39]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[44], vdsty=v[45], srcx0=s[6], vsrcx1=v[40], srcy0=s[6], vsrcy1=v[41]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[40], vdsty=v[41], srcx0=s[5], vsrcx1=v[31], srcy0=s[5], vsrcy1=v[30]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[38], vdsty=v[39], srcx0=s[5], vsrcx1=v[33], srcy0=s[5], vsrcy1=v[32]))
  k.emit(global_store_b128(addr=v[50:51], data=v[42:45], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[34:37], addr=v[46:47], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[42], v[102], v[76]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[43], 31, v[42]))
  k.emit(v_lshlrev_b64(v[30:31], 2, v[42:43]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[42], VCC_LO, s[0], v[30]))
  k.emit(v_add_co_ci_u32_e32(v[43], s[1], v[31]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[38], vdsty=v[39], srcx0=s[6], vsrcx1=v[34], srcy0=s[6], vsrcy1=v[35]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[40], vdsty=v[41], srcx0=s[6], vsrcx1=v[36], srcy0=s[6], vsrcy1=v[37]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[36], vdsty=v[37], srcx0=s[5], vsrcx1=v[27], srcy0=s[5], vsrcy1=v[26]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[34], vdsty=v[35], srcx0=s[5], vsrcx1=v[29], srcy0=s[5], vsrcy1=v[28]))
  k.emit(global_store_b128(addr=v[46:47], data=v[38:41], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[30:33], addr=v[42:43], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[38], v[102], v[72]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[39], 31, v[38]))
  k.emit(v_lshlrev_b64(v[26:27], 2, v[38:39]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[38], VCC_LO, s[0], v[26]))
  k.emit(v_add_co_ci_u32_e32(v[39], s[1], v[27]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[34], vdsty=v[35], srcx0=s[6], vsrcx1=v[30], srcy0=s[6], vsrcy1=v[31]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[36], vdsty=v[37], srcx0=s[6], vsrcx1=v[32], srcy0=s[6], vsrcy1=v[33]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[32], vdsty=v[33], srcx0=s[5], vsrcx1=v[23], srcy0=s[5], vsrcy1=v[22]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[30], vdsty=v[31], srcx0=s[5], vsrcx1=v[25], srcy0=s[5], vsrcy1=v[24]))
  k.emit(global_store_b128(addr=v[42:43], data=v[34:37], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[26:29], addr=v[38:39], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[34], v[102], v[68]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[35], 31, v[34]))
  k.emit(v_lshlrev_b64(v[22:23], 2, v[34:35]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[34], VCC_LO, s[0], v[22]))
  k.emit(v_add_co_ci_u32_e32(v[35], s[1], v[23]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[30], vdsty=v[31], srcx0=s[6], vsrcx1=v[26], srcy0=s[6], vsrcy1=v[27]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[32], vdsty=v[33], srcx0=s[6], vsrcx1=v[28], srcy0=s[6], vsrcy1=v[29]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[28], vdsty=v[29], srcx0=s[5], vsrcx1=v[19], srcy0=s[5], vsrcy1=v[18]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[26], vdsty=v[27], srcx0=s[5], vsrcx1=v[21], srcy0=s[5], vsrcy1=v[20]))
  k.emit(global_store_b128(addr=v[38:39], data=v[30:33], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[22:25], addr=v[34:35], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[30], v[0], v[80]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[31], 31, v[30]))
  k.emit(v_lshlrev_b64(v[18:19], 2, v[30:31]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[30], VCC_LO, s[0], v[18]))
  k.emit(v_add_co_ci_u32_e32(v[31], s[1], v[19]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[26], vdsty=v[27], srcx0=s[6], vsrcx1=v[22], srcy0=s[6], vsrcy1=v[23]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[28], vdsty=v[29], srcx0=s[6], vsrcx1=v[24], srcy0=s[6], vsrcy1=v[25]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[24], vdsty=v[25], srcx0=s[5], vsrcx1=v[15], srcy0=s[5], vsrcy1=v[14]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[22], vdsty=v[23], srcx0=s[5], vsrcx1=v[17], srcy0=s[5], vsrcy1=v[16]))
  k.emit(global_store_b128(addr=v[34:35], data=v[26:29], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[18:21], addr=v[30:31], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[26], v[0], v[76]))
  k.emit(s_delay_alu(simm16=145))
  k.emit(v_ashrrev_i32_e32(v[27], 31, v[26]))
  k.emit(v_lshlrev_b64(v[14:15], 2, v[26:27]))
  k.emit(s_delay_alu(simm16=273))
  k.emit(v_add_co_u32(v[26], VCC_LO, s[0], v[14]))
  k.emit(v_add_co_ci_u32_e32(v[27], s[1], v[15]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[22], vdsty=v[23], srcx0=s[6], vsrcx1=v[18], srcy0=s[6], vsrcy1=v[19]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[24], vdsty=v[25], srcx0=s[6], vsrcx1=v[20], srcy0=s[6], vsrcy1=v[21]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[20], vdsty=v[21], srcx0=s[5], vsrcx1=v[11], srcy0=s[5], vsrcy1=v[10]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[18], vdsty=v[19], srcx0=s[5], vsrcx1=v[13], srcy0=s[5], vsrcy1=v[12]))
  k.emit(global_store_b128(addr=v[30:31], data=v[22:25], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[14:17], addr=v[26:27], saddr=RawImm(124)))
  k.emit(v_add_nc_u32_e32(v[22], v[0], v[72]))
  k.emit(v_add_nc_u32_e32(v[0], v[0], v[68]))
  k.emit(s_delay_alu(simm16=274))
  k.emit(v_ashrrev_i32_e32(v[23], 31, v[22]))
  k.emit(v_ashrrev_i32_e32(v[1], 31, v[0]))
  k.emit(s_delay_alu(simm16=274))
  k.emit(v_lshlrev_b64(v[10:11], 2, v[22:23]))
  k.emit(v_lshlrev_b64(v[0:1], 2, v[0:1]))
  k.emit(s_delay_alu(simm16=402))
  k.emit(v_add_co_u32(v[22], VCC_LO, s[0], v[10]))
  k.emit(v_add_co_ci_u32_e32(v[23], s[1], v[11]))
  k.emit(s_delay_alu(simm16=531))
  k.emit(v_add_co_u32(v[0], VCC_LO, s[0], v[0]))
  k.emit(v_add_co_ci_u32_e32(v[1], s[1], v[1]))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[18], vdsty=v[19], srcx0=s[6], vsrcx1=v[14], srcy0=s[6], vsrcy1=v[15]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[20], vdsty=v[21], srcx0=s[6], vsrcx1=v[16], srcy0=s[6], vsrcy1=v[17]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[14], vdsty=v[15], srcx0=s[5], vsrcx1=v[9], srcy0=s[5], vsrcy1=v[8]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[16], vdsty=v[17], srcx0=s[5], vsrcx1=v[7], srcy0=s[5], vsrcy1=v[6]))
  k.emit(global_store_b128(addr=v[26:27], data=v[18:21], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[10:13], addr=v[22:23], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[14], vdsty=v[15], srcx0=s[6], vsrcx1=v[10], srcy0=s[6], vsrcy1=v[11]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[16], vdsty=v[17], srcx0=s[6], vsrcx1=v[12], srcy0=s[6], vsrcy1=v[13]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[10], vdsty=v[11], srcx0=s[5], vsrcx1=v[5], srcy0=s[5], vsrcy1=v[4]))
  k.emit(VOPD(VOPDOp.V_DUAL_MUL_F32, VOPDOp.V_DUAL_MUL_F32, vdstx=v[12], vdsty=v[13], srcx0=s[5], vsrcx1=v[3], srcy0=s[5], vsrcy1=v[2]))
  k.emit(global_store_b128(addr=v[22:23], data=v[14:17], saddr=RawImm(124)))
  k.emit(global_load_b128(vdst=v[6:9], addr=v[0:1], saddr=RawImm(124)))
  k.emit(s_waitcnt(simm16=1015))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[11], vdsty=v[10], srcx0=s[6], vsrcx1=v[7], srcy0=s[6], vsrcy1=v[6]))
  k.emit(VOPD(VOPDOp.V_DUAL_FMAC_F32, VOPDOp.V_DUAL_FMAC_F32, vdstx=v[12], vdsty=v[13], srcx0=s[6], vsrcx1=v[8], srcy0=s[6], vsrcy1=v[9]))
  k.emit(global_store_b128(addr=v[0:1], data=v[10:13], saddr=RawImm(124)))
  k.emit(s_nop(0))
  k.emit(s_sendmsg(simm16=3))
  k.emit(s_endpgm())

  return k.to_asm()
